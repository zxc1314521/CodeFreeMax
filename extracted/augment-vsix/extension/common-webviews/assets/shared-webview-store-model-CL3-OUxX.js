import{W as a}from"./debounce-BNOmQ76Y.js";try{s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(i=new s.Error().stack)&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[i]="f5f37825-706d-41c9-82d6-dd8b806e0063",s._sentryDebugIdIdentifier="sentry-dbid-f5f37825-706d-41c9-82d6-dd8b806e0063")}catch{}var s,i;class o{constructor(t,e=void 0,d,n){this._msgBroker=t,this._state=e,this.validateState=d,this._storeId=n,e&&this.setStateInternal(e)}subscribers=new Set;subscribe(t){return this.subscribers.add(t),t(this),()=>{this.subscribers.delete(t)}}notifySubscribers(){this.subscribers.forEach((t=>t(this)))}get state(){return this._state}get storeId(){return this._storeId}shouldAcceptMessage(t,e){return t.id===this.storeId&&this.validateState(e)}update(t){const e=t(this._state);e!==void 0&&this.setStateInternal(e)}setState(t){this.setStateInternal(t)}async setStateInternal(t){JSON.stringify(this._state)!==JSON.stringify(t)&&(this._state=t,this._msgBroker.postMessage({type:a.updateSharedWebviewState,data:t,id:this.storeId}))}async fetchStateFromExtension(){const t=await this._msgBroker.send({type:a.getSharedWebviewState,id:this.storeId,data:{}});t.type===a.getSharedWebviewStateResponse&&this.shouldAcceptMessage(t,t.data)&&(this._state=t.data,this.notifySubscribers())}handleMessageFromExtension(t){switch(t.data.type){case a.updateSharedWebviewState:case a.getSharedWebviewStateResponse:return!!this.shouldAcceptMessage(t.data,t.data.data)&&(this._state=t.data.data,this.notifySubscribers(),!0);default:return!1}}}export{o as S};
//# sourceMappingURL=shared-webview-store-model-CL3-OUxX.js.map
