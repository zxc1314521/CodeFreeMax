import{R as u,a as l,F as f}from"./index-Dqp5W2S2.js";import{C as w,a as p}from"./message-broker-DUQuEFlt.js";try{c=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(h=new c.Error().stack)&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[h]="0d58a367-38a4-4d52-9381-7fdac6122fd3",c._sentryDebugIdIdentifier="sentry-dbid-0d58a367-38a4-4d52-9381-7fdac6122fd3")}catch{}var c,h;function m(t){return(function(a){try{if(isNaN(a.getTime()))return"Unknown time";const r=new Date().getTime()-a.getTime(),o=Math.floor(r/1e3),s=Math.floor(o/60),e=Math.floor(s/60),n=Math.floor(e/24);return o<60?`${o}s ago`:s<60?`${s}m ago`:e<24?`${e}h ago`:n<30?`${n}d ago`:a.toLocaleDateString()}catch(r){return console.error("Error formatting date:",r),"Unknown time"}})(new Date(t))}function I(t,a){let r=1e3;const o=new Date(t),s=setInterval((()=>{const e=Math.floor((new Date().getTime()-o.getTime())/1e3/60);e>=1&&(r=6e4),e>=60&&(r=36e5),e>=1440&&(r=864e5),a(m(t))}),r);return()=>clearInterval(s)}function C(t,a){const r=setInterval((()=>{const o=t.getTime()-Date.now();if(o<=0)return void clearInterval(r);const s=Math.floor(o/1e3),e=Math.floor(s/60),n=Math.floor(e/60),i=Math.floor(n/24);a(s<60?`${s}s`:e<60?`${e}m ${s%60}s`:n<24?`${n}h`:i<30?`${i}d`:"1mo")}),1e3);return()=>clearInterval(r)}function b(t){if(t===void 0)return"neutral";switch(t){case l.agentPending:case l.agentStarting:case l.agentRunning:return"info";case l.agentIdle:return"success";case l.agentFailed:return"error";default:return"neutral"}}function R(t){if(t===void 0)return"neutral";switch(t){case u.workspaceRunning:return"info";case u.workspacePausing:case u.workspacePaused:case u.workspaceResuming:default:return"neutral"}}function T(t,a,r){if(a===u.workspaceResuming)return"Resuming";switch(t){case l.agentStarting:return"Starting";case l.agentRunning:return"Running";case l.agentIdle:return r?"Unread":"Idle";case l.agentPending:return"Pending";case l.agentFailed:return"Failed";default:return"Unknown"}}function v(t){switch(t){case"Unread":return"accent";case"Starting":case"Resuming":return"iris";case"Running":return"success";case"Idle":case"Pending":default:return"neutral";case"Failed":return"error"}}const x=t=>{const a={};for(const e of t){const n=e.old_path||e.new_path;if(a[n])a[n].finalExists=e.new_path!=="",a[n].finalContent=e.new_path!==""?e.new_contents:"",a[n].finalPath=e.new_path||e.old_path,a[n].latestChange=e,e.change_type===f.deleted&&e.old_contents!==""&&(a[n].originalContent=e.old_contents);else{const i=e.old_path!=="";a[n]={originalExists:i,originalContent:i?e.old_contents:"",finalExists:e.new_path!=="",finalContent:e.new_path!==""?e.new_contents:"",finalPath:e.new_path||e.old_path,latestChange:e}}}const r=[];for(const[e,n]of Object.entries(a))if(n.originalExists!==n.finalExists||n.originalExists&&n.finalExists&&n.originalContent!==n.finalContent){const i={id:n.latestChange.id,old_path:n.originalExists?e:"",new_path:n.finalExists?n.finalPath:"",old_contents:n.originalContent,new_contents:n.finalContent,change_type:(o=n.originalExists,s=n.finalExists,!o&&s?f.added:o&&!s?f.deleted:f.modified)};r.push(i)}var o,s;return r},D=t=>{const a=t.flatMap((r=>r.changed_files));return(r=>x(r))(a)},M=(t,a)=>{const r=((i,d)=>{const g=i.slice(d+1).findIndex((_=>_.exchange.request_message));return g===-1?i.length:d+g+1})(t,a),o=t.slice(a,r),s=t[a].exchange.response_nodes?.find((i=>i.type===w.TOOL_USE));if(!s)return[];const e=s.tool_use?.tool_use_id;if(!e)return[];const n=o.find((i=>i.exchange.request_nodes?.some((d=>d.type===p.TOOL_RESULT&&d.tool_result_node?.tool_use_id===e))));return n?n.changed_files:[]};export{v as a,m as b,D as c,M as d,b as e,R as f,T as g,C as h,I as s};
//# sourceMappingURL=utils-C8k4ijpS.js.map
