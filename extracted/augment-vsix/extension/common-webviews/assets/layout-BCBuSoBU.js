import{b as Zn,G as j,i as I,v as L}from"./graph-DEajkGTM.js";import{d as G,k as $n,n as nr,o as Nn,p as _n,q as rr,t as In,u as tr,v as Pn,c as U,w as er,b as or,x as ir,m as h,l as V,r as H}from"./_baseUniq-D51PL97z.js";import{f as S,b as jn,a as ar,c as ur,m as k,d as B}from"./min-BK871UjU.js";import{bg as dr,bh as cr,b1 as Rn,bi as A,aQ as Tn,bj as sr,aE as fr,bk as hr,bl as gr,aG as Mn,bm as vr,b0 as Ln,aF as Cn,aV as lr,b3 as pr,bn as rn}from"./mermaid-BF5da6U1.js";import{b8 as wr,aF as fn,aB as hn}from"./debounce-BNOmQ76Y.js";try{M=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(sn=new M.Error().stack)&&(M._sentryDebugIds=M._sentryDebugIds||{},M._sentryDebugIds[sn]="8ff54277-0925-442c-9e7a-67f1957841c6",M._sentryDebugIdIdentifier="sentry-dbid-8ff54277-0925-442c-9e7a-67f1957841c6")}catch{}var M,sn,gn=1/0,br=17976931348623157e292;function D(n){return n?(n=wr(n))===gn||n===-gn?(n<0?-1:1)*br:n==n?n:0:n===0?n:0}var mr=1,yr=4,Sn=Object.prototype,xr=Sn.hasOwnProperty,kr=Rn((function(n,t){n=Object(n);var e=-1,d=t.length,o=d>2?t[2]:void 0;for(o&&A(t[0],t[1],o)&&(d=1);++e<d;)for(var u=t[e],r=Tn(u),a=-1,i=r.length;++a<i;){var c=r[a],f=n[c];(f===void 0||sr(f,Sn[c])&&!xr.call(n,c))&&(n[c]=u[c])}return n}));function J(n){var t=n==null?0:n.length;return t?n[t-1]:void 0}var Er=Math.max,vn,en=(vn=function(n,t,e){var d=n==null?0:n.length;if(!d)return-1;var o,u,r=e==null?0:(o=D(e),u=o%1,o==o?u?o-u:o:0);return r<0&&(r=Er(d+r,0)),nr(n,G(t),r)},function(n,t,e){var d=Object(n);if(!fr(n)){var o=G(t);n=$n(n),t=function(r){return o(d[r],r,d)}}var u=vn(n,t,e);return u>-1?d[o?n[u]:u]:void 0});function Or(n,t){return n>t}var Nr=Object.prototype.hasOwnProperty;function _r(n,t){return n!=null&&Nr.call(n,t)}function Fn(n,t){return n!=null&&rr(n,t,_r)}function z(n,t){var e={};return t=G(t),_n(n,(function(d,o,u){gr(e,o,t(d,o,u))})),e}function T(n){return n&&n.length?jn(n,Mn,Or):void 0}function on(n,t){return n&&n.length?jn(n,G(t),ar):void 0}function Ir(n,t,e,d){if(!fn(n))return n;for(var o=-1,u=(t=In(t,n)).length,r=u-1,a=n;a!=null&&++o<u;){var i=tr(t[o]),c=e;if(i==="__proto__"||i==="constructor"||i==="prototype")return n;if(o!=r){var f=a[i];(c=void 0)==void 0&&(c=fn(f)?f:vr(t[o+1])?[]:{})}Ln(a,i,c),a=a[i]}return n}function Pr(n,t){if(n!==t){var e=n!==void 0,d=n===null,o=n==n,u=hn(n),r=t!==void 0,a=t===null,i=t==t,c=hn(t);if(!a&&!c&&!u&&n>t||u&&r&&i&&!a&&!c||d&&r&&i||!e&&i||!o)return 1;if(!d&&!u&&!c&&n<t||c&&e&&o&&!d&&!u||a&&e&&o||!r&&o||!i)return-1}return 0}function jr(n,t,e){t=t.length?U(t,(function(o){return Cn(o)?function(u){return Pn(u,o.length===1?o[0]:o)}:o})):[Mn];var d=-1;return t=U(t,lr(G)),(function(o,u){var r=o.length;for(o.sort(u);r--;)o[r]=o[r].value;return o})(ur(n,(function(o,u,r){return{criteria:U(t,(function(a){return a(o)})),index:++d,value:o}})),(function(o,u){return(function(r,a,i){for(var c=-1,f=r.criteria,s=a.criteria,g=f.length,v=i.length;++c<g;){var l=Pr(f[c],s[c]);if(l)return c>=v?l:l*(i[c]=="desc"?-1:1)}return r.index-a.index})(o,u,e)}))}function Rr(n,t){return(function(e,d,o){for(var u=-1,r=d.length,a={};++u<r;){var i=d[u],c=Pn(e,i);o(c,i)&&Ir(a,In(i,e),c)}return a})(n,t,(function(e,d){return er(n,d)}))}var ln,Q=dr(cr(ln=function(n,t){return n==null?{}:Rr(n,t)},void 0,S),ln+""),Tr=Math.ceil,Mr=Math.max,C=function(n,t,e){return e&&typeof e!="number"&&A(n,t,e)&&(t=e=void 0),n=D(n),t===void 0?(t=n,n=0):t=D(t),(function(d,o,u,r){for(var a=-1,i=Mr(Tr((o-d)/(u||1)),0),c=Array(i);i--;)c[++a]=d,d+=u;return c})(n,t,e=e===void 0?n<t?1:-1:D(e))},q=Rn((function(n,t){if(n==null)return[];var e=t.length;return e>1&&A(n,t[0],t[1])?t=[]:e>2&&A(t[0],t[1],t[2])&&(t=[t[0]]),jr(n,or(t),[])})),Lr=0;function an(n){var t=++Lr;return ir(n)+t}class Cr{constructor(){var t={};t._next=t._prev=t,this._sentinel=t}dequeue(){var t=this._sentinel,e=t._prev;if(e!==t)return pn(e),e}enqueue(t){var e=this._sentinel;t._prev&&t._next&&pn(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e}toString(){for(var t=[],e=this._sentinel,d=e._prev;d!==e;)t.push(JSON.stringify(d,Sr)),d=d._prev;return"["+t.join(", ")+"]"}}function pn(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function Sr(n,t){if(n!=="_next"&&n!=="_prev")return t}var Fr=pr(1);function Gr(n,t){if(n.nodeCount()<=1)return[];var e=(function(o,u){var r=new j,a=0,i=0;h(o.nodes(),(function(s){r.setNode(s,{v:s,in:0,out:0})})),h(o.edges(),(function(s){var g=r.edge(s.v,s.w)||0,v=u(s),l=g+v;r.setEdge(s.v,s.w,l),i=Math.max(i,r.node(s.v).out+=v),a=Math.max(a,r.node(s.w).in+=v)}));var c=C(i+a+3).map((function(){return new Cr})),f=a+1;return h(r.nodes(),(function(s){tn(c,f,r.node(s))})),{graph:r,buckets:c,zeroIdx:f}})(n,t||Fr),d=(function(o,u,r){for(var a,i=[],c=u[u.length-1],f=u[0];o.nodeCount();){for(;a=f.dequeue();)W(o,u,r,a);for(;a=c.dequeue();)W(o,u,r,a);if(o.nodeCount()){for(var s=u.length-2;s>0;--s)if(a=u[s].dequeue()){i=i.concat(W(o,u,r,a,!0));break}}}return i})(e.graph,e.buckets,e.zeroIdx);return S(k(d,(function(o){return n.outEdges(o.v,o.w)})))}function W(n,t,e,d,o){var u=o?[]:void 0;return h(n.inEdges(d.v),(function(r){var a=n.edge(r),i=n.node(r.v);o&&u.push({v:r.v,w:r.w}),i.out-=a,tn(t,e,i)})),h(n.outEdges(d.v),(function(r){var a=n.edge(r),i=r.w,c=n.node(i);c.in-=a,tn(t,e,c)})),n.removeNode(d.v),u}function tn(n,t,e){e.out?e.in?n[e.out-e.in+t].enqueue(e):n[n.length-1].enqueue(e):n[0].enqueue(e)}function Vr(n){var t=n.graph().acyclicer==="greedy"?Gr(n,(function(e){return function(d){return e.edge(d).weight}})(n)):(function(e){var d=[],o={},u={};function r(a){Object.prototype.hasOwnProperty.call(u,a)||(u[a]=!0,o[a]=!0,h(e.outEdges(a),(function(i){Object.prototype.hasOwnProperty.call(o,i.w)?d.push(i):r(i.w)})),delete o[a])}return h(e.nodes(),r),d})(n);h(t,(function(e){var d=n.edge(e);n.removeEdge(e),d.forwardName=e.name,d.reversed=!0,n.setEdge(e.w,e.v,d,an("rev"))}))}function F(n,t,e,d){var o;do o=an(d);while(n.hasNode(o));return e.dummy=t,n.setNode(o,e),o}function Gn(n){var t=new j({multigraph:n.isMultigraph()}).setGraph(n.graph());return h(n.nodes(),(function(e){n.children(e).length||t.setNode(e,n.node(e))})),h(n.edges(),(function(e){t.setEdge(e,n.edge(e))})),t}function wn(n,t){var e,d,o=n.x,u=n.y,r=t.x-o,a=t.y-u,i=n.width/2,c=n.height/2;if(!r&&!a)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(a)*i>Math.abs(r)*c?(a<0&&(c=-c),e=c*r/a,d=c):(r<0&&(i=-i),e=i,d=i*a/r),{x:o+e,y:u+d}}function K(n){var t=k(C(Vn(n)+1),(function(){return[]}));return h(n.nodes(),(function(e){var d=n.node(e),o=d.rank;I(o)||(t[o][d.order]=e)})),t}function bn(n,t,e,d){var o={width:0,height:0};return arguments.length>=4&&(o.rank=e,o.order=d),F(n,"border",o,t)}function Vn(n){return T(k(n.nodes(),(function(t){var e=n.node(t).rank;if(!I(e))return e})))}function Br(n,t){return t()}function mn(n,t,e,d,o,u){var r={width:0,height:0,rank:u,borderType:t},a=o[t][u-1],i=F(n,"border",r,e);o[t][u]=i,n.setParent(i,d),a&&n.setEdge(a,i,{weight:1})}function qr(n){var t=n.graph().rankdir.toLowerCase();t!=="bt"&&t!=="rl"||(function(e){h(e.nodes(),(function(d){X(e.node(d))})),h(e.edges(),(function(d){var o=e.edge(d);h(o.points,X),Object.prototype.hasOwnProperty.call(o,"y")&&X(o)}))})(n),t!=="lr"&&t!=="rl"||((function(e){h(e.nodes(),(function(d){Z(e.node(d))})),h(e.edges(),(function(d){var o=e.edge(d);h(o.points,Z),Object.prototype.hasOwnProperty.call(o,"x")&&Z(o)}))})(n),Bn(n))}function Bn(n){h(n.nodes(),(function(t){yn(n.node(t))})),h(n.edges(),(function(t){yn(n.edge(t))}))}function yn(n){var t=n.width;n.width=n.height,n.height=t}function X(n){n.y=-n.y}function Z(n){var t=n.x;n.x=n.y,n.y=t}function Yr(n){n.graph().dummyChains=[],h(n.edges(),(function(t){(function(e,d){var o=d.v,u=e.node(o).rank,r=d.w,a=e.node(r).rank,i=d.name,c=e.edge(d),f=c.labelRank;if(a!==u+1){e.removeEdge(d);var s,g,v=void 0;for(g=0,++u;u<a;++g,++u)c.points=[],s=F(e,"edge",v={width:0,height:0,edgeLabel:c,edgeObj:d,rank:u},"_d"),u===f&&(v.width=c.width,v.height=c.height,v.dummy="edge-label",v.labelpos=c.labelpos),e.setEdge(o,s,{weight:c.weight},i),g===0&&e.graph().dummyChains.push(s),o=s;e.setEdge(o,r,{weight:c.weight},i)}})(n,t)}))}function un(n){var t={};h(n.sources(),(function e(d){var o=n.node(d);if(Object.prototype.hasOwnProperty.call(t,d))return o.rank;t[d]=!0;var u=B(k(n.outEdges(d),(function(r){return e(r.w)-n.edge(r).minlen})));return u!==Number.POSITIVE_INFINITY&&u!=null||(u=0),o.rank=u}))}function Y(n,t){return n.node(t.w).rank-n.node(t.v).rank-n.edge(t).minlen}function qn(n){var t,e,d=new j({directed:!1}),o=n.nodes()[0],u=n.nodeCount();for(d.setNode(o,{});Dr(d,n)<u;)t=zr(d,n),e=d.hasNode(t.v)?Y(n,t):-Y(n,t),Ar(d,n,e);return d}function Dr(n,t){return h(n.nodes(),(function e(d){h(t.nodeEdges(d),(function(o){var u=o.v,r=d===u?o.w:u;n.hasNode(r)||Y(t,o)||(n.setNode(r,{}),n.setEdge(d,r,{}),e(r))}))})),n.nodeCount()}function zr(n,t){return on(t.edges(),(function(e){if(n.hasNode(e.v)!==n.hasNode(e.w))return Y(t,e)}))}function Ar(n,t,e){h(n.nodes(),(function(d){t.node(d).rank+=e}))}function Yn(n,t,e){Cn(t)||(t=[t]);var d=(n.isDirected()?n.successors:n.neighbors).bind(n),o=[],u={};return h(t,(function(r){if(!n.hasNode(r))throw new Error("Graph does not have node: "+r);Dn(n,r,e==="post",u,d,o)})),o}function Dn(n,t,e,d,o,u){Object.prototype.hasOwnProperty.call(d,t)||(d[t]=!0,e||u.push(t),h(o(t),(function(r){Dn(n,r,e,d,o,u)})),e&&u.push(t))}function R(n){n=(function(d){var o=new j().setGraph(d.graph());return h(d.nodes(),(function(u){o.setNode(u,d.node(u))})),h(d.edges(),(function(u){var r=o.edge(u.v,u.w)||{weight:0,minlen:1},a=d.edge(u);o.setEdge(u.v,u.w,{weight:r.weight+a.weight,minlen:Math.max(r.minlen,a.minlen)})})),o})(n),un(n);var t,e=qn(n);for(cn(e),dn(e,n);t=Jn(e);)Hn(e,n,t,Qn(e,n,t))}function dn(n,t){var e=(function(d,o){return Yn(d,o,"post")})(n,n.nodes());e=e.slice(0,e.length-1),h(e,(function(d){(function(o,u,r){var a=o.node(r),i=a.parent;o.edge(r,i).cutvalue=zn(o,u,r)})(n,t,d)}))}function zn(n,t,e){var d=n.node(e).parent,o=!0,u=t.edge(e,d),r=0;return u||(o=!1,u=t.edge(d,e)),r=u.weight,h(t.nodeEdges(e),(function(a){var i,c,f=a.v===e,s=f?a.w:a.v;if(s!==d){var g=f===o,v=t.edge(a).weight;if(r+=g?v:-v,i=e,c=s,n.hasEdge(i,c)){var l=n.edge(e,s).cutvalue;r+=g?-l:l}}})),r}function cn(n,t){arguments.length<2&&(t=n.nodes()[0]),An(n,{},1,t)}function An(n,t,e,d,o){var u=e,r=n.node(d);return t[d]=!0,h(n.neighbors(d),(function(a){Object.prototype.hasOwnProperty.call(t,a)||(e=An(n,t,e,a,d))})),r.low=u,r.lim=e++,o?r.parent=o:delete r.parent,e}function Jn(n){return en(n.edges(),(function(t){return n.edge(t).cutvalue<0}))}function Qn(n,t,e){var d=e.v,o=e.w;t.hasEdge(d,o)||(d=e.w,o=e.v);var u=n.node(d),r=n.node(o),a=u,i=!1;u.lim>r.lim&&(a=r,i=!0);var c=V(t.edges(),(function(f){return i===xn(n,n.node(f.v),a)&&i!==xn(n,n.node(f.w),a)}));return on(c,(function(f){return Y(t,f)}))}function Hn(n,t,e,d){var o=e.v,u=e.w;n.removeEdge(o,u),n.setEdge(d.v,d.w,{}),cn(n),dn(n,t),(function(r,a){var i=en(r.nodes(),(function(f){return!a.node(f).parent})),c=(function(f,s){return Yn(f,s,"pre")})(r,i);c=c.slice(1),h(c,(function(f){var s=r.node(f).parent,g=a.edge(f,s),v=!1;g||(g=a.edge(s,f),v=!0),a.node(f).rank=a.node(s).rank+(v?g.minlen:-g.minlen)}))})(n,t)}function xn(n,t,e){return e.low<=t.lim&&t.lim<=e.lim}function Jr(n){switch(n.graph().ranker){case"network-simplex":default:Hr(n);break;case"tight-tree":(function(t){un(t),qn(t)})(n);break;case"longest-path":Qr(n)}}new Error,R.initLowLimValues=cn,R.initCutValues=dn,R.calcCutValue=zn,R.leaveEdge=Jn,R.enterEdge=Qn,R.exchangeEdges=Hn;var Qr=un;function Hr(n){R(n)}function Kr(n){var t=F(n,"root",{},"_root"),e=(function(r){var a={};function i(c,f){var s=r.children(c);s&&s.length&&h(s,(function(g){i(g,f+1)})),a[c]=f}return h(r.children(),(function(c){i(c,1)})),a})(n),d=T(L(e))-1,o=2*d+1;n.graph().nestingRoot=t,h(n.edges(),(function(r){n.edge(r).minlen*=o}));var u=(function(r){return H(r.edges(),(function(a,i){return a+r.edge(i).weight}),0)})(n)+1;h(n.children(),(function(r){Kn(n,t,o,u,d,e,r)})),n.graph().nodeRankFactor=o}function Kn(n,t,e,d,o,u,r){var a=n.children(r);if(a.length){var i=bn(n,"_bt"),c=bn(n,"_bb"),f=n.node(r);n.setParent(i,r),f.borderTop=i,n.setParent(c,r),f.borderBottom=c,h(a,(function(s){Kn(n,t,e,d,o,u,s);var g=n.node(s),v=g.borderTop?g.borderTop:s,l=g.borderBottom?g.borderBottom:s,w=g.borderTop?d:2*d,p=v!==l?1:o-u[r]+1;n.setEdge(i,v,{weight:w,minlen:p,nestingEdge:!0}),n.setEdge(l,c,{weight:w,minlen:p,nestingEdge:!0})})),n.parent(r)||n.setEdge(t,i,{weight:0,minlen:o+u[r]})}else r!==t&&n.setEdge(t,r,{weight:0,minlen:e})}function Ur(n,t,e){var d=(function(u){for(var r;u.hasNode(r=an("_root")););return r})(n),o=new j({compound:!0}).setGraph({root:d}).setDefaultNodeLabel((function(u){return n.node(u)}));return h(n.nodes(),(function(u){var r=n.node(u),a=n.parent(u);(r.rank===t||r.minRank<=t&&t<=r.maxRank)&&(o.setNode(u),o.setParent(u,a||d),h(n[e](u),(function(i){var c=i.v===u?i.w:i.v,f=o.edge(c,u),s=I(f)?0:f.weight;o.setEdge(c,u,{weight:n.edge(i).weight+s})})),Object.prototype.hasOwnProperty.call(r,"minRank")&&o.setNode(u,{borderLeft:r.borderLeft[t],borderRight:r.borderRight[t]}))})),o}function Wr(n,t){for(var e=0,d=1;d<t.length;++d)e+=Xr(n,t[d-1],t[d]);return e}function Xr(n,t,e){for(var d=(function(c,f){return(function(s,g,v){for(var l=-1,w=s.length,p=g.length,b={};++l<w;){var m=l<p?g[l]:void 0;v(b,s[l],m)}return b})(c||[],f||[],Ln)})(e,k(e,(function(c,f){return f}))),o=S(k(t,(function(c){return q(k(n.outEdges(c),(function(f){return{pos:d[f.w],weight:n.edge(f).weight}})),"pos")}))),u=1;u<e.length;)u<<=1;var r=2*u-1;u-=1;var a=k(new Array(r),(function(){return 0})),i=0;return h(o.forEach((function(c){var f=c.pos+u;a[f]+=c.weight;for(var s=0;f>0;)f%2&&(s+=a[f+1]),a[f=f-1>>1]+=c.weight;i+=c.weight*s}))),i}function Zr(n,t){var e={};return h(n,(function(d,o){var u=e[d.v]={indegree:0,in:[],out:[],vs:[d.v],i:o};I(d.barycenter)||(u.barycenter=d.barycenter,u.weight=d.weight)})),h(t.edges(),(function(d){var o=e[d.v],u=e[d.w];I(o)||I(u)||(u.indegree++,o.out.push(e[d.w]))})),(function(d){var o=[];function u(i){return function(c){c.merged||(I(c.barycenter)||I(i.barycenter)||c.barycenter>=i.barycenter)&&(function(f,s){var g=0,v=0;f.weight&&(g+=f.barycenter*f.weight,v+=f.weight),s.weight&&(g+=s.barycenter*s.weight,v+=s.weight),f.vs=s.vs.concat(f.vs),f.barycenter=g/v,f.weight=v,f.i=Math.min(s.i,f.i),s.merged=!0})(i,c)}}function r(i){return function(c){c.in.push(i),--c.indegree==0&&d.push(c)}}for(;d.length;){var a=d.pop();o.push(a),h(a.in.reverse(),u(a)),h(a.out,r(a))}return k(V(o,(function(i){return!i.merged})),(function(i){return Q(i,["vs","i","barycenter","weight"])}))})(V(e,(function(d){return!d.indegree})))}function $r(n,t){var e,d=(function(s,g){var v={lhs:[],rhs:[]};return h(s,(function(l){g(l)?v.lhs.push(l):v.rhs.push(l)})),v})(n,(function(s){return Object.prototype.hasOwnProperty.call(s,"barycenter")})),o=d.lhs,u=q(d.rhs,(function(s){return-s.i})),r=[],a=0,i=0,c=0;o.sort((e=!!t,function(s,g){return s.barycenter<g.barycenter?-1:s.barycenter>g.barycenter?1:e?g.i-s.i:s.i-g.i})),c=kn(r,u,c),h(o,(function(s){c+=s.vs.length,r.push(s.vs),a+=s.barycenter*s.weight,i+=s.weight,c=kn(r,u,c)}));var f={vs:S(r)};return i&&(f.barycenter=a/i,f.weight=i),f}function kn(n,t,e){for(var d;t.length&&(d=J(t)).i<=e;)t.pop(),n.push(d.vs),e++;return e}function Un(n,t,e,d){var o=n.children(t),u=n.node(t),r=u?u.borderLeft:void 0,a=u?u.borderRight:void 0,i={};r&&(o=V(o,(function(l){return l!==r&&l!==a})));var c=(function(l,w){return k(w,(function(p){var b=l.inEdges(p);if(b.length){var m=H(b,(function(y,x){var N=l.edge(x),E=l.node(x.v);return{sum:y.sum+N.weight*E.order,weight:y.weight+N.weight}}),{sum:0,weight:0});return{v:p,barycenter:m.sum/m.weight,weight:m.weight}}return{v:p}}))})(n,o);h(c,(function(l){if(n.children(l.v).length){var w=Un(n,l.v,e,d);i[l.v]=w,Object.prototype.hasOwnProperty.call(w,"barycenter")&&(b=w,I((p=l).barycenter)?(p.barycenter=b.barycenter,p.weight=b.weight):(p.barycenter=(p.barycenter*p.weight+b.barycenter*b.weight)/(p.weight+b.weight),p.weight+=b.weight))}var p,b}));var f=Zr(c,e);(function(l,w){h(l,(function(p){p.vs=S(p.vs.map((function(b){return w[b]?w[b].vs:b})))}))})(f,i);var s=$r(f,d);if(r&&(s.vs=S([r,s.vs,a]),n.predecessors(r).length)){var g=n.node(n.predecessors(r)[0]),v=n.node(n.predecessors(a)[0]);Object.prototype.hasOwnProperty.call(s,"barycenter")||(s.barycenter=0,s.weight=0),s.barycenter=(s.barycenter*s.weight+g.order+v.order)/(s.weight+2),s.weight+=2}return s}function nt(n){var t=Vn(n),e=En(n,C(1,t+1),"inEdges"),d=En(n,C(t-1,-1,-1),"outEdges"),o=(function(f){var s={},g=V(f.nodes(),(function(p){return!f.children(p).length})),v=T(k(g,(function(p){return f.node(p).rank}))),l=k(C(v+1),(function(){return[]})),w=q(g,(function(p){return f.node(p).rank}));return h(w,(function p(b){if(!Fn(s,b)){s[b]=!0;var m=f.node(b);l[m.rank].push(b),h(f.successors(b),p)}})),l})(n);On(n,o);for(var u,r=Number.POSITIVE_INFINITY,a=0,i=0;i<4;++a,++i){rt(a%2?e:d,a%4>=2);var c=Wr(n,o=K(n));c<r&&(i=0,u=Zn(o,mr|yr),r=c)}On(n,u)}function En(n,t,e){return k(t,(function(d){return Ur(n,d,e)}))}function rt(n,t){var e=new j;h(n,(function(d){var o=d.graph().root,u=Un(d,o,e,t);h(u.vs,(function(r,a){d.node(r).order=a})),(function(r,a,i){var c,f={};h(i,(function(s){for(var g,v,l=r.parent(s);l;){if((g=r.parent(l))?(v=f[g],f[g]=l):(v=c,c=l),v&&v!==l)return void a.setEdge(v,l);l=g}}))})(d,e,u.vs)}))}function On(n,t){h(t,(function(e){h(e,(function(d,o){n.node(d).order=o}))}))}function tt(n){var t=(function(e){var d={},o=0;function u(r){var a=o;h(e.children(r),u),d[r]={low:a,lim:o++}}return h(e.children(),u),d})(n);h(n.graph().dummyChains,(function(e){for(var d=n.node(e),o=d.edgeObj,u=(function(s,g,v,l){var w,p,b=[],m=[],y=Math.min(g[v].low,g[l].low),x=Math.max(g[v].lim,g[l].lim);w=v;do w=s.parent(w),b.push(w);while(w&&(g[w].low>y||x>g[w].lim));for(p=w,w=l;(w=s.parent(w))!==p;)m.push(w);return{path:b.concat(m.reverse()),lca:p}})(n,t,o.v,o.w),r=u.path,a=u.lca,i=0,c=r[i],f=!0;e!==o.w;){if(d=n.node(e),f){for(;(c=r[i])!==a&&n.node(c).maxRank<d.rank;)i++;c===a&&(f=!1)}if(!f){for(;i<r.length-1&&n.node(c=r[i+1]).minRank<=d.rank;)i++;c=r[i]}n.setParent(e,c),e=n.successors(e)[0]}}))}function et(n,t){var e={};return H(t,(function(d,o){var u=0,r=0,a=d.length,i=J(o);return h(o,(function(c,f){var s=(function(v,l){if(v.node(l).dummy)return en(v.predecessors(l),(function(w){return v.node(w).dummy}))})(n,c),g=s?n.node(s).order:a;(s||c===i)&&(h(o.slice(r,f+1),(function(v){h(n.predecessors(v),(function(l){var w=n.node(l),p=w.order;!(p<u||g<p)||w.dummy&&n.node(v).dummy||Wn(e,l,v)}))})),r=f+1,u=g)})),o})),e}function Wn(n,t,e){if(t>e){var d=t;t=e,e=d}Object.prototype.hasOwnProperty.call(n,t)||Object.defineProperty(n,t,{enumerable:!0,configurable:!0,value:{},writable:!0});var o=n[t];Object.defineProperty(o,e,{enumerable:!0,configurable:!0,value:!0,writable:!0})}function ot(n,t,e){if(t>e){var d=t;t=e,e=d}return!!n[t]&&Object.prototype.hasOwnProperty.call(n[t],e)}function it(n,t,e,d,o){var u={},r=(function(c,f,s,g){var v=new j,l=c.graph(),w=(function(p,b,m){return function(y,x,N){var E,_=y.node(x),P=y.node(N),O=0;if(O+=_.width/2,Object.prototype.hasOwnProperty.call(_,"labelpos"))switch(_.labelpos.toLowerCase()){case"l":E=-_.width/2;break;case"r":E=_.width/2}if(E&&(O+=m?E:-E),E=0,O+=(_.dummy?b:p)/2,O+=(P.dummy?b:p)/2,O+=P.width/2,Object.prototype.hasOwnProperty.call(P,"labelpos"))switch(P.labelpos.toLowerCase()){case"l":E=P.width/2;break;case"r":E=-P.width/2}return E&&(O+=m?E:-E),E=0,O}})(l.nodesep,l.edgesep,g);return h(f,(function(p){var b;h(p,(function(m){var y=s[m];if(v.setNode(y),b){var x=s[b],N=v.edge(x,y);v.setEdge(x,y,Math.max(w(c,m,b),N||0))}b=m}))})),v})(n,t,e,o),a=o?"borderLeft":"borderRight";function i(c,f){for(var s=r.nodes(),g=s.pop(),v={};g;)v[g]?c(g):(v[g]=!0,s.push(g),s=s.concat(f(g))),g=s.pop()}return i((function(c){u[c]=r.inEdges(c).reduce((function(f,s){return Math.max(f,u[s.v]+r.edge(s))}),0)}),r.predecessors.bind(r)),i((function(c){var f=r.outEdges(c).reduce((function(g,v){return Math.min(g,u[v.w]-r.edge(v))}),Number.POSITIVE_INFINITY),s=n.node(c);f!==Number.POSITIVE_INFINITY&&s.borderType!==a&&(u[c]=Math.max(u[c],f))}),r.successors.bind(r)),h(d,(function(c){u[c]=u[e[c]]})),u}function at(n,t){return on(L(t),(function(e){var d,o,u=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return o=function(a,i){var c=(function(f,s){return f.node(s).width})(n,i)/2;u=Math.max(a+c,u),r=Math.min(a-c,r)},(d=e)==null||hr(d,Nn(o),Tn),u-r}))}function ut(n){var t,e=K(n),d=rn(et(n,e),(function(r,a){var i={};function c(f,s,g,v,l){var w;h(C(s,g),(function(p){w=f[p],r.node(w).dummy&&h(r.predecessors(w),(function(b){var m=r.node(b);m.dummy&&(m.order<v||m.order>l)&&Wn(i,b,w)}))}))}return H(a,(function(f,s){var g,v=-1,l=0;return h(s,(function(w,p){if(r.node(w).dummy==="border"){var b=r.predecessors(w);b.length&&(g=r.node(b[0]).order,c(s,l,p,v,g),l=p,v=g)}c(s,l,s.length,g,f.length)})),s})),i})(n,e)),o={};h(["u","d"],(function(r){t=r==="u"?e:L(e).reverse(),h(["l","r"],(function(a){a==="r"&&(t=k(t,(function(s){return L(s).reverse()})));var i=(r==="u"?n.predecessors:n.successors).bind(n),c=(function(s,g,v,l){var w={},p={},b={};return h(g,(function(m){h(m,(function(y,x){w[y]=y,p[y]=y,b[y]=x}))})),h(g,(function(m){var y=-1;h(m,(function(x){var N=l(x);if(N.length){N=q(N,(function(Xn){return b[Xn]}));for(var E=(N.length-1)/2,_=Math.floor(E),P=Math.ceil(E);_<=P;++_){var O=N[_];p[x]===x&&y<b[O]&&!ot(v,x,O)&&(p[O]=x,p[x]=w[x]=w[O],y=b[O])}}}))})),{root:w,align:p}})(0,t,d,i),f=it(n,t,c.root,c.align,a==="r");a==="r"&&(f=z(f,(function(s){return-s}))),o[r+a]=f}))}));var u=at(n,o);return(function(r,a){var i=L(a),c=B(i),f=T(i);h(["u","d"],(function(s){h(["l","r"],(function(g){var v,l=s+g,w=r[l];if(w!==a){var p=L(w);(v=g==="l"?c-B(p):f-T(p))&&(r[l]=z(w,(function(b){return b+v})))}}))}))})(o,u),(function(r,a){return z(r.ul,(function(i,c){if(a)return r[a.toLowerCase()][c];var f=q(k(r,c));return(f[1]+f[2])/2}))})(o,n.graph().align)}function dt(n){var t,e;(function(d){var o=K(d),u=d.graph().ranksep,r=0;h(o,(function(a){var i=T(k(a,(function(c){return d.node(c).height})));h(a,(function(c){d.node(c).y=r+i/2})),r+=i+u}))})(n=Gn(n)),t=ut(n),e=function(d,o){n.node(o).x=d},t&&_n(t,Nn(e))}function kt(n,t){var e=Br;e("layout",(()=>{var d=e("  buildLayoutGraph",(()=>(function(o){var u=new j({multigraph:!0,compound:!0}),r=nn(o.graph());return u.setGraph(rn({},st,$(r,ct),Q(r,ft))),h(o.nodes(),(function(a){var i=nn(o.node(a));u.setNode(a,kr($(i,ht),gt)),u.setParent(a,o.parent(a))})),h(o.edges(),(function(a){var i=nn(o.edge(a));u.setEdge(a,rn({},lt,$(i,vt),Q(i,pt)))})),u})(n)));e("  runLayout",(()=>(function(o,u){u("    makeSpaceForEdgeLabels",(()=>(function(r){var a=r.graph();a.ranksep/=2,h(r.edges(),(function(i){var c=r.edge(i);c.minlen*=2,c.labelpos.toLowerCase()!=="c"&&(a.rankdir==="TB"||a.rankdir==="BT"?c.width+=c.labeloffset:c.height+=c.labeloffset)}))})(o))),u("    removeSelfEdges",(()=>(function(r){h(r.edges(),(function(a){if(a.v===a.w){var i=r.node(a.v);i.selfEdges||(i.selfEdges=[]),i.selfEdges.push({e:a,label:r.edge(a)}),r.removeEdge(a)}}))})(o))),u("    acyclic",(()=>Vr(o))),u("    nestingGraph.run",(()=>Kr(o))),u("    rank",(()=>Jr(Gn(o)))),u("    injectEdgeLabelProxies",(()=>(function(r){h(r.edges(),(function(a){var i=r.edge(a);if(i.width&&i.height){var c=r.node(a.v),f={rank:(r.node(a.w).rank-c.rank)/2+c.rank,e:a};F(r,"edge-proxy",f,"_ep")}}))})(o))),u("    removeEmptyRanks",(()=>(function(r){var a=B(k(r.nodes(),(function(s){return r.node(s).rank}))),i=[];h(r.nodes(),(function(s){var g=r.node(s).rank-a;i[g]||(i[g]=[]),i[g].push(s)}));var c=0,f=r.graph().nodeRankFactor;h(i,(function(s,g){I(s)&&g%f!=0?--c:c&&h(s,(function(v){r.node(v).rank+=c}))}))})(o))),u("    nestingGraph.cleanup",(()=>(function(r){var a=r.graph();r.removeNode(a.nestingRoot),delete a.nestingRoot,h(r.edges(),(function(i){r.edge(i).nestingEdge&&r.removeEdge(i)}))})(o))),u("    normalizeRanks",(()=>(function(r){var a=B(k(r.nodes(),(function(i){return r.node(i).rank})));h(r.nodes(),(function(i){var c=r.node(i);Fn(c,"rank")&&(c.rank-=a)}))})(o))),u("    assignRankMinMax",(()=>(function(r){var a=0;h(r.nodes(),(function(i){var c=r.node(i);c.borderTop&&(c.minRank=r.node(c.borderTop).rank,c.maxRank=r.node(c.borderBottom).rank,a=T(a,c.maxRank))})),r.graph().maxRank=a})(o))),u("    removeEdgeLabelProxies",(()=>(function(r){h(r.nodes(),(function(a){var i=r.node(a);i.dummy==="edge-proxy"&&(r.edge(i.e).labelRank=i.rank,r.removeNode(a))}))})(o))),u("    normalize.run",(()=>Yr(o))),u("    parentDummyChains",(()=>tt(o))),u("    addBorderSegments",(()=>(function(r){h(r.children(),(function a(i){var c=r.children(i),f=r.node(i);if(c.length&&h(c,a),Object.prototype.hasOwnProperty.call(f,"minRank")){f.borderLeft=[],f.borderRight=[];for(var s=f.minRank,g=f.maxRank+1;s<g;++s)mn(r,"borderLeft","_bl",i,f,s),mn(r,"borderRight","_br",i,f,s)}}))})(o))),u("    order",(()=>nt(o))),u("    insertSelfEdges",(()=>(function(r){var a=K(r);h(a,(function(i){var c=0;h(i,(function(f,s){var g=r.node(f);g.order=s+c,h(g.selfEdges,(function(v){F(r,"selfedge",{width:v.label.width,height:v.label.height,rank:g.rank,order:s+ ++c,e:v.e,label:v.label},"_se")})),delete g.selfEdges}))}))})(o))),u("    adjustCoordinateSystem",(()=>(function(r){var a=r.graph().rankdir.toLowerCase();a!=="lr"&&a!=="rl"||Bn(r)})(o))),u("    position",(()=>dt(o))),u("    positionSelfEdges",(()=>(function(r){h(r.nodes(),(function(a){var i=r.node(a);if(i.dummy==="selfedge"){var c=r.node(i.e.v),f=c.x+c.width/2,s=c.y,g=i.x-f,v=c.height/2;r.setEdge(i.e,i.label),r.removeNode(a),i.label.points=[{x:f+2*g/3,y:s-v},{x:f+5*g/6,y:s-v},{x:f+g,y:s},{x:f+5*g/6,y:s+v},{x:f+2*g/3,y:s+v}],i.label.x=i.x,i.label.y=i.y}}))})(o))),u("    removeBorderNodes",(()=>(function(r){h(r.nodes(),(function(a){if(r.children(a).length){var i=r.node(a),c=r.node(i.borderTop),f=r.node(i.borderBottom),s=r.node(J(i.borderLeft)),g=r.node(J(i.borderRight));i.width=Math.abs(g.x-s.x),i.height=Math.abs(f.y-c.y),i.x=s.x+i.width/2,i.y=c.y+i.height/2}})),h(r.nodes(),(function(a){r.node(a).dummy==="border"&&r.removeNode(a)}))})(o))),u("    normalize.undo",(()=>(function(r){h(r.graph().dummyChains,(function(a){var i,c=r.node(a),f=c.edgeLabel;for(r.setEdge(c.edgeObj,f);c.dummy;)i=r.successors(a)[0],r.removeNode(a),f.points.push({x:c.x,y:c.y}),c.dummy==="edge-label"&&(f.x=c.x,f.y=c.y,f.width=c.width,f.height=c.height),a=i,c=r.node(a)}))})(o))),u("    fixupEdgeLabelCoords",(()=>(function(r){h(r.edges(),(function(a){var i=r.edge(a);if(Object.prototype.hasOwnProperty.call(i,"x"))switch(i.labelpos!=="l"&&i.labelpos!=="r"||(i.width-=i.labeloffset),i.labelpos){case"l":i.x-=i.width/2+i.labeloffset;break;case"r":i.x+=i.width/2+i.labeloffset}}))})(o))),u("    undoCoordinateSystem",(()=>qr(o))),u("    translateGraph",(()=>(function(r){var a=Number.POSITIVE_INFINITY,i=0,c=Number.POSITIVE_INFINITY,f=0,s=r.graph(),g=s.marginx||0,v=s.marginy||0;function l(w){var p=w.x,b=w.y,m=w.width,y=w.height;a=Math.min(a,p-m/2),i=Math.max(i,p+m/2),c=Math.min(c,b-y/2),f=Math.max(f,b+y/2)}h(r.nodes(),(function(w){l(r.node(w))})),h(r.edges(),(function(w){var p=r.edge(w);Object.prototype.hasOwnProperty.call(p,"x")&&l(p)})),a-=g,c-=v,h(r.nodes(),(function(w){var p=r.node(w);p.x-=a,p.y-=c})),h(r.edges(),(function(w){var p=r.edge(w);h(p.points,(function(b){b.x-=a,b.y-=c})),Object.prototype.hasOwnProperty.call(p,"x")&&(p.x-=a),Object.prototype.hasOwnProperty.call(p,"y")&&(p.y-=c)})),s.width=i-a+g,s.height=f-c+v})(o))),u("    assignNodeIntersects",(()=>(function(r){h(r.edges(),(function(a){var i,c,f=r.edge(a),s=r.node(a.v),g=r.node(a.w);f.points?(i=f.points[0],c=f.points[f.points.length-1]):(f.points=[],i=g,c=s),f.points.unshift(wn(s,i)),f.points.push(wn(g,c))}))})(o))),u("    reversePoints",(()=>(function(r){h(r.edges(),(function(a){var i=r.edge(a);i.reversed&&i.points.reverse()}))})(o))),u("    acyclic.undo",(()=>(function(r){h(r.edges(),(function(a){var i=r.edge(a);if(i.reversed){r.removeEdge(a);var c=i.forwardName;delete i.reversed,delete i.forwardName,r.setEdge(a.w,a.v,i,c)}}))})(o)))})(d,e))),e("  updateInputGraph",(()=>(function(o,u){h(o.nodes(),(function(r){var a=o.node(r),i=u.node(r);a&&(a.x=i.x,a.y=i.y,u.children(r).length&&(a.width=i.width,a.height=i.height))})),h(o.edges(),(function(r){var a=o.edge(r),i=u.edge(r);a.points=i.points,Object.prototype.hasOwnProperty.call(i,"x")&&(a.x=i.x,a.y=i.y)})),o.graph().width=u.graph().width,o.graph().height=u.graph().height})(n,d)))}))}var ct=["nodesep","edgesep","ranksep","marginx","marginy"],st={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},ft=["acyclicer","ranker","rankdir","align"],ht=["width","height"],gt={width:0,height:0},vt=["minlen","weight","width","height","labeloffset"],lt={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},pt=["labelpos"];function $(n,t){return z(Q(n,t),Number)}function nn(n){var t={};return h(n,(function(e,d){t[d.toLowerCase()]=e})),t}export{kt as l};
//# sourceMappingURL=layout-BCBuSoBU.js.map
