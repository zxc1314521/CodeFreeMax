import{w as c,W as t}from"./debounce-BNOmQ76Y.js";try{n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(d=new n.Error().stack)&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[d]="befeed2d-640a-4360-a06f-6dd800145d85",n._sentryDebugIdIdentifier="sentry-dbid-befeed2d-640a-4360-a06f-6dd800145d85")}catch{}var n,d;class u{constructor(e){this._asyncMsgSender=e}static key="remoteAgentsDiffOpsModel";_applyingFilePaths=c([]);_appliedFilePaths=c([]);get applyingFilePaths(){let e=[];return this._applyingFilePaths.subscribe((r=>{e=r}))(),e}get appliedFilePaths(){let e=[];return this._appliedFilePaths.subscribe((r=>{e=r}))(),e}async getDescriptionsFromRemoteAgentSummary(e,r,o=0,s=1e5){try{return(await this._asyncMsgSender.send({type:t.remoteAgentGenerateSummaryForDiffDescriptionsRequest,data:{agentId:e,startSequenceId:o,endSequenceId:s,groupedChanges:r}},1e5)).data}catch(a){return console.error("Failed to get descriptions from remote agent summary:",a),{explanation:[],error:`Failed to get descriptions: ${a instanceof Error?a.message:String(a)}`}}}async canApplyChanges(){try{return(await this._asyncMsgSender.send({type:t.canApplyChangesRequest},1e4)).data}catch(e){return console.error("Failed to check if can apply changes:",e),{canApply:!1,hasUnstagedChanges:!1,error:`Failed to check if can apply changes: ${e instanceof Error?e.message:String(e)}`}}}async applyChanges(e,r,o){this._applyingFilePaths.update((s=>[...s.filter((a=>a!==e)),e]));try{const s=await this._asyncMsgSender.send({type:t.applyChangesRequest,data:{path:e,originalCode:r,newCode:o}},3e4),{success:a,hasConflicts:l,error:i}=s.data;return a?this._appliedFilePaths.update((g=>[...g.filter((h=>h!==e)),e])):i&&console.error("Failed to apply changes:",i),{success:a,hasConflicts:l,error:i}}catch(s){return console.error("applyChanges error",s),{success:!1,error:`Error: ${s instanceof Error?s.message:String(s)}`}}finally{this._applyingFilePaths.update((s=>s.filter((a=>a!==e))))}}async previewApplyChanges(e,r,o){try{return(await this._asyncMsgSender.send({type:t.previewApplyChangesRequest,data:{path:e,originalCode:r,newCode:o}},3e4)).data}catch(s){return console.error("previewApplyChanges error",s),{mergedContent:"",hasConflicts:!1,error:`Error: ${s instanceof Error?s.message:String(s)}`}}}async openFile(e){try{const r=await this._asyncMsgSender.send({type:t.openFileRequest,data:{path:e}},1e4);return r.data.success||console.error("Failed to open file:",r.data.error),r.data.success}catch(r){console.error("openFile error",r)}return!1}async stashUnstagedChanges(){try{const e=await this._asyncMsgSender.send({type:t.stashUnstagedChangesRequest},1e4);return e.data.success||console.error("Failed to stash unstaged changes:",e.data.error),e.data.success}catch(e){console.error("stashUnstagedChanges error",e)}return!1}async reportApplyChangesEvent(){await this._asyncMsgSender.send({type:t.reportAgentChangesApplied})}}export{u as R};
//# sourceMappingURL=ra-diff-ops-model-BShDGWD3.js.map
