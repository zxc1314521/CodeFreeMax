import{az as st,D as it,$ as P,a5 as G,aD as nt,k as lt,ae as rt,ai as z,a6 as ot,K as p,P as i,Q as o,O as f,_ as dt,a1 as I,R as d,H as ct,a0 as m,o as e,aE as vt,a4 as Ne,a2 as H,S as ye,T as N,a3 as pt,ag as O,aA as he,G as gt,ax as mt}from"./debounce-BNOmQ76Y.js";import"./design-system-init-DYAh9Pko.js";import{b as J}from"./input-rvYD24wa.js";import{M as Oe}from"./Markdown-9Uvf-DZ6.js";import"./legacy-2-VBD5Kq.js";import"./toggleHighContrast-nRmgfX6B.js";import"./SimpleMonaco-BBDXOnfl.js";try{U=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(Le=new U.Error().stack)&&(U._sentryDebugIds=U._sentryDebugIds||{},U._sentryDebugIds[Le]="bb0a5c04-bcf4-4eb7-8d9d-c60613a5559a",U._sentryDebugIdIdentifier="sentry-dbid-bb0a5c04-bcf4-4eb7-8d9d-c60613a5559a")}catch{}var U,Le,q=(g=>(g.loaded="image-gallery-loaded",g.selectDirectory="image-gallery-select-directory",g.refresh="image-gallery-refresh",g.openImage="image-gallery-open-image",g.mentionInChat="image-gallery-mention-in-chat",g.initialize="image-gallery-initialize",g.imagesUpdated="image-gallery-images-updated",g.imageUpdating="image-gallery-image-updating",g.imageUpdated="image-gallery-image-updated",g.scrollToImage="image-gallery-scroll-to-image",g.error="image-gallery-error",g))(q||{}),yt=p('<div class="settings-panel svelte-1hvf6qy"><div class="setting-row svelte-1hvf6qy"><label class="setting-label svelte-1hvf6qy"><span>Columns</span> <input type="number" class="setting-input svelte-1hvf6qy" min="0" max="12" placeholder="Auto"/> <span class="setting-hint svelte-1hvf6qy">0 = auto</span></label></div> <div class="setting-row svelte-1hvf6qy"><label class="setting-label svelte-1hvf6qy"><span>Max Width</span> <input type="text" class="setting-input svelte-1hvf6qy" placeholder="e.g. 200px or 50%"/></label></div> <div class="setting-row svelte-1hvf6qy"><label class="setting-label svelte-1hvf6qy"><span>Max Height</span> <input type="text" class="setting-input svelte-1hvf6qy" placeholder="e.g. 200px or 50%"/></label></div> <div class="setting-row svelte-1hvf6qy"><label class="setting-label svelte-1hvf6qy"><span>Zoom:</span> <input type="range" class="setting-slider svelte-1hvf6qy" min="25" max="200" step="5"/> <span> </span></label></div></div>'),ht=p('<div class="loading-state svelte-1hvf6qy"><span class="loading-spinner svelte-1hvf6qy"></span> <span>Loading images...</span></div>'),ut=p('<div class="error-state svelte-1hvf6qy"><span class="error-icon svelte-1hvf6qy">‚ö†Ô∏è</span> <span> </span></div>'),ft=p('<div class="empty-state svelte-1hvf6qy"><span class="empty-icon svelte-1hvf6qy">üñºÔ∏è</span> <span>Select a directory to view images</span></div>'),bt=p('<div class="empty-state svelte-1hvf6qy"><span class="empty-icon svelte-1hvf6qy">üì≠</span> <span>No images found in this directory</span></div>'),qt=p('<div class="image-updating-overlay svelte-1hvf6qy"><span class="updating-spinner svelte-1hvf6qy"></span> <span class="updating-text svelte-1hvf6qy">Updating...</span></div>'),wt=p('<button class="expand-arrow-button svelte-1hvf6qy"> </button>'),xt=p('<pre class="description-text svelte-1hvf6qy"> </pre>'),_t=p('<button class="expand-button svelte-1hvf6qy">Show less</button>'),kt=p("<!> <!>",1),It=p('<pre class="description-text svelte-1hvf6qy"> </pre>'),St=p('<button class="expand-button svelte-1hvf6qy">...</button>'),Pt=p("<!> <!>",1),zt=p('<div class="image-description svelte-1hvf6qy"><!></div>'),Et=p('<div class="image-card svelte-1hvf6qy" role="button" tabindex="0"><!> <div><img loading="lazy" class="svelte-1hvf6qy"/></div> <div class="image-info svelte-1hvf6qy"><div class="image-name-row svelte-1hvf6qy"><span class="image-name svelte-1hvf6qy"> </span> <!> <button class="mention-button svelte-1hvf6qy" title="Mention in chat">@</button></div> <!></div></div>'),Mt=p('<div class="image-grid svelte-1hvf6qy"></div>'),Tt=p('<div class="image-gallery svelte-1hvf6qy"><header class="gallery-header svelte-1hvf6qy"><div class="directory-selector svelte-1hvf6qy"><input type="text" class="directory-input svelte-1hvf6qy" placeholder="Select a directory..." readonly=""/> <button class="browse-button svelte-1hvf6qy" title="Browse for directory">üìÅ</button> <button class="refresh-button svelte-1hvf6qy" title="Refresh images">üîÑ</button> <button title="View settings">‚öôÔ∏è</button></div> <!></header> <main class="gallery-content svelte-1hvf6qy"><!></main></div>');function At(g,Ve){it(Ve,!0);let E=P(G([])),M=P(""),W=P(!0),Z=P(null),j=P(null),ue=null,K=P(G(new Set)),T=P(G(new Set));const fe="imageGallerySettings";let n=G((function(t,a){let l={...a};try{const c=localStorage.getItem(t);c&&(l={...l,...JSON.parse(c)})}catch(c){console.error("Failed to load settings:",c)}return l})(fe,{settingsExpanded:!1,columnsPerRow:2,maxWidth:"",maxHeight:"",zoom:100}));const be=nt((t=>{requestAnimationFrame((()=>ee(t)))}),500);function qe(t){return t.split(`
`).filter((a=>a.trim()!==""))}function we(t){return qe(t).slice(0,2).join(`
`)}function Q(t){return qe(t).length>2}function X(t,a=!1){const l=new Set(e(K));a||l.has(t)?(l.delete(t),requestAnimationFrame((()=>{document.querySelector(`[data-image-id="${t}"]`)?.scrollIntoView({behavior:"smooth",block:"nearest"})}))):l.add(t),m(K,l,!0)}function Y(t){return e(K).has(t)}function xe(t){return e(T).has(t)}function _e(t){const a=t.data;switch(a.type){case q.initialize:l=a.data,m(M,l.directoryPath||"",!0),m(E,l.images||[],!0),m(j,l.scrollToImageId||null,!0),m(W,!1),e(j)&&ee(e(j));break;case q.imagesUpdated:m(E,a.data.images||[],!0),m(T,new Set,!0),m(W,!1),a.data.scrollToImageId&&be(a.data.scrollToImageId);break;case q.imageUpdating:{const c=a.data.imagePath,w=new Set(e(T));w.add(c),m(T,w,!0)}break;case q.imageUpdated:{const c=a.data.image;m(E,e(E).map((b=>b.id===c.id?c:b)),!0);const w=new Set(e(T));w.delete(c.id),m(T,w,!0)}break;case q.error:m(Z,a.data.message,!0),m(W,!1);break;case q.scrollToImage:{const c=a.data.imagePath;requestAnimationFrame((()=>ee(c)))}}var l}function ee(t){const a=document.querySelectorAll("[data-image-id]"),l=Array.from(a).find((c=>c.getAttribute("data-image-id")===t));l&&l.scrollIntoView({behavior:"smooth",block:"center"})}function ke(){z.postMessage({type:q.selectDirectory,data:{currentPath:e(M)}})}function Ie(t){z.postMessage({type:q.openImage,data:{imagePath:t.path}})}lt((()=>{n.settingsExpanded,n.columnsPerRow,n.maxWidth,n.maxHeight,n.zoom,(function(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch(l){console.error("Failed to save settings:",l)}})(fe,n)})),rt((()=>{window.addEventListener("message",_e),z.postMessage({type:q.loaded})})),ot((()=>{window.removeEventListener("message",_e),be.cancel()}));var Se=Tt(),Pe=i(Se),ze=i(Pe),te=i(ze);te.__click=ke;var Ee=o(te,2);Ee.__click=ke;var ae=o(Ee,2);ae.__click=function(){m(W,!0),z.postMessage({type:q.refresh,data:{directoryPath:e(M)}})};var Me=o(ae,2);let Te;Me.__click=()=>n.settingsExpanded=!n.settingsExpanded;var Be=o(ze,2),Ge=t=>{var a=yt(),l=i(a),c=i(l),w=o(i(c),2),b=o(l,2),S=i(b),F=o(i(S),2),A=o(b,2),se=i(A),x=o(i(se),2),D=o(A,2),ie=i(D),V=o(i(ie),2),ne=o(V,2),_=i(ne);I((()=>H(_,`${n.zoom??""}%`))),J(w,(()=>n.columnsPerRow),(y=>n.columnsPerRow=y)),J(F,(()=>n.maxWidth),(y=>n.maxWidth=y)),J(x,(()=>n.maxHeight),(y=>n.maxHeight=y)),J(V,(()=>n.zoom),(y=>n.zoom=y)),d(t,a)};f(Be,(t=>{n.settingsExpanded&&t(Ge)}));var Ae=o(Pe,2),Je=i(Ae),Ze=t=>{var a=ht();d(t,a)},je=t=>{var a=ye(),l=N(a),c=b=>{var S=ut(),F=o(i(S),2),A=i(F);I((()=>H(A,e(Z)))),d(b,S)},w=b=>{var S=ye(),F=N(S),A=x=>{var D=ft();d(x,D)},se=x=>{var D=ye(),ie=N(D),V=_=>{var y=bt();d(_,y)},ne=_=>{var y=Mt();let De;pt(y,21,(()=>e(E)),(le=>le.id),((le,s)=>{var R=Et();let Re;R.__click=()=>Ie(e(s)),R.__keydown=v=>v.key==="Enter"&&Ie(e(s));var Ue=i(R),Ke=v=>{var h=qt();d(v,h)};f(Ue,(v=>{xe(e(s).id)&&v(Ke)}));var B=o(Ue,2);let He,We;var Fe=i(B),Qe=o(B,2),$e=i(Qe),re=i($e),Xe=i(re),Ce=o(re,2),Ye=v=>{var h=wt();h.__click=$=>{$.stopPropagation(),X(e(s).id)};var oe=i(h);I((($,de)=>{O(h,"title",$),H(oe,de)}),[()=>Y(e(s).id)?"Collapse description":"Expand description",()=>Y(e(s).id)?"‚ñ≤":"‚ñº"]),d(v,h)};f(Ce,(v=>{e(s).description&&Q(e(s).description)&&v(Ye)})),o(Ce,2).__click=v=>{return h=e(s).path,v.stopPropagation(),void z.postMessage({type:q.mentionInChat,data:{imagePath:h}});var h};var et=o($e,2),tt=v=>{var h=zt();h.__click=k=>k.stopPropagation();var oe=i(h),$=k=>{var C=kt(),L=N(C),ce=r=>{Oe(r,{get markdown(){return e(s).description}})},ve=r=>{var u=xt(),me=i(u);I((()=>H(me,e(s).description))),d(r,u)};f(L,(r=>{e(s).descriptionType==="md"?r(ce):r(ve,!1)}));var pe=o(L,2),ge=r=>{var u=_t();u.__click=()=>X(e(s).id,!0),d(r,u)};f(pe,(r=>{Q(e(s).description)&&r(ge)})),d(k,C)},de=k=>{var C=Pt(),L=N(C),ce=r=>{{let u=gt((()=>we(e(s).description)));Oe(r,{get markdown(){return e(u)}})}},ve=r=>{var u=It(),me=i(u);I((at=>H(me,at)),[()=>we(e(s).description)]),d(r,u)};f(L,(r=>{e(s).descriptionType==="md"?r(ce):r(ve,!1)}));var pe=o(L,2),ge=r=>{var u=St();u.__click=()=>X(e(s).id),d(r,u)};f(pe,(r=>{Q(e(s).description)&&r(ge)})),d(k,C)};f(oe,(k=>{Y(e(s).id)?k($):k(de,!1)})),d(v,h)};f(et,(v=>{e(s).description&&v(tt)})),I((v=>{O(R,"data-image-id",e(s).id),Re=he(R,"",Re,{"max-width":n.maxWidth||void 0,"max-height":n.maxHeight||void 0}),He=Ne(B,1,"image-wrapper svelte-1hvf6qy",null,He,v),We=he(B,"",We,{transform:`scale(${n.zoom/100})`}),O(Fe,"src",e(s).webviewUri),O(Fe,"alt",e(s).name),O(re,"title",e(s).name),H(Xe,e(s).name)}),[()=>({updating:xe(e(s).id)})]),d(le,R)})),I((()=>De=he(y,"",De,{"grid-template-columns":n.columnsPerRow>0?`repeat(${n.columnsPerRow}, 1fr)`:"repeat(auto-fill, minmax(200px, 1fr))"}))),d(_,y)};f(ie,(_=>{e(E).length===0?_(V):_(ne,!1)}),!0),d(x,D)};f(F,(x=>{e(M)?x(se,!1):x(A)}),!0),d(b,S)};f(l,(b=>{e(Z)?b(c):b(w,!1)}),!0),d(t,a)};f(Je,(t=>{e(W)?t(Ze):t(je,!1)})),dt(Ae,(t=>ue=t),(()=>ue)),I((()=>{vt(te,e(M)),ae.disabled=!e(M),Te=Ne(Me,1,"settings-toggle svelte-1hvf6qy",null,Te,{active:n.settingsExpanded})})),d(g,Se),ct()}st(["click","keydown"]),(async function(){z?.initialize&&await z.initialize(),mt(At,{target:document.getElementById("app")})})();
//# sourceMappingURL=image-gallery-yqdouQqv.js.map
