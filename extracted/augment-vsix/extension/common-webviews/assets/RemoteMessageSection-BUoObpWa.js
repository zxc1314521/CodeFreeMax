import{aP as Pn,aq as Bn,D as it,E as le,K as d,P as r,Q as u,O as p,R as t,H as ct,S as H,T as m,V as Ze,Y as X,a1 as Re,a2 as Be,X as zt,o as e,G as o,a3 as Pt,$ as se,a0 as s,F as ut,ae as It,w as _t,I as mt,J as Ge,aD as Bt,k as $t,y as En,av as en,aw as tn,Z as Ie,_ as St,ad as ht,az as Mt,a4 as Nt,ag as Et,a6 as Tt,ah as nn,aN as an,aQ as rn,a5 as Fn,aR as zn}from"./debounce-BNOmQ76Y.js";import{a as Mn,C as Nn,k as Sn}from"./CollapseButtonAugment-D7C6pQtq.js";import{s as Tn,c as Un}from"./index-BcYmouan.js";import{R as wt,S as Hn}from"./OpenFileButton-gT822Pcb.js";import{A as On,S as Gn,d as Ut,e as qn,f as jn,R as Wn,D as Vn,I as xt,g as Kn,h as Jn,i as Xn,j as Qn,k as Zn,l as qt,m as Yn,n as ea,o as ta,p as na,q as sn,r as on,t as aa,c as jt,s as ra,C as sa}from"./main-panel-BBvwZc5z.js";import{P as Dt}from"./shared-app-state-Cv5sumpT.js";import{t as Ft,s as oa,a as cn}from"./index-DJ8YNXIh.js";import{I as kt}from"./IconButtonAugment-DO0xxfgT.js";import{T as Ne,I as ye,S as Ct}from"./Icon-CohttyM7.js";import{T as ot,a as pt}from"./TextTooltipAugment-CGvqFHAr.js";import{E as ia,R as Wt,a as ln,b as ca}from"./AugmentMessage-DdGCJFWr.js";import{B as dt}from"./ButtonAugment-BCcs6kST.js";import{z as kn,a as Ht,x as la,b as Xt,q as Qt,B as Cn,o as Ln,f as xn,v as da,i as dn,C as ua,G as va,H as At,I as un,J as ha,K as pa,L as vn,N as ga,O as ma,P as hn,Q as fa,U as yt,V as Rt,W as _a,X as $a,Y as wa,Z as ba,T as Vt,D as He,_ as ya,e as pn,$ as Ra}from"./extension-client-context-CN64fWtK.js";import{D as gn,M as Aa,d as Sa}from"./diff-operations-Z7nGHKvy.js";import{d as mn}from"./index-C6s5m6Q5.js";import{n as ka}from"./noop-CVINQ7cR.js";import{a as gt,R as fn}from"./index-Dqp5W2S2.js";import{c as Ca}from"./utils-C8k4ijpS.js";import{e as La}from"./file-type-utils-CHwkiE7w.js";import{i as xa,b as Ia}from"./RemoteAgentStatusIndicator-gpVGge6K.js";import{b as Da,B as _n}from"./types-M1pd3FSp.js";import{g as $n,a as Pa,P as Ba,R as wn,A as Ea}from"./Keybindings-SM11jtx_.js";import{E as Fa,C as za}from"./message-broker-DUQuEFlt.js";import{C as Ot}from"./CalloutAugment-BTDUhyqD.js";import{C as Ma}from"./CopyButton-DWjSvbZb.js";import{b as Na}from"./input-rvYD24wa.js";import{T as bn}from"./TextCombo-CIszZzGN.js";import{R as Ta,B as Ua}from"./RepoBadge-DNGwkTuQ.js";import"./index-Dt79ugWJ.js";import"./remote-agents-client-DkZKHKJj.js";import"./SuccessfulButton-BTRD1tJd.js";import"./design-system-init-DYAh9Pko.js";import"./legacy-2-VBD5Kq.js";import"./index-Ba8SPQX6.js";import"./SimpleMonaco-BBDXOnfl.js";import"./await-B0-dHWqK.js";import"./Chevron-DgXCK6y3.js";import"./BaseTextInput-D02l0mHz.js";import"./shared-webview-store-model-CL3-OUxX.js";import"./ra-diff-ops-model-BShDGWD3.js";import"./Filespan-FcScXFRk.js";import"./LanguageIcon-BFxv44vU.js";import"./lifecycle-CWu4CNTE.js";import"./toggleHighContrast-nRmgfX6B.js";import"./Markdown-9Uvf-DZ6.js";import"./mermaid-BF5da6U1.js";import"./_commonjsHelpers-CwkBNZ52.js";import"./IconFilePath-BzwPVm4g.js";import"./next-edit-types-B8NR3rVy.js";import"./keypress-fD7XHdyk.js";try{Lt=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(Yt=new Lt.Error().stack)&&(Lt._sentryDebugIds=Lt._sentryDebugIds||{},Lt._sentryDebugIds[Yt]="6a46277b-addf-4395-aa11-cf1fa263c985",Lt._sentryDebugIdIdentifier="sentry-dbid-6a46277b-addf-4395-aa11-cf1fa263c985")}catch{}var Lt,Yt;function Kt(De){const n=De.match(/github\.com\/([^/]+)\/([^/]+?)(?:\.git|\/|$)/);if(n)return{owner:n[1],name:n[2]}}function In(De){const n=De.match(/^[^/]+\/HEAD\s*->\s*(.+)$/);if(n)return In(n[1]);const a=(function(f){const x=f.match(/^refs\/remotes\/([^/]+)\/(.+)$/);if(x)return{remote:x[1],branch:x[2]};const g=f.match(/^([^/]+)\/(.+)$/);if(g){const[,y,M]=g;if(["origin","upstream","fork","github","gitlab","bitbucket"].includes(y)||y.includes("."))return{remote:y,branch:M}}return null})(De);return a?a.branch:De}var Ha=d('<div class="c-agent-edits-header__summary"><!></div>'),Oa=d('<!> <span class="c-agent-edits-header__revert-btn__text">Discard All</span>',1),Ga=d('<!> <span class="c-agent-edits-header__accept-btn__text">Keep All</span>',1),qa=d('<div class="c-agent-edits-header__actions"><!> <!> <!></div>'),ja=d('<div class="c-agent-edits-header svelte-14lt18i"><div class="c-agent-edits-header__content"><div class="c-agent-edits-header__collapse-btn"><!></div> <div class="c-agent-edits-header__info-container"><!></div> <!></div> <!></div>');function Wa(De,n){it(n,!0);let a=le(n,"onRevert",19,(()=>{})),f=le(n,"onKeep",19,(()=>{}));var x=ja(),g=r(x),y=r(g),M=r(y);Mn(M,{});var ie=u(y,2),w=r(ie),ee=k=>{var U=H(),Z=m(U);Ze(Z,(()=>n.text)),t(k,U)},de=k=>{Ne(k,{size:1,color:"neutral",truncate:!0,children:(U,Z)=>{var E=X();Re((L=>Be(E,`${L??""} changed`)),[()=>kn(n.filesCount,"file")]),t(U,E)},$$slots:{default:!0}})};p(w,(k=>{n.text?k(ee):k(de,!1)}));var G=u(ie,2),ge=k=>{var U=Ha(),Z=r(U);ia(Z,{size:0,get totalAddedLines(){return n.diffSummary.totalAddedLines},get totalRemovedLines(){return n.diffSummary.totalRemovedLines}}),t(k,U)};p(G,(k=>{n.hasChanges&&k(ge)}));var Ae=u(g,2),xe=k=>{var U=qa(),Z=r(U),E=C=>{dt(C,{class:"c-agent-edits-header__revert-btn",variant:"soft",color:"neutral",size:.5,get onclick(){return a()},children:(F,z)=>{{let V=o((()=>[pt.Hover]));ot(F,{get triggerOn(){return e(V)},content:"Discard all changes",children:(D,j)=>{var q=Oa(),S=m(q);ye(S,{name:"undo-2"}),t(D,q)},$$slots:{default:!0}})}},$$slots:{default:!0}})};p(Z,(C=>{a()&&C(E)}));var L=u(Z,2),oe=C=>{dt(C,{class:"c-agent-edits-header__accept-btn",variant:"soft",color:"success",size:.5,get onclick(){return f()},children:(F,z)=>{{let V=o((()=>[pt.Hover]));ot(F,{get triggerOn(){return e(V)},content:"Keep all changes and clear checkpoints",children:(D,j)=>{var q=Ga(),S=m(q);ye(S,{name:"check-check"}),t(D,q)},$$slots:{default:!0}})}},$$slots:{default:!0}})};p(L,(C=>{f()&&C(oe)}));var I=u(L,2);Ze(I,(()=>n.actions??zt)),t(k,U)};p(Ae,(k=>{(n.collapsed&&n.hasChanges&&(a()||f())||n.actions)&&k(xe)})),t(De,x),ct()}var Va=d('<div class="c-agent-edits-header__buttons__text--long svelte-1vu2yno">See full diff</div> <div class="c-agent-edits-header__buttons__text--short svelte-1vu2yno"><!></div>',1),Ka=d('<div class="c-agent-edits-header__actions svelte-1vu2yno"><div class="c-agent-edits-header__actions__count"> </div> <div class="c-agent-edits-header__buttons svelte-1vu2yno"><!></div></div>'),Ja=d('<div class="c-edit"><!></div>'),Xa=d("<span>Show less</span>"),Qa=d("<span> </span>"),Za=d('<div class="c-show-more-container svelte-1vu2yno"><!></div>'),Ya=d('<div class="c-edits-list svelte-1vu2yno"><div class="c-edits-section svelte-1vu2yno"><!> <!></div></div>'),er=d('<div class="c-agent-edits-container svelte-1vu2yno"><!></div>'),tr=d('<div class="c-edits-list c-edits-list--empty svelte-1vu2yno"><!></div>');function nr(De,n){it(n,!0);let a=le(n,"changedFiles",19,(()=>[])),f=le(n,"collapsed",7,!1),x=le(n,"focusedFilePath",3,null),g=le(n,"emptyMessage",3,"No changes to show");const y=Ht();let M=se(!1);function ie(){s(M,!e(M))}let w=[],ee=o((()=>{const E=a().map((L=>{const oe=gn.generateDiff(L.old_path,L.new_path,L.old_contents||"",L.new_contents||""),I=gn.getDiffObjectStats(oe),C={totalAddedLines:I.additions,totalRemovedLines:I.deletions};return{file:L,qualifiedPathName:{rootPath:"",relPath:L.new_path||L.old_path},changesSummary:C}})).filter((L=>L.changesSummary.totalAddedLines>0||L.changesSummary.totalRemovedLines>0));return mn(E,w)?w:(w=E,E)})),de={totalAddedLines:0,totalRemovedLines:0},G=o((()=>{const E=e(ee).reduce(((L,oe)=>(L.totalAddedLines+=oe.changesSummary.totalAddedLines,L.totalRemovedLines+=oe.changesSummary.totalRemovedLines,L)),{totalAddedLines:0,totalRemovedLines:0});return mn(E,de)?de:(de=E,E)})),ge=o((()=>e(ee).length>3)),Ae=o((()=>a().length>Aa));var xe=H(),k=m(xe),U=E=>{var L=er(),oe=r(L);Nn(oe,{class:"c-agent-edits-container__block-container",get collapsed(){return f()},set collapsed(C){f(C)},header:C=>{Wa(C,{get filesCount(){return e(ee).length},get diffSummary(){return e(G)},get collapsed(){return f()},hasChanges:!0,text:z=>{var V=Ka(),D=r(V),j=r(D),q=u(D,2),S=r(q);{let R=o((()=>e(Ae)?Sa:void 0));ot(S,{get content(){return e(R)},children:(K,J)=>{{let ue=o((()=>n.onOpenDiffView||ka));dt(K,{get onclick(){return e(ue)},color:"neutral",size:.5,variant:"soft",get disabled(){return e(Ae)},children:(me,P)=>{var ne=Va(),fe=u(m(ne),2),te=r(fe);ye(te,{name:"file-diff",size:1}),t(me,ne)},$$slots:{default:!0}})}},$$slots:{default:!0}})}Re((R=>Be(j,`${R??""} changed`)),[()=>kn(e(ee).length,"file")]),t(z,V)},$$slots:{text:!0}})},children:(C,F)=>{var z=Ya(),V=r(z),D=r(V);Pt(D,17,(()=>e(M)?e(ee):e(ee).slice(0,3)),(S=>S.qualifiedPathName),((S,R)=>{const K=o((()=>x()===e(R).file.new_path||x()===e(R).file.old_path));var J=Ja(),ue=r(J);{const me=te=>{var N=H(),b=m(N),v=c=>{ot(c,{content:"Toggle collapse unchanged regions",children:(h,i)=>{kt(h,{onclick:$=>{$.stopPropagation(),y.toggleCollapseUnchangedRegions()},color:"neutral",size:.5,variant:"ghost-block",children:($,B)=>{ye($,{name:"layers-2",size:1})},$$slots:{default:!0}})},$$slots:{default:!0}})};p(b,(c=>{e(K)&&c(v)})),t(te,N)};let P=o((()=>n.onFileClick?()=>n.onFileClick(e(R).file.new_path||e(R).file.old_path):void 0)),ne=o((()=>n.onReviewClick?()=>n.onReviewClick(e(R).file):void 0)),fe=o((()=>n.onRevertClick?()=>n.onRevertClick(e(R).file):void 0));On(ue,{get qualifiedPathName(){return e(R).qualifiedPathName},get lineChanges(){return e(R).changesSummary},get isFocused(){return e(K)},get onClickFile(){return e(P)},get onClickReview(){return e(ne)},get onClickRevert(){return e(fe)},actions:me,$$slots:{actions:!0}})}Ft(3,J,(()=>oa)),t(S,J)}));var j=u(D,2),q=S=>{var R=Za(),K=r(R);dt(K,{onclick:ie,color:"neutral",size:1,variant:"soft",iconRight:ue=>{var me=H(),P=m(me),ne=te=>{ye(te,{name:"chevron-up"})},fe=te=>{ye(te,{name:"chevron-down"})};p(P,(te=>{e(M)?te(ne):te(fe,!1)})),t(ue,me)},children:(ue,me)=>{var P=H(),ne=m(P),fe=N=>{var b=Xa();t(N,b)},te=N=>{const b=o((()=>e(ee).length-3));var v=Qa(),c=r(v);Re((h=>Be(c,`Show ${e(b)??""} more ${h??""}`)),[()=>la(e(b),"file")]),t(N,v)};p(ne,(N=>{e(M)?N(fe):N(te,!1)})),t(ue,P)},$$slots:{iconRight:!0,default:!0}}),t(S,R)};p(j,(S=>{e(ge)&&S(q)})),t(C,z)},$$slots:{header:!0,default:!0}}),t(E,L)},Z=E=>{var L=tr(),oe=r(L);Ne(oe,{size:1,color:"neutral",children:(I,C)=>{var F=X();Re((()=>Be(F,g()))),t(I,F)},$$slots:{default:!0}}),t(E,L)};p(k,(E=>{e(ee).length>0?E(U):E(Z,!1)})),t(De,xe),ct()}var ar=d('<div class="c-agent-footer__button svelte-59regt"><!></div>'),rr=d('<div class="c-agent-footer__button svelte-59regt"><!></div>'),sr=d('<div class="c-agent-footer__buttons svelte-59regt"><!> <!></div>'),or=d('<div class="c-agent-footer svelte-59regt"><div class="c-agent-footer__status svelte-59regt"><!></div> <!></div>'),ir=d(`Augment needs to modify your SSH configuration at <code>~/.ssh/config</code> to connect to the
        remote workspace. This will:`,1),cr=d('<div class="c-ssh-permission-modal__body svelte-59regt"><!> <!> <!> <!> <!></div>'),lr=d('<div class="c-ssh-permission-modal__footer svelte-59regt"><!> <!></div>'),dr=d("<!> <!>",1);function ur(De,n){it(n,!0);const a=()=>Ge(g,"$remoteAgentsModel",f),[f,x]=mt(),g=ut(wt.key),y=ut(Gn),M=ut(Ut.key),ie=_t(""),w=xa(ie);let ee=se(!0),de=se(!1);It((async()=>{s(ee,await g.getShouldShowSSHConfigPermissionPrompt(),!0);try{const{remoteUrl:P,error:ne}=await M.getRemoteUrl();if(ne)throw new Error(ne);ie.set(P)}catch(P){console.error("Failed to get current repository URL:",P)}}));let G=se(!1),ge=se(0),Ae=o((()=>e(ge)>660)),xe=o((()=>a()?.currentAgent)),k=o((()=>e(xe)?.remote_agent_id)),U=o((()=>a()?.isCurrentAgentDetailsLoading));function Z(){e(ee)?s(de,!0):E()}function E(){e(k)&&(s(I,!0),(async function(P){if(!P)return;const ne=g.agentOverviews.find((fe=>fe.remote_agent_id===P));ne&&await g.sshToRemoteAgent(ne)})(e(k)).then((()=>{s(I,!1)})))}async function L(){s(de,!1);try{await g.setPermissionToWriteToSSHConfig(!0)}catch(P){console.error("Failed to set SSH permission:",P)}E()}function oe(){s(de,!1)}let I=se(!1),C=o((()=>Ca(a().currentConversation?.exchanges??[]))),F=o((()=>a().focusedFilePath)),z=o((()=>a().isRemoteAgentSshWindow));const V=Xt();let D=o((()=>e(z)?P=>{V(Ln({repoRoot:"",pathName:P}))}:void 0));async function j(P){const ne=P.new_path||P.old_path;a().openDiffInBuffer(P.old_contents||"",P.new_contents||"",ne)}const q=Qt(),S=Cn(q);function R(){a().currentAgent?.remote_agent_id?(g.reportRemoteAgentEvent({eventName:xn.createdPR,remoteAgentId:a().currentAgent.remote_agent_id,eventData:{createdPRData:{}}}),s(G,!0),a().sendMessage("Please create a pull request with the changes you've made.",Ge(S,"$selectedModelId",f)??void 0).then((()=>{s(G,!1)})).catch((P=>{console.error("Error sending PR creation request:",P),s(G,!1)}))):console.error("No current agent ID found")}var K=dr(),J=m(K),ue=P=>{var ne=or(),fe=r(ne),te=r(fe),N=c=>{{let h=o((()=>!e(Ae))),i=o((()=>e(U)?"Loading...":"No changes to show"));nr(c,{get changedFiles(){return e(C)},get collapsed(){return e(h)},get focusedFilePath(){return e(F)},get emptyMessage(){return e(i)},onReviewClick:j,onOpenDiffView:()=>{y.set(-1),a().showRemoteAgentDiffPanel({turnIdx:-1,changedFiles:e(C),userPrompt:"",sessionSummary:"",isShowingAggregateChanges:!0,isAgentFromDifferentRepo:Ge(w,"$isAgentFromDifferentRepo",f)(e(xe))})},get onFileClick(){return e(D)}})}};p(te,(c=>{e(C).length>0&&c(N)}));var b=u(fe,2),v=c=>{var h=sr(),i=r(h),$=l=>{var _=ar(),Q=r(_);{let ae=o((()=>[pt.Hover]));ot(Q,{get triggerOn(){return e(ae)},content:"Create a GitHub pull request with the changes",children:($e,_e)=>{{const we=Ee=>{ye(Ee,{name:"git-pull-request"})};let Pe=o((()=>[gt.agentUnspecified,gt.agentPending,gt.agentStarting].includes(e(xe)?.status)));dt($e,{size:2,variant:"soft",color:"neutral",onclick:R,class:"c-agent-footer__open-btn",get disabled(){return e(Pe)},iconRight:we,children:(Ee,Se)=>{var ve=H(),ke=m(ve),A=ce=>{var Ce=X("Creating a PR...");t(ce,Ce)},O=ce=>{var Ce=X("Create a PR");t(ce,Ce)};p(ke,(ce=>{e(G)?ce(A):ce(O,!1)})),t(Ee,ve)},$$slots:{iconRight:!0,default:!0}})}},$$slots:{default:!0}})}t(l,_)};p(i,(l=>{e(C).length>0&&l($)}));var B=u(i,2),W=l=>{var _=rr(),Q=r(_);{let ae=o((()=>[pt.Hover]));ot(Q,{get triggerOn(){return e(ae)},content:"SSH into the remote agent's workspace in a new VSCode window",children:($e,_e)=>{{const we=Ee=>{var Se=H(),ve=m(Se),ke=O=>{Ct(O,{size:1,useCurrentColor:!0})},A=O=>{ye(O,{name:"external-link"})};p(ve,(O=>{e(I)?O(ke):O(A,!1)})),t(Ee,Se)};let Pe=o((()=>[gt.agentUnspecified,gt.agentPending,gt.agentStarting].includes(e(xe)?.status)||e(I)));dt($e,{size:2,variant:"soft",color:"accent",onclick:Z,class:"c-agent-footer__open-btn",get disabled(){return e(Pe)},iconRight:we,children:(Ee,Se)=>{var ve=H(),ke=m(ve),A=ce=>{var Ce=X("Connecting...");t(ce,Ce)},O=ce=>{var Ce=X("Open remote workspace");t(ce,Ce)};p(ke,(ce=>{e(I)?ce(A):ce(O,!1)})),t(Ee,ve)},$$slots:{iconRight:!0,default:!0}})}},$$slots:{default:!0}})}t(l,_)};p(B,(l=>{e(z)||l(W)})),t(c,h)};p(b,(c=>{e(k)&&!e(z)&&c(v)})),t(P,ne)};p(J,(P=>{e(xe)&&P(ue)}));var me=u(J,2);La(me,{get show(){return e(de)},title:"SSH Configuration Permission",oncancel:oe,body:fe=>{var te=cr(),N=r(te);Ne(N,{size:1,children:(i,$)=>{var B=ir();t(i,B)},$$slots:{default:!0}});var b=u(N,2);Ne(b,{size:1,children:(i,$)=>{var B=X("• Create or update SSH configuration files");t(i,B)},$$slots:{default:!0}});var v=u(b,2);Ne(v,{size:1,children:(i,$)=>{var B=X("• Add connection settings for the remote agent");t(i,B)},$$slots:{default:!0}});var c=u(v,2);Ne(c,{size:1,children:(i,$)=>{var B=X("• Enable secure access to your remote workspace");t(i,B)},$$slots:{default:!0}});var h=u(c,2);Ne(h,{size:1,children:(i,$)=>{var B=X("• Your existing SSH configuration will be preserved.");t(i,B)},$$slots:{default:!0}}),t(fe,te)},footer:fe=>{var te=lr(),N=r(te);dt(N,{variant:"solid",color:"neutral",onclick:oe,children:(v,c)=>{var h=X("Cancel");t(v,h)},$$slots:{default:!0}});var b=u(N,2);dt(b,{variant:"solid",color:"accent",onclick:L,children:(v,c)=>{var h=X("Allow & Connect");t(v,h)},$$slots:{default:!0}}),t(fe,te)},$$slots:{body:!0,footer:!0}}),(function(P,ne){Pn(window,["resize"],(()=>Bn((()=>ne(window[P])))))})("innerHeight",(P=>s(ge,P,!0))),t(De,K),ct(),x()}var vr=d("<span>Add context <!></span>"),hr=d('<div class="c-chat-input__context-bar svelte-18c6ign"><!></div>'),pr=d('<span class="character-counter svelte-18c6ign"> </span>'),gr=d("<!> <!>",1),mr=d("<!> <div><!></div>",1),fr=d("<span>Cancel <!></span>"),_r=d("<!> <!> <!> <!> <!>",1),$r=d("<div><!></div>"),wr=d("<!> <!>",1),br=d("<!> <!> <!> <!> <!> <!> <!> <!>",1),yr=d('<div class="c-chat-input svelte-18c6ign" data-testid="design-system-chat-input"><!></div>');function yn(De,n){it(n,!0);const a=()=>Ge(G,"$remoteAgentsModel",M),f=()=>Ge(U,"$draft",M),x=()=>Ge(xe,"$enableChatInputInlineCompletion",M),g=()=>Ge(E,"$selectedModelId",M),y=()=>Ge(Ae,"$enableChatMultimodal",M),[M,ie]=mt(),w=Xt(),ee=Ht(),de=da(),G=ut(wt.key);if(!G||!a())throw new Error("Remote model is not available");const ge=ut(Ut.key),Ae=dn("enableChatMultimodal"),xe=dn("enableChatInputInlineCompletion"),k=Qt(),U=ua(),Z=o((()=>f()?.exchange)),E=va(),L=ge?.currentRepositoryUrl,oe=T=>{ee.showNotification({message:T,type:"error"})},I=o((()=>Qn(a())));let C=le(n,"editable",3,!0),F=le(n,"placeholder",3,"Ask or instruct Augment"),z=le(n,"hasSendButton",3,!0),V=le(n,"richTextEditorRoot",15),D=se(void 0),j=se(!1);const q=o((()=>!a()?.currentAgentId)),S=Bt((async()=>{if(!e(j)&&e(q))try{await G.reportRemoteAgentSetupWindowEvent(At.typeInPromptWindow),s(j,!0)}catch(T){console.error("Failed to report type in prompt window event:",T)}}),1500),R=o((()=>new Zn(de.store,ee)));let K=se(void 0);const J=Bt((async()=>{const T=V()?.getEditor?.();if(!T)return;const Y=$n(T.state,`
`,qt),re=Pa(T.state,`
`,qt),Fe=Y.prefix,Te=re.suffix;if(!Fe||Fe.length<3)return;const Oe=await e(R).getCompletion(Fe,Te),he=$n(T.state,`
`,qt);Y.prefix===he.prefix&&Oe&&e(K)?.showCompletion(Oe,Fe)}),200),ue={type:"doc",content:[{type:"paragraph"}]};function me(T){w(ma({draftStatus:hn.ready,exchange:{...e(Z)||{},request_message:T.rawText,rich_text_json_repr:T.richTextJsonRepr||ue,status:Fa.draft}})),x()&&e(K)&&(e(K)?.hasActiveCompletion?.()||(J.cancel(),J())),T.rawText&&T.rawText.trim().length>0&&S()}function P(T){w(fa(T.current))}let ne;$t((()=>{const T=a()?.currentAgent?.status;ne!==gt.agentStarting||T!==gt.agentRunning&&T!==gt.agentIdle||En().then((()=>ae())),ne=T}));const fe=o((()=>a()?na(w,g(),e(Z),y(),a(),ge,V()):{isDisabled:!0,disabledReason:"No remote agent model available",showCancelButton:!1,action:()=>!1,cancelAction:()=>{}})),te=o((()=>e(fe).showCancelButton)),N=o((()=>e(Z)?.request_message?.length||0)),b=o((()=>e(fe).isDisabled)),v=o((()=>e(fe).disabledReason)),c=o((()=>{return T=e(fe).action,()=>{const Y=T();return Y&&w(wa()),Y};var T})),h=o((()=>e(fe).cancelAction)),i=o((()=>`remote-${a()?.isActive}`)),$=()=>{V()?.isFocused===void 0||ht(V().isFocused())||Yn()||V().requestFocus()},B=async()=>!e(b)&&(w(yt(Rt.WEBVIEW.SEND_ACTION_TRIGGERED,{source:"keybinding"})),e(c)()),W=T=>{w(yt(Rt.WEBVIEW.CANCEL_ACTION_TRIGGERED,{source:T}))},l=async()=>e(te)?(W("keybinding"),e(h)()):$e();let _=se(void 0);const Q=()=>V()?.requestFocus(),ae=()=>V()?.forceFocus?.(),$e=()=>(V()?.blur(),!0);let _e=F();const we=o((()=>ea(a(),Ge(L,"$currentRepoUrl",M),e(b)))),Pe=o((()=>a()&&a().generateSetupScriptSelected)),Ee=crypto.randomUUID();function Se(){w(_a(Ee))}function ve(T,Y){for(const re of T)w(yt(Rt.SHARED.FILE_ATTACHMENT_SUCCEEDED,{bytes:re.size,type:re.type?re.type:"unknown"}));for(const re of Y)w(yt(Rt.SHARED.FILE_ATTACHMENT_FAILED,{bytes:re.files[0].size,type:re.files[0].type?re.files[0].type:"unknown"}));w(yt(Rt.SHARED.FILE_ATTACHMENT_BUNDLE_COMPLETED,{successes:T.length,failures:Y.length}))}function ke(){w(yt(Rt.SHARED.FILE_ATTACHMENT_STARTED,{source:"drop"}))}function A(){w(yt(Rt.SHARED.FILE_ATTACHMENT_STARTED,{source:"button"}))}function O(T){w(yt(Rt.WEBVIEW.CONTEXT_MENU_BUTTON_CLICKED,{source:T}))}var ce=yr();en("blur",tn,(()=>w(un()))),en("beforeunload",tn,(()=>w(un())));var Ce=r(ce);ha(Ce,{scope:"chat-input",children:(T,Y)=>{var re=H(),Fe=m(re);Sn(Fe,(()=>e(i)),(Te=>{var Oe=H(),he=m(Oe);{const be=st=>{var qe=H(),Ke=m(qe);Ze(Ke,(()=>n.banner??zt)),t(st,qe)},je=st=>{var qe=H(),Ke=m(qe),We=Ye=>{var Je=hr(),pe=r(Je);Kn(pe,{prepend:Ue=>{var Xe=H(),Qe=m(Xe),tt=ze=>{var nt=H(),lt=m(nt);{const ft=Ve=>{var et=vr(),vt=u(r(et));ln(vt,{commandName:"openContextMenu",keysOnly:!0}),t(Ve,et)};let Me=o((()=>e(_)?.insertMentionNode));Ie(lt,(()=>xt.ContextMenu),((Ve,et)=>{et(Ve,{onCloseDropdown:Q,get onInsertMentionable(){return e(Me)},trackButtonClick:O,tooltipContent:ft,$$slots:{tooltipContent:!0}})}))}t(ze,nt)};p(Qe,(ze=>{e(I).doHideAtMentions||ze(tt)})),t(Ue,Xe)},$$slots:{prepend:!0}}),t(Ye,Je)};p(Ke,(Ye=>{e(I).doHideContextBar||Ye(We)})),t(st,qe)},rt=st=>{var qe=$r(),Ke=r(qe);{const We=Je=>{var pe=gr(),Le=m(pe),Ue=Qe=>{var tt=pr(),ze=r(tt);Re((()=>Be(ze,`${e(N)??""}/${vn}`))),t(Qe,tt)};p(Le,(Qe=>{e(N)>vn&&Qe(Ue)}));var Xe=u(Le,2);Jn(Xe,{get selectedModelId(){return g()},onModelChange:Qe=>{Ge(k,"$currentConversationId",M)&&w(ga(Qe||void 0))}}),t(Je,pe)},Ye=Je=>{var pe=_r(),Le=m(pe),Ue=Me=>{var Ve=H(),et=m(Ve);{let vt=o($a);Ie(et,(()=>xt.AddFileButton),((at,bt)=>{bt(at,{get accept(){return e(vt)},onclick:A})}))}t(Me,Ve)};p(Le,(Me=>{y()&&!e(I).doHideMultimodalActions&&Me(Ue)}));var Xe=u(Le,2),Qe=Me=>{var Ve=mr(),et=m(Ve);Xn(et,{get draft(){return f()},forceEditorFocus:ae,get editorContainer(){return e(D)}});var vt=u(et,2),at=r(vt);{let bt=o((()=>f()?.draftStatus===hn.enhancing));Ie(at,(()=>xt.RewritePromptButton),((Gt,Dn)=>{Dn(Gt,{onRewrite:Se,get isDisabled(){return e(we).isDisabled},get disabledReason(){return e(we).disabledReason},get isEnhancing(){return e(bt)}})}))}Ft(3,vt,(()=>Tn),(()=>({axis:"x",duration:200,scale:.4}))),t(Me,Ve)};p(Xe,(Me=>{e(te)||e(we).isHidden||Me(Qe)}));var tt=u(Xe,2);Da(tt,{color:"premium",size:1,variant:"soft",children:(Me,Ve)=>{var et=X("Beta");t(Me,et)},$$slots:{default:!0}});var ze=u(tt,2);{let Me=o((()=>!e(te)));Wt(ze,{get isDisabled(){return e(Me)},name:"cancelGeneration",debounce:!0,handler:l})}var nt=u(ze,2),lt=Me=>{var Ve=H(),et=m(Ve);{const vt=at=>{var bt=fr(),Gt=u(r(bt));ln(Gt,{commandName:"cancelGeneration",keysOnly:!0}),t(at,bt)};Ie(et,(()=>xt.CancelButton),((at,bt)=>{bt(at,{get cancelAction(){return e(h)},onAnalyticsTrack:W,tooltipContent:vt,$$slots:{tooltipContent:!0}})}))}t(Me,Ve)},ft=Me=>{var Ve=H(),et=m(Ve),vt=at=>{ta(at,{get isDisabled(){return e(b)},get disabledReason(){return e(v)},get sendAction(){return e(c)}})};p(et,(at=>{z()&&at(vt)}),!0),t(Me,Ve)};p(nt,(Me=>{e(te)?Me(lt):Me(ft,!1)})),t(Je,pe)};Ie(Ke,(()=>xt.Root),((Je,pe)=>{pe(Je,{leftAlign:We,rightAlign:Ye,$$slots:{leftAlign:!0,rightAlign:!0}})}))}t(st,qe)};Ie(he,(()=>wn.Root),((st,qe)=>{St(qe(st,{get editable(){return C()},variant:"default",get showActionButton(){return e(Pe)},get activeButton(){return n.activeButton},onFocus:()=>{ee.setChatContextVariables({chatInputFocused:!0})},onBlur:()=>{ee.setChatContextVariables({chatInputFocused:!1})},banner:be,header:je,footer:rt,children:(Ke,We)=>{var Ye=br(),Je=m(Ye);Wt(Je,{name:"focusChatInput",handler:$});var pe=u(Je,2);Wt(pe,{name:"sendChatAction",debounce:!0,handler:B});var Le=u(pe,2);qn(Le,{});var Ue=u(Le,2),Xe=Me=>{St(Ea(Me,{requestEditorFocus:Q,onMentionItemsUpdated:P}),(Ve=>s(_,Ve,!0)),(()=>e(_)))};p(Ue,(Me=>{e(I).doHideAtMentions||Me(Xe)}));var Qe=u(Ue,2),tt=Me=>{St(jn(Me,{onBeforeCompletionAccepted:(Ve,et)=>e(R).handleInlineCompletionAccepted(Ve,et,e(_)),onCompletionAccepted:()=>e(R).reportCompletionAccepted(),onCompletionRejected:()=>e(R).reportCompletionRejected()}),(Ve=>s(K,Ve,!0)),(()=>e(K)))};p(Qe,(Me=>{x()&&Me(tt)}));var ze=u(Qe,2);Ba(ze,{get placeholder(){return _e}});var nt=u(ze,2);{let Me=o((()=>e(Z)?.rich_text_json_repr||ue));Ie(nt,(()=>wn.Content),((Ve,et)=>{et(Ve,{get content(){return e(Me)},onContentChanged:me})}))}var lt=u(nt,2),ft=Me=>{var Ve=wr(),et=m(Ve);Wn(et,{saveImage:(...at)=>ee.saveImage(...at),saveAttachment:(...at)=>ee.saveAttachment(...at),deleteImage:(...at)=>ee.deleteImage(...at),renderImage:(...at)=>ee.loadImage(...at),get maxImages(){return pa},supportedFileTypes:["image","text"],onValidationError:oe,onCompletedAttachment:ve});var vt=u(et,2);Vn(vt,{onDrop:ke}),t(Me,Ve)};p(lt,(Me=>{y()&&!e(I).doHideMultimodalActions&&Me(ft)})),t(Ke,Ye)},$$slots:{banner:!0,header:!0,footer:!0,default:!0}}),(Ke=>V(Ke)),(()=>V()))}))}t(Te,Oe)})),t(T,re)},$$slots:{default:!0}}),St(ce,(T=>s(D,T)),(()=>e(D))),t(De,ce),ct(),ie()}var Rr=d('<span class="view-icon svelte-1pxjepz"><!></span>'),Ar=d('<div class="version-navigation svelte-1pxjepz"><!> <!> <!></div>'),Sr=d('<div class="header-content__actions"><!></div>'),kr=d('<div class="dropdown-item-content svelte-1pxjepz"><!> <!></div>'),Cr=d('<div class="dropdown-item-content svelte-1pxjepz"><!> <!></div>'),Lr=d("<!> <!>",1),xr=d("<!> <!>",1),Ir=d('<div class="error-message svelte-1pxjepz"><!></div>'),Dr=d('<div class="setup-script-save-bar svelte-1pxjepz"><div class="header-content svelte-1pxjepz"><div class="header-content__title svelte-1pxjepz"><!> <!></div> <div class="header-content__title svelte-1pxjepz"><!> <!></div></div> <div class="save-bar-content svelte-1pxjepz"><!> <!> <!> <!> <div class="input-group location-buttons svelte-1pxjepz"><!></div> <!></div></div>');function Pr(De,n){it(n,!0);const a=()=>Ge(g,"$remoteAgentsModel",f),[f,x]=mt(),g=ut(wt.key);let y=se("setup.sh"),M=se("home"),ie=se(!1),w=se(""),ee=se(0),de=o((()=>(function(C){return!C||!Array.isArray(C)?[]:C.flatMap((F=>(F.exchange.response_nodes||[]).filter((z=>z.type===za.TOOL_USE&&z.tool_use?.tool_name==="setup-script"&&z.tool_use?.input_json)).map((z=>{try{const V=typeof z.tool_use.input_json=="string"?JSON.parse(z.tool_use.input_json):z.tool_use.input_json,D=a().getToolUseState(z.tool_use.tool_use_id),j=F.exchange?.request_id||F.request_id||"";return j||console.warn("SetupScriptSaveBar: Missing request_id for an exchange",F),{content:V.script_content||"",timestamp:z.timestamp,status:D.phase,requestId:j,id:z.tool_use.tool_use_id}}catch(V){return console.error("Failed to parse setup script JSON:",V),null}})))).filter((F=>F!==null&&F.content!==""))})(a().currentConversation?.exchanges||[]))),G=o((()=>e(de).length));$t((()=>{e(G)&&s(ee,e(G)-1)}));let ge=o((()=>e(de)[e(ee)]));const Ae=Qt(),xe=ba(Ae),k=Cn(Ae),U=Ht();function Z(C=1){s(ee,Math.max(0,Math.min(e(de).length-1,e(ee)+C)),!0);const F=e(de)[e(ee)];F?.id&&ya(F.id)}async function E(C){if(e(y)&&C)if(e(ge)?.content)try{s(ie,!0),s(w,"");const F=e(y).endsWith(".sh")?e(y):`${e(y)}.sh`,z=await g.saveSetupScript(F,e(ge).content,C);let V;if(!z.success||!z.path)return void s(w,z.error||"Failed to save setup script",!0);if(V=(await g.listSetupScripts()).find((R=>R.path===z.path)),!V)return void s(w,"Failed to save script");const D=a()?.currentAgent,j=D?.workspace_setup?.starting_files?.github_commit_ref?.git_ref,q=D?.workspace_setup?.starting_files?.github_commit_ref?.repository_url;await g.saveLastRemoteAgentSetup(q||null,j||null,z.path),Hn||g.setCurrentAgent(void 0);const S=Ge(xe,"$draftExchange",f)?.exchange.request_message;if(S&&S.trim())try{if(D?.workspace_setup?.starting_files?.github_commit_ref&&j&&q){const R=D.workspace_setup.starting_files,K={commitRef:R,selectedBranch:{name:j,commit:{sha:"",url:""},protected:!1},setupScript:V,isDisabled:!1,enableNotification:!0,isSetupScriptAgent:!1};g.setNewAgentDraft(K);const J=await g.createRemoteAgentFromDraft(S,Ge(k,"$selectedModelId",f)??void 0);J?await g.setCurrentAgent(J):s(w,"Script saved successfully, but failed to create remote agent")}else s(w,"Script saved successfully, but no workspace information available to create remote agent")}catch(R){console.error("Failed to create remote agent:",R),s(w,"Script saved successfully, but failed to create remote agent")}else g.setCurrentAgent(void 0)}catch(F){s(w,F instanceof Error?F.message:"Unknown error occurred",!0)}finally{s(ie,!1)}else s(w,"No script content to save");else s(w,"Please provide both script name and location")}var L=H(),oe=m(L),I=C=>{var F=Dr(),z=r(F),V=r(z),D=r(V);Ne(D,{size:1,weight:"medium",children:(h,i)=>{var $=X("Setup script");t(h,$)},$$slots:{default:!0}});var j=u(D,2);ot(j,{content:"View full script in editor",side:"bottom",children:(h,i)=>{dt(h,{variant:"ghost-block",color:"neutral",size:1,onclick:()=>{U.openScratchFile(e(ge)?.content,"shellscript")},iconLeft:B=>{var W=Rr(),l=r(W);ye(l,{name:"external-link"}),t(B,W)},children:(B,W)=>{var l=X("View");t(B,l)},$$slots:{iconLeft:!0,default:!0}})},$$slots:{default:!0}});var q=u(V,2),S=r(q),R=h=>{var i=Ar(),$=r(i);{let l=o((()=>e(ee)===0?"":"Switch to previous script")),_=o((()=>[pt.Hover]));ot($,{get content(){return e(l)},get triggerOn(){return e(_)},children:(Q,ae)=>{{let $e=o((()=>e(ee)===0));kt(Q,{variant:"ghost-block",size:1,onclick:()=>Z(-1),get disabled(){return e($e)},title:"Previous version",children:(_e,we)=>{ye(_e,{name:"chevron-left"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}var B=u($,2);Ne(B,{size:1,color:"secondary",class:"header-content__version-count",children:(l,_)=>{var Q=X();Re((()=>Be(Q,`${e(ee)+1} of ${e(de).length??""}`))),t(l,Q)},$$slots:{default:!0}});var W=u(B,2);{let l=o((()=>e(ee)===e(de).length-1?"":"Switch to next script")),_=o((()=>[pt.Hover]));ot(W,{get content(){return e(l)},get triggerOn(){return e(_)},children:(Q,ae)=>{{let $e=o((()=>e(ee)===e(de).length-1));kt(Q,{variant:"ghost-block",size:1,onclick:()=>Z(1),get disabled(){return e($e)},title:"Next version",children:(_e,we)=>{ye(_e,{name:"chevron-right"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}t(h,i)},K=h=>{Ne(h,{size:1,color:"secondary",class:"header-content__version-count",children:(i,$)=>{var B=X("No versions");t(i,B)},$$slots:{default:!0}})};p(S,(h=>{e(de).length>0?h(R):h(K,!1)}));var J=u(S,2),ue=h=>{var i=Sr(),$=r(i);{let B=o((()=>e(ge).status===pn.completed?"success":e(ge).status===pn.error?"error":"loading"));ca($,{get commandResult(){return e(B)}})}t(h,i)};p(J,(h=>{e(ge)?.status&&h(ue)}));var me=u(z,2),P=r(me);Ne(P,{size:1,weight:"medium",children:(h,i)=>{var $=X("File Name");t(h,$)},$$slots:{default:!0}});var ne=u(P,2);Vt(ne,{onblur:()=>{e(y)?e(y).endsWith(".sh")||s(y,e(y)+".sh"):s(y,"setup.sh")},placeholder:"Script name",size:1,get value(){return e(y)},set value(h){s(y,h,!0)}});var fe=u(ne,2);Ne(fe,{size:1,weight:"medium",children:(h,i)=>{var $=X("Path");t(h,$)},$$slots:{default:!0}});var te=u(fe,2);Ie(te,(()=>He.Root),((h,i)=>{i(h,{children:($,B)=>{var W=xr(),l=m(W);Ie(l,(()=>He.Trigger),((Q,ae)=>{ae(Q,{children:($e,_e)=>{{let we=o((()=>e(M)==="home"?"~/.augment/env/":".augment/env"));Vt($e,{get value(){return e(we)},placeholder:"Script name",size:1,children:(Pe,Ee)=>{ye(Pe,{name:"chevron-down"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}));var _=u(l,2);Ie(_,(()=>He.Content),((Q,ae)=>{ae(Q,{size:1,children:($e,_e)=>{var we=Lr(),Pe=m(we);Ie(Pe,(()=>He.Item),((Se,ve)=>{ve(Se,{onSelect:()=>s(M,"home"),children:(ke,A)=>{{let O=o((()=>[pt.Hover]));ot(ke,{content:"Save the setup script in your machine's home directory",get triggerOn(){return e(O)},children:(ce,Ce)=>{var T=kr(),Y=r(T);Ne(Y,{size:1,weight:"medium",children:(Fe,Te)=>{var Oe=X("~/.augment/env/");t(Fe,Oe)},$$slots:{default:!0}});var re=u(Y,2);Ie(re,(()=>_n.Root),((Fe,Te)=>{Te(Fe,{variant:"soft",color:"info",size:1,children:(Oe,he)=>{var be=X("Local");t(Oe,be)},$$slots:{default:!0}})})),t(ce,T)},$$slots:{default:!0}})}},$$slots:{default:!0}})}));var Ee=u(Pe,2);Ie(Ee,(()=>He.Item),((Se,ve)=>{ve(Se,{onSelect:()=>s(M,"git"),children:(ke,A)=>{{let O=o((()=>[pt.Hover]));ot(ke,{content:"Save the setup script in the Git repository, for your team to use when you push your changes",get triggerOn(){return e(O)},children:(ce,Ce)=>{var T=Cr(),Y=r(T);Ne(Y,{size:1,weight:"medium",children:(Fe,Te)=>{var Oe=X(".augment/env");t(Fe,Oe)},$$slots:{default:!0}});var re=u(Y,2);Ie(re,(()=>_n.Root),((Fe,Te)=>{Te(Fe,{variant:"soft",color:"info",size:1,children:(Oe,he)=>{var be=X("Repo");t(Oe,be)},$$slots:{default:!0}})})),t(ce,T)},$$slots:{default:!0}})}},$$slots:{default:!0}})})),t($e,we)},$$slots:{default:!0}})})),t($,W)},$$slots:{default:!0}})}));var N=u(te,2),b=r(N);{let h=o((()=>e(ie)||!e(y)||!e(M)));dt(b,{variant:"soft",color:"neutral",size:2,get disabled(){return e(h)},onclick:()=>E(e(M)),children:(i,$)=>{var B=X();Re((()=>Be(B,"Save Script"))),t(i,B)},$$slots:{default:!0}})}var v=u(N,2),c=h=>{var i=Ir(),$=r(i);Ne($,{size:1,color:"error",children:(B,W)=>{var l=X();Re((()=>Be(l,e(w)))),t(B,l)},$$slots:{default:!0}}),t(h,i)};p(v,(h=>{e(w)&&h(c)})),t(C,F)};p(oe,(C=>{e(de).length>0&&C(I)})),t(De,L),ct(),x()}var Br=d('<div class="c-card-button__subtitle svelte-18cj5ew"><!></div>'),Er=d('<div class="c-card-button__icon-right svelte-18cj5ew"><!></div>'),Fr=d('<div class="c-card-button__icon-left svelte-18cj5ew"><!></div> <div class="c-card-button__content svelte-18cj5ew"><div class="c-card-button__title svelte-18cj5ew"><!></div> <!></div> <!>',1);function Rn(De,n){let a=le(n,"title",3,"Select an option"),f=le(n,"subtitle",3,"");var x=Fr(),g=m(x),y=r(g);Ze(y,(()=>n.iconLeft??zt));var M=u(g,2),ie=r(M),w=r(ie),ee=k=>{var U=H(),Z=m(U);Ze(Z,a),t(k,U)},de=k=>{Ne(k,{size:2,children:(U,Z)=>{var E=X();Re((()=>Be(E,a()))),t(U,E)},$$slots:{default:!0}})};p(w,(k=>{typeof a()!="string"?k(ee):k(de,!1)}));var G=u(ie,2),ge=k=>{var U=Br(),Z=r(U),E=oe=>{var I=H(),C=m(I);Ze(C,(()=>n.subtitleSnippet)),t(oe,I)},L=oe=>{Ne(oe,{size:2,children:(I,C)=>{var F=X();Re((()=>Be(F,f()))),t(I,F)},$$slots:{default:!0}})};p(Z,(oe=>{n.subtitleSnippet?oe(E):oe(L,!1)})),t(k,U)};p(G,(k=>{f()&&k(ge)}));var Ae=u(M,2),xe=k=>{var U=Er(),Z=r(U);Ze(Z,(()=>n.iconRight)),t(k,U)};p(Ae,(k=>{n.iconRight&&k(xe)})),t(De,x)}var zr=d('<div role="button"><!></div>'),Mr=d('<div class="c-card__dropdown-contents svelte-15clipb"><div class="c-card-button__dropdown-top svelte-15clipb"><!></div> <div class="c-card-button__dropdown-content svelte-15clipb"><!></div></div>'),Nr=d("<!> <!>",1),Tr=d('<button class="c-card-button__display svelte-15clipb" type="button"><!></button>'),Ur=d('<div class="c-card-button svelte-15clipb"><!></div>');function An(De,n){it(n,!0);let a=le(n,"type",3,"button"),f=le(n,"title",3,"Select an option"),x=le(n,"subtitle",3,""),g=le(n,"onclick",3,(()=>{})),y=le(n,"items",19,(()=>[])),M=le(n,"selectedItem",15),ie=le(n,"formatItemLabel",3,(E=>E?.toString()||"")),w=le(n,"noItemsLabel",3,"No items found"),ee=le(n,"onDropdownOpenChange",3,(()=>{})),de=le(n,"disabled",3,!1),G=se(void 0);function ge(E){M(E),n.onselect?.(E)}var Ae={requestClose:function(){e(G)?.requestClose()},selectItem:ge},xe=Ur(),k=r(xe),U=E=>{var L=H(),oe=m(L);Ie(oe,(()=>He.Root),((I,C)=>{St(C(I,{get onOpenChange(){return ee()},children:(F,z)=>{var V=Nr(),D=m(V);Ie(D,(()=>He.Trigger),((q,S)=>{S(q,{children:(R,K)=>{var J=zr();let ue;{const me=P=>{var ne=H(),fe=m(ne),te=b=>{n.iconRight(b)},N=b=>{ye(b,{name:"chevron-down"})};p(fe,(b=>{n.iconRight?b(te):b(N,!1)})),t(P,ne)};Rn(r(J),{get subtitle(){return x()},get iconLeft(){return n.iconLeft},get title(){return f()},iconRight:me,$$slots:{iconRight:!0}})}Re((()=>{ue=Nt(J,1,"c-card-button__display svelte-15clipb",null,ue,{disabled:de()}),Et(J,"tabindex",de()?-1:0)})),t(R,J)},$$slots:{default:!0}})}));var j=u(D,2);Ie(j,(()=>He.Content),((q,S)=>{S(q,{align:"start",side:"bottom",children:(R,K)=>{var J=Mr(),ue=r(J),me=r(ue);Ze(me,(()=>n.dropdownTop??zt));var P=u(ue,2),ne=r(P),fe=N=>{var b=H(),v=m(b);Ze(v,(()=>n.dropdownContent)),t(N,b)},te=N=>{var b=H(),v=m(b),c=i=>{var $=H(),B=m($);Pt(B,17,y,(W=>ie()(W)),((W,l)=>{var _=H(),Q=m(_);{let ae=o((()=>M()===e(l)));Ie(Q,(()=>He.Item),(($e,_e)=>{_e($e,{onSelect:()=>ge(e(l)),get highlight(){return e(ae)},children:(we,Pe)=>{var Ee=X();Re((Se=>Be(Ee,Se)),[()=>ie()(e(l))]),t(we,Ee)},$$slots:{default:!0}})}))}t(W,_)})),t(i,$)},h=i=>{var $=H(),B=m($);Ie(B,(()=>He.Label),((W,l)=>{l(W,{children:(_,Q)=>{var ae=X();Re((()=>Be(ae,w()))),t(_,ae)},$$slots:{default:!0}})})),t(i,$)};p(v,(i=>{y().length>0?i(c):i(h,!1)}),!0),t(N,b)};p(ne,(N=>{n.dropdownContent?N(fe):N(te,!1)})),t(R,J)},$$slots:{default:!0}})})),t(F,V)},$$slots:{default:!0}}),(F=>s(G,F,!0)),(()=>e(G)))})),t(E,L)},Z=E=>{var L=Tr();L.__click=()=>{g()(),n.onselect?.(M())},L.__keydown=oe=>{oe.key!=="Enter"&&oe.key!==" "||(g()(),n.onselect?.(M()))},Rn(r(L),{get title(){return f()},get subtitle(){return x()},get iconLeft(){return n.iconLeft},get iconRight(){return n.iconRight}}),Re((()=>L.disabled=de())),t(E,L)};return p(k,(E=>{a()==="dropdown"?E(U):E(Z,!1)})),t(De,xe),ct(Ae)}Mt(["click","keydown"]);var Hr=d('<a target="_blank"> </a>'),Or=d('<!> <div class="github-auth-error-url-container svelte-g0bk5e"><!> <!></div>',1),Gr=d('<div class="github-auth-error svelte-g0bk5e"><!> <!> <!></div>'),qr=d("<!> <!>",1),jr=d('<div class="github-auth-card svelte-g0bk5e"><div class="github-auth-button"><!></div></div>');function Wr(De,n){it(n,!0);const a=ut(Ut.key);let f=se(!1),x=se(!1),g=se(!1),y=se(null),M=se(null),ie=se(void 0),w=se(void 0);async function ee(){if(s(ie,void 0),s(w,void 0),e(x))return s(x,!1),void(e(y)&&(clearTimeout(e(y)),s(y,null)));s(x,!0);try{const{success:k,message:U,url:Z}=await a.authenticateGithub();if(!k)throw s(w,Z,!0),new Error(U);s(M,setInterval((async()=>{try{await a.isGithubAuthenticated()&&(s(f,!0),s(x,!1),n.onauthStateChange?.({isAuthenticated:!0}),e(M)&&clearInterval(e(M)),e(y)&&(clearTimeout(e(y)),s(y,null)))}catch(E){console.error("Failed to check GitHub authentication status:",E)}}),5e3),!0),s(y,setTimeout((()=>{e(M)&&clearInterval(e(M)),s(x,!1),s(y,null)}),6e4),!0)}catch(k){console.error("Failed to authenticate with GitHub:",k),s(ie,`Error: ${k instanceof Error?k.message:String(k)}`),s(x,!1)}}It((async()=>{await(async function(){try{const k=await a.isGithubAuthenticated();k!==e(f)?(s(f,k,!0),n.onauthStateChange?.({isAuthenticated:e(f)})):s(f,k,!0)}catch(k){console.error("Failed to check GitHub authentication status:",k),s(f,!1),n.onauthStateChange?.({isAuthenticated:!1})}})()})),Tt((()=>{e(y)&&(clearTimeout(e(y)),s(y,null)),e(M)&&(clearInterval(e(M)),s(M,null))}));var de=jr(),G=r(de),ge=r(G),Ae=k=>{var U=qr(),Z=m(U);{const oe=F=>{ye(F,{name:"github"})},I=F=>{var z=H(),V=m(z),D=q=>{Ct(q,{size:1,useCurrentColor:!0})},j=q=>{ye(q,{name:"chevron-right"})};p(V,(q=>{e(x)?q(D):q(j,!1)})),t(F,z)};let C=o((()=>e(x)?"Cancel":"Connect to GitHub"));An(Z,{type:"button",get title(){return e(C)},onclick:ee,iconLeft:oe,iconRight:I,$$slots:{iconLeft:!0,iconRight:!0}})}var E=u(Z,2),L=oe=>{var I=Gr(),C=r(I);Ne(C,{size:1,children:(D,j)=>{var q=X("An error occurred while authenticating with GitHub.");t(D,q)},$$slots:{default:!0}});var F=u(C,2),z=D=>{var j=Or(),q=m(j);Ne(q,{size:1,children:(J,ue)=>{var me=X("Visit or copy the following URL in your browser to authenticate manually:");t(J,me)},$$slots:{default:!0}});var S=u(q,2),R=r(S);Ne(R,{size:1,class:"github-auth-error-url",children:(J,ue)=>{var me=Hr(),P=r(me);Re((()=>{Et(me,"href",e(w)),Be(P,e(w))})),t(J,me)},$$slots:{default:!0}});var K=u(R,2);Ma(K,{get text(){return e(w)},tooltipNested:!1}),t(D,j)};p(F,(D=>{e(w)&&D(z)}));var V=u(F,2);Ne(V,{size:1,children:(D,j)=>{var q=X();Re((()=>Be(q,e(ie)))),t(D,q)},$$slots:{default:!0}}),t(oe,I)};p(E,(oe=>{e(ie)&&oe(L)})),t(k,U)},xe=k=>{An(k,{type:"dropdown",title:"Connected to your GitHub account",iconLeft:E=>{ye(E,{name:"github"})},dropdownContent:E=>{var L=H(),oe=m(L);{const I=C=>{var F=H(),z=m(F),V=D=>{Ct(D,{size:1,useCurrentColor:!0})};p(z,(D=>{e(g)&&D(V)})),t(C,F)};Ie(oe,(()=>He.Item),((C,F)=>{F(C,{color:"error",onSelect:()=>{(async function(){if(!e(g)){s(g,!0);try{const z=await a.revokeGithubAccess();z.success?(s(f,!1),n.onauthStateChange?.({isAuthenticated:!1})):console.error("Failed to revoke GitHub access:",z.message)}catch(z){console.error("Error revoking GitHub access:",z)}finally{s(g,!1)}}})()},iconLeft:I,children:(z,V)=>{var D=H(),j=m(D),q=R=>{Ne(R,{size:1,weight:"medium",children:(K,J)=>{var ue=X("Revoking...");t(K,ue)},$$slots:{default:!0}})},S=R=>{Ne(R,{size:1,weight:"medium",children:(K,J)=>{var ue=X("Revoke Access");t(K,ue)},$$slots:{default:!0}})};p(j,(R=>{e(g)?R(q):R(S,!1)})),t(z,D)},$$slots:{iconLeft:!0,default:!0}})}))}t(E,L)},$$slots:{iconLeft:!0,dropdownContent:!0}})};p(ge,(k=>{e(f)?k(xe,!1):k(Ae)})),t(De,de),ct()}var Vr=d('<div class="c-searchable-dropdown__input-container svelte-59urdx"><div class="c-searchable-dropdown__icon svelte-59urdx"><!></div> <input type="text" class="c-searchable-dropdown__trigger-input svelte-59urdx"/> <!></div>'),Kr=d('<div role="button"><div class="c-searchable-dropdown__icon-text svelte-59urdx"><div class="c-searchable-dropdown__icon svelte-59urdx"><!></div> <span class="c-searchable-dropdown__button-text svelte-59urdx"><!></span></div> <div class="c-searchable-dropdown__chevron svelte-59urdx"><!></div></div>'),Jr=d('<!> <div class="c-searchable-dropdown__separator svelte-59urdx"><!></div>',1),Xr=d('<div class="c-searchable-dropdown__loading svelte-59urdx"><!> <span> </span></div>'),Qr=d('<div class="c-searchable-dropdown__item-title svelte-59urdx"><!></div>'),Zr=d("<!> <!>",1),Yr=d('<div class="c-searchable-dropdown__content svelte-59urdx"><!> <!> <!> <div style="margin-bottom: var(--ds-spacing-2);"></div></div>'),es=d("<!> <!>",1),ts=d('<div class="c-searchable-dropdown svelte-59urdx"><!></div>');function Jt(De,n){it(n,!0);let a=le(n,"title",3,""),f=le(n,"placeholder",3,"Search..."),x=le(n,"isLoading",3,!1),g=le(n,"disabled",3,!1),y=le(n,"searchValue",15,""),M=le(n,"items",19,(()=>[])),ie=le(n,"selectedItem",3,null),w=le(n,"actions",19,(()=>[])),ee=le(n,"actionLabelFn",3,(L=>L?.toString()||"")),de=le(n,"itemLabelFn",3,(L=>L?.toString()||"")),G=le(n,"itemKeyFn",3,(L=>L?.toString()||"")),ge=le(n,"noItemsLabel",3,"No items found"),Ae=le(n,"loadingLabel",3,"Loading..."),xe=se(!1),k=se(void 0);function U(L){if(!g()){if(s(xe,L,!0),L&&ie()){const oe=de()(ie());y(oe),n.onsearch?.(""),setTimeout((()=>{const I=document.querySelector(".c-searchable-dropdown__trigger-input");I&&I.select()}),0)}else L&&(y(""),n.onsearch?.(""));n.onopenChange?.(L)}}var Z=ts(),E=r(Z);Ie(E,(()=>He.Root),((L,oe)=>{St(oe(L,{onOpenChange:U,children:(I,C)=>{var F=es(),z=m(F);Ie(z,(()=>He.Trigger),((j,q)=>{q(j,{children:(S,R)=>{var K=H(),J=m(K),ue=P=>{var ne=Vr(),fe=r(ne),te=r(fe),N=i=>{var $=H(),B=m($);Ze(B,(()=>n.searchIcon)),t(i,$)},b=i=>{var $=H(),B=m($),W=l=>{var _=H(),Q=m(_);Ze(Q,(()=>n.icon)),t(l,_)};p(B,(l=>{n.icon&&l(W)}),!0),t(i,$)};p(te,(i=>{n.searchIcon?i(N):i(b,!1)}));var v=u(fe,2);v.__input=i=>{return $=i.currentTarget.value,y($),void n.onsearch?.($);var $},v.__click=i=>i.stopPropagation(),v.__mousedown=i=>i.stopPropagation();var c=u(v,2),h=i=>{var $=H(),B=m($);Ze(B,(()=>n.inputButton)),t(i,$)};p(c,(i=>{n.inputButton&&i(h)})),Re((()=>Et(v,"placeholder",f()))),Na(v,y),t(P,ne)},me=P=>{var ne=Kr();let fe;var te=r(ne),N=r(te),b=r(N),v=_=>{Ct(_,{size:1,useCurrentColor:!0})},c=_=>{var Q=H(),ae=m(Q),$e=_e=>{var we=H(),Pe=m(we);Ze(Pe,(()=>n.icon)),t(_e,we)};p(ae,(_e=>{n.icon&&_e($e)}),!0),t(_,Q)};p(b,(_=>{x()?_(v):_(c,!1)}));var h=u(N,2),i=r(h),$=_=>{var Q=H(),ae=m(Q);Ze(ae,(()=>n.titleSnippet)),t(_,Q)},B=_=>{var Q=X();Re((()=>Be(Q,x()?Ae():a()))),t(_,Q)};p(i,(_=>{n.titleSnippet?_($):_(B,!1)}));var W=u(te,2),l=r(W);ye(l,{name:"chevron-down"}),Re((()=>{fe=Nt(ne,1,"c-searchable-dropdown__button svelte-59urdx",null,fe,{"c-searchable-dropdown__button--disabled":g()}),Et(ne,"tabindex",g()?-1:0)})),t(P,ne)};p(J,(P=>{e(xe)?P(ue):P(me,!1)})),t(S,K)},$$slots:{default:!0}})}));var V=u(z,2),D=j=>{var q=H(),S=m(q);Ie(S,(()=>He.Content),((R,K)=>{K(R,{side:"top",align:"start",children:(J,ue)=>{var me=Yr(),P=r(me),ne=c=>{var h=Jr(),i=m(h);Pt(i,17,w,(W=>W.name),((W,l)=>{var _=H(),Q=m(_);Ie(Q,(()=>He.Item),((ae,$e)=>{$e(ae,{onSelect:()=>{return _e=e(l),n.onaction?.(_e.type),void e(k)?.requestClose();var _e},get disabled(){return e(l).disabled},children:(_e,we)=>{var Pe=H(),Ee=m(Pe),Se=ke=>{var A=H(),O=m(A);Ze(O,(()=>n.action),(()=>({action:e(l)}))),t(ke,A)},ve=ke=>{var A=X();Re((O=>Be(A,O)),[()=>ee()(e(l))]),t(ke,A)};p(Ee,(ke=>{n.action?ke(Se):ke(ve,!1)})),t(_e,Pe)},$$slots:{default:!0}})})),t(W,_)}));var $=u(i,2),B=r($);Ie(B,(()=>He.Separator),((W,l)=>{l(W,{})})),t(c,h)};p(P,(c=>{w().length>0&&c(ne)}));var fe=u(P,2),te=c=>{var h=H(),i=m(h);Ie(i,(()=>He.Item),(($,B)=>{B($,{disabled:!0,children:(W,l)=>{var _=Xr(),Q=r(_);Ct(Q,{size:1,useCurrentColor:!0});var ae=u(Q,2),$e=r(ae);Re((()=>Be($e,Ae()))),t(W,_)},$$slots:{default:!0}})})),t(c,h)},N=c=>{var h=H(),i=m(h),$=W=>{var l=Zr(),_=m(l),Q=$e=>{var _e=Qr(),we=r(_e);Ne(we,{size:1,class:"c-searchable-dropdown__item-title",children:(Pe,Ee)=>{var Se=X();Re((()=>Be(Se,n.itemTitle))),t(Pe,Se)},$$slots:{default:!0}}),t($e,_e)};p(_,($e=>{n.itemTitle&&$e(Q)}));var ae=u(_,2);Pt(ae,19,M,(($e,_e)=>$e===null?`null-item-${_e}`:G()($e,_e)),(($e,_e)=>{var we=H(),Pe=m(we);{let Ee=o((()=>n.isItemSelected?n.isItemSelected(e(_e),ie()):!!ie()&&de()(ie())===de()(e(_e))));Ie(Pe,(()=>He.Item),((Se,ve)=>{ve(Se,{onSelect:()=>{return ke=e(_e),n.onselect?.(ke),void e(k)?.requestClose();var ke},get highlight(){return e(Ee)},children:(ke,A)=>{var O=H(),ce=m(O),Ce=Y=>{var re=H(),Fe=m(re);Ze(Fe,(()=>n.item),(()=>({item:e(_e)}))),t(Y,re)},T=Y=>{var re=X();Re((Fe=>Be(re,Fe)),[()=>de()(e(_e))]),t(Y,re)};p(ce,(Y=>{n.item?Y(Ce):Y(T,!1)})),t(ke,O)},$$slots:{default:!0}})}))}t($e,we)})),t(W,l)},B=W=>{var l=H(),_=m(l),Q=ae=>{var $e=H(),_e=m($e);Ie(_e,(()=>He.Item),((we,Pe)=>{Pe(we,{disabled:!0,children:(Ee,Se)=>{var ve=X();Re((()=>Be(ve,ge()))),t(Ee,ve)},$$slots:{default:!0}})})),t(ae,$e)};p(_,(ae=>{ge()&&ae(Q)}),!0),t(W,l)};p(i,(W=>{M().length>0?W($):W(B,!1)}),!0),t(c,h)};p(fe,(c=>{x()?c(te):c(N,!1)}));var b=u(fe,2),v=c=>{var h=H(),i=m(h);Ze(i,(()=>n.footer)),t(c,h)};p(b,(c=>{n.footer&&c(v)})),t(J,me)},$$slots:{default:!0}})})),t(j,q)};p(V,(j=>{g()||j(D)})),t(I,F)},$$slots:{default:!0}}),(I=>s(k,I,!0)),(()=>e(k)))})),t(De,Z),ct()}Mt(["input","click","mousedown"]);class Zt{constructor(n,a=Zt._defaultPagesPerLoad){this.gitRefModel=n,this._pagesPerLoad=a}_selectedRepo=_t(void 0);_selectedBranch=_t(void 0);_allRepos=_t([]);_allBranches=_t([]);_addedRepos=[];_error=void 0;_isDevDeploy=!1;static _defaultPagesPerLoad=20;_loadedRepoPages=0;_hasMoreRepoPages=!1;_loadedBranchPages=0;_hasMoreBranchPages=!1;_lastUsedRepoUrl;_lastUsedBranchName;_shouldCancelFetches=!1;cancelOngoingFetches(){this._shouldCancelFetches=!0}get selectedRepo(){return this._selectedRepo}set selectedRepo(n){this._selectedRepo.set(n),this._allBranches.set([])}get selectedBranch(){return this._selectedBranch}set selectedBranch(n){this._selectedBranch.set(n)}get allRepos(){return this._allRepos}get allBranches(){return this._allBranches}get error(){return this._error}get isDevDeploy(){return this._isDevDeploy}set lastUsedRepoUrl(n){this._lastUsedRepoUrl=n}get lastUsedRepoUrl(){return this._lastUsedRepoUrl}set lastUsedBranchName(n){this._lastUsedBranchName=n}get lastUsedBranchName(){return this._lastUsedBranchName}async updateReposList(){const{repos:n,error:a,isDevDeploy:f}=await this.gitRefModel.listUserRepos();if(f)return this._isDevDeploy=!0,void this._allRepos.set(await this.fetchLocalRepos());if(a)this._error=a;else{this._isDevDeploy=f||!1;try{const x=await this.getCurrentWorkspaceRepo();if(x&&!n.some((g=>g.name===x.name&&g.owner===x.owner))){const{repo:g,error:y}=await this.gitRefModel.getGithubRepo(x);y?console.error("Failed to fetch GitHub repo:",y):g&&n.unshift(g)}}catch(x){console.error("Failed to fetch GitHub repo:",x)}this._allRepos.set([...this._addedRepos,...n])}}async updateRepos(n=!1,a,f){return this._loadedRepoPages=0,this._hasMoreBranchPages=!1,this._allRepos.set([]),this._shouldCancelFetches=!1,await this.updateReposAtPage(1,n,a,f),this._hasMoreRepoPages}async loadMoreRepos(n){return!!this._hasMoreRepoPages&&(this._shouldCancelFetches=!1,await this.updateReposAtPage(this._loadedRepoPages+1,!1,void 0,n),this._hasMoreRepoPages)}async preselectRepo(){if(ht(this._selectedRepo))return!1;const n=x=>{const g=ht(this._allRepos).find((y=>y.html_url===x));return!!g&&(this._selectedRepo.set(g),!0)},a=await this.getCurrentWorkspaceRepo(),f=ht(this._allRepos);if(a){const x=f.find((g=>g.name===a.name&&g.owner===a.owner));if(x)return this._selectedRepo.set(x),!0}return this._lastUsedRepoUrl?n(this._lastUsedRepoUrl):(this._selectedRepo.set(f[0]),!0)}async preselectLocalRepo(){if(ht(this._selectedRepo))return!1;const n=await this.getCurrentWorkspaceRepo();if(!n)return!1;const{repo:a,error:f}=await this.gitRefModel.getGithubRepo(n);return f?(console.error("Failed to preselect local repo:",f),!1):(this._selectedRepo.set(a),!0)}addRepo(n){this._addedRepos.push(n),this._allRepos.update((a=>a.some((f=>f.name===n.name&&f.owner===n.owner))?a:[n,...a]))}async updateBranches(n=!1,a,f){return!!ht(this._selectedRepo)&&(this._isDevDeploy?(this._allBranches.set(await this.fetchLocalBranches()),!1):(this._loadedBranchPages=0,this._hasMoreBranchPages=!1,this._allBranches.set([]),this._shouldCancelFetches=!1,await this.updateBranchesAtPage(1,n,a,f),this._hasMoreBranchPages))}async loadMoreBranches(n){return!!this._hasMoreBranchPages&&(this._shouldCancelFetches=!1,await this.updateBranchesAtPage(this._loadedBranchPages+1,!1,void 0,n),this._hasMoreBranchPages)}preselectBranch(){const n=ht(this._selectedRepo);if(!n||ht(this._selectedBranch))return!1;const a=ht(this._allBranches);if(this._lastUsedBranchName){const f=a.find((x=>x.name===this._lastUsedBranchName));if(f)return this._selectedBranch.set(f),!0}if(n.default_branch){const f=a.find((x=>x.name===n.default_branch));return f?(this._selectedBranch.set(f),!0):(this._selectedBranch.set({name:n.default_branch,commit:{sha:"",url:""},protected:!1}),!0)}return this._selectedBranch.set(a[0]),!0}async fetchLocalRepos(){console.warn("Fetching repos from local git environment.");const{remoteUrl:n,error:a}=await this.gitRefModel.getRemoteUrl(),f=Kt(n);if(!f||a)return this._error=a??"Failed to parse remote URL in your local git repo.",[];const{owner:x,name:g}=f;return[{name:g,owner:x,html_url:n}]}async fetchLocalBranches(){console.warn("Fetching branches from local git environment.");const n=(function(x){return x.filter((g=>g.isRemote))})((await this.gitRefModel.listBranches()).branches),a=n.find((x=>x.isDefault)),f=x=>({name:In(x.name),commit:{sha:"",url:""},protected:!1});return a&&this._selectedBranch.set(f(a)),n.map(f)}async getCurrentWorkspaceRepo(){const{remoteUrl:n,error:a}=await this.gitRefModel.getRemoteUrl();if(a)return;const f=Kt(n);if(!f)return;const{owner:x,name:g}=f;return{name:g,owner:x,html_url:n}}async updateReposAtPage(n,a=!1,f,x){if(!(n<=this._loadedRepoPages))do{if(x?.aborted||this._shouldCancelFetches)break;await new Promise((y=>setTimeout(y,0)));const g=await this.gitRefModel.listUserRepos(n);if(g.error){this._error=g.error;break}if(g.isDevDeploy){this._isDevDeploy=!0,this._allRepos.set(await this.fetchLocalRepos());break}this._isDevDeploy&&(this._isDevDeploy=!1),this._allRepos.update((y=>[...y,...g.repos])),n=g.nextPage,this._loadedRepoPages++,this._hasMoreRepoPages=g.hasNextPage,a&&await this.preselectRepo()&&f?.()}while(this._loadedRepoPages%this._pagesPerLoad!=0&&this._hasMoreRepoPages)}async updateBranchesAtPage(n,a=!1,f,x){const g=ht(this._selectedRepo);if(g&&!(n<=this._loadedBranchPages))do{if(x?.aborted||this._shouldCancelFetches)break;if(g!==ht(this._selectedRepo)){this._allBranches.set([]);break}await new Promise((M=>setTimeout(M,0)));const y=await this.gitRefModel.listRepoBranches(g,n);if(y.error){this._error=y.error;break}this._allBranches.update((M=>[...M,...y.branches])),n=y.nextPage,this._loadedBranchPages++,this._hasMoreBranchPages=y.hasNextPage,a&&this.preselectBranch()&&f?.()}while(this._loadedBranchPages%this._pagesPerLoad!=0&&this._hasMoreBranchPages)}}var ns=d('<button type="button" class="c-commit-ref-selector__item c-commit-ref-selector__item--loading svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></button>'),as=d('<div class="c-commit-ref-selector__item c-commit-ref-selector__item--loading c-commit-ref-selector__item--disabled svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></div>'),rs=d('<div class="c-commit-ref-selector__refresh-button svelte-akmdmd"><!></div>'),ss=d('<button type="button" class="c-commit-ref-selector__item c-commit-ref-selector__item--loading svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></button>'),os=d('<div class="c-commit-ref-selector__item c-commit-ref-selector__item--loading c-commit-ref-selector__item--disabled svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></div>'),is=d('<div class="c-commit-ref-selector__selectors-container svelte-akmdmd"><div class="c-commit-ref-selector__selector svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__selector svelte-akmdmd"><!></div></div>'),cs=d('<div class="c-commit-ref-selector__error-content svelte-akmdmd"><div class="c-commit-ref-selector__error-message svelte-akmdmd"> </div> <!></div>'),ls=d('<div class="c-commit-ref-selector__error svelte-akmdmd"><!></div>'),ds=d('<div class="c-commit-ref-selector svelte-akmdmd"><div class="c-commit-ref-selector__content svelte-akmdmd"><!></div></div>');function us(De,n){it(n,!0);const a=()=>Ge(xe,"$selectedRepo",y),f=()=>Ge(k,"$selectedBranch",y),x=()=>Ge(ge,"$allRepos",y),g=()=>Ge(Ae,"$allBranches",y),[y,M]=mt();let ie=le(n,"errorMessage",15,""),w=le(n,"isLoading",15,!1),ee=le(n,"lastUsedBranchName",3,null),de=le(n,"lastUsedRepoUrl",3,null);const G=new Zt(n.gitRefModel),ge=G.allRepos,Ae=G.allBranches,xe=G.selectedRepo,k=G.selectedBranch;$t((()=>{G.lastUsedRepoUrl=de()??void 0})),$t((()=>{G.lastUsedBranchName=ee()??void 0}));let U=o((()=>ie()!=="")),Z=se("warning"),E=se(!1),L=se(!1),oe=se(!1),I=se(!1),C=o((()=>a()&&e(E)&&!f())),F=o((()=>e(L)&&!a())),z=se(!1);const V=new Set;let D=o((()=>{if(a()){const{owner:A,name:O}=a();return V.has(O)?`${A}/${O}`:O}return"Choose repository..."})),j=se(!1);const q=new Map;let S=se(!1);const R=_t(""),K=_t(""),J=Bt((function(A){R.set(A),s(j,!0)}),300,{leading:!1,trailing:!0}),ue=Bt((function(A){K.set(A),s(S,!0)}),300,{leading:!1,trailing:!0}),me={failedToFetchBranches:"Failed to fetch branches. Please try again.",failedToFetchFromRemote:"Failed to fetch from remote. Please try again."};let P;It((async()=>{P=new AbortController,await h()})),Tt((()=>{P&&(P.abort(),G.cancelOngoingFetches())}));const ne=nn([ge,R],(([A,O],ce)=>{ie(""),s(z,!1);try{if(e(j)){const Ce=Kt(O);Ce&&n.gitRefModel.getGithubRepo(Ce).then((({repo:T,error:Y})=>{if(Y)throw new Error(Y);const re=`${T.owner}/${T.name}`;q.has(re)||(q.set(re,T),G.addRepo(T)),s(z,!0),ce([T])})).catch((T=>{console.error("Failed to get GitHub repo from URL",T),ce([])})),ce((function(T,Y){if(Y==="")return T;const re=Y.toLowerCase().split("/",2).filter((Fe=>Fe.length>0));return T.filter((Fe=>{const Te=Fe.owner.toLowerCase(),Oe=Fe.name.toLowerCase();return re.length===1?Te.includes(re[0])||Oe.includes(re[0]):re.length!==2||re[0]===Te&&Oe.includes(re[1])}))})(A,O))}else ce(A)}catch(Ce){console.error("Error fetching repos:",Ce),i(me.failedToFetchFromRemote),ce([])}})),fe=nn([Ae,xe,K],(([A,O,ce])=>{if(e(S)&&ce.trim()!=="")return Ce=ce,A.filter((T=>T.name.toLowerCase().includes(Ce.toLowerCase())));if(O?.default_branch)return[A.find((Y=>Y.name===O?.default_branch))||{name:O.default_branch,commit:{sha:"",url:""},protected:!1},...A.filter((Y=>Y.name!==O?.default_branch))];return A;var Ce}));async function te(){s(L,!0),s(I,await G.updateRepos(!0,l,P?.signal),!0),(function(){V.clear();const A=new Set;x().forEach((O=>{A.has(O.name)?V.add(O.name):A.add(O.name)}))})(),await G.preselectRepo(),s(L,!1)}function N(){xe&&(async function(){a()&&(s(E,!0),s(oe,await G.updateBranches(!0,l,P?.signal),!0),s(E,!1))})().then((()=>{w(!1),e(U)||l()})).catch((A=>{console.error("Error fetching all branches:",A),i(`Failed to fetch branches: ${A instanceof Error?A.message:String(A)}`)}))}let b=se(!0);const v=async()=>{try{s(b,await n.gitRefModel.isGithubAuthenticated(),!0),e(b)||i("Please authenticate with GitHub to use this feature.","info")}catch(A){console.error("Failed to check GitHub authentication status:",A),i("Please authenticate with GitHub to use this feature."),s(b,!1)}};async function c(){w(!0),ie(""),s(Z,"warning");try{if(await v(),!e(b))return void w(!1);s(L,!0),s(E,!0);let A=!1;G.preselectLocalRepo().then((O=>(A=O,l(),O))).then((O=>{O&&N()})).catch((O=>{console.error("Failed to preselect local repo while fetching all repos: ",O)})),await te(),e(U)||A||(s(L,!1),N()),e(U)||l()}catch(A){console.error("Error fetching git data:",A),i(me.failedToFetchBranches)}finally{w(!1)}}async function h(){w(!0);try{await c()}catch(A){console.error("Error fetching and syncing branches:",A),i("Failed to fetch repos and branches. Please try again.")}finally{w(!1)}}function i(A,O="warning"){console.error("Error:",A),ie(A),s(Z,O,!0)}async function $(A){G.selectedBranch=A,s(S,!1),_(f()?.name??""),l(),n.onSelectedBranch?.()}async function B(A){s(E,!0),G.selectedRepo=A,G.selectedBranch=void 0,s(j,!1),Q(""),N(),n.onSelectedRepo?.()}function W(A,O){A||(O==="repo"?s(j,!1):(O==="branch"||s(j,!1),s(S,!1)))}function l(){if(!a()?.html_url||!f())return;const A={github_commit_ref:{repository_url:a().html_url,git_ref:f().name}};n.oncommitRefChange?.({commitRef:A,selectedBranch:f()})}$t((()=>{e(S)?_(""):_(f()?.name??"")}));const _=A=>{K.set(A)},Q=A=>{R.set(A)};let ae=o((()=>!a()||!e(S)&&!g().length));function $e(A){A&&e(ae)||W(A,"branch")}function _e(A){A&&!x().length||W(A,"repo")}function we(){N()}var Pe=ds(),Ee=r(Pe),Se=r(Ee),ve=A=>{var O=is(),ce=r(O),Ce=r(ce);{const re=be=>{ye(be,{name:"github"})},Fe=be=>{ye(be,{name:"search"})},Te=be=>{var je=H(),rt=m(je),st=Ke=>{{let We=o((()=>`${x().length} repos loaded`)),Ye=o((()=>[pt.Hover]));ot(Ke,{get content(){return e(We)},get triggerOn(){return e(Ye)},nested:!1,children:(Je,pe)=>{var Le=ns();Le.__click=async()=>{s(L,!0),s(I,await G.loadMoreRepos(),!0),s(L,!1)};var Ue=r(Le),Xe=r(Ue);ye(Xe,{name:"chevrons-down"});var Qe=u(Ue,2),tt=r(Qe);Ne(tt,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(ze,nt)=>{var lt=X("Load more repos");t(ze,lt)},$$slots:{default:!0}}),t(Je,Le)},$$slots:{default:!0}})}},qe=Ke=>{var We=H(),Ye=m(We),Je=pe=>{var Le=as(),Ue=r(Le),Xe=r(Ue);Ct(Xe,{size:1});var Qe=u(Ue,2),tt=r(Qe);Ne(tt,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(ze,nt)=>{var lt=X("Loading repos...");t(ze,lt)},$$slots:{default:!0}}),t(pe,Le)};p(Ye,(pe=>{e(L)&&pe(Je)}),!0),t(Ke,We)};p(rt,(Ke=>{!e(I)||e(L)||e(z)?Ke(qe,!1):Ke(st)})),t(be,je)};let Oe=o((()=>!e(C)&&e(F))),he=o((()=>!x().length));Jt(Ce,{get title(){return e(D)},placeholder:"Search repositories or paste a GitHub URL...",itemKeyFn:be=>`${be.owner}-${be.name}`,get isLoading(){return e(Oe)},get disabled(){return e(he)},get items(){return Ge(ne,"$displayedRepos",y)},get selectedItem(){return a()},itemLabelFn:be=>`${be.owner}/${be.name}`,noItemsLabel:"No repositories found",loadingLabel:"Loading repositories...",onopenChange:_e,get onsearch(){return J},onselect:B,get searchValue(){return rn(),Ge(R,"$repoSearchValue",y)},set searchValue(be){an(R,be)},icon:re,searchIcon:Fe,footer:Te,$$slots:{icon:!0,searchIcon:!0,footer:!0}})}var T=u(ce,2),Y=r(T);{const re=je=>{ye(je,{name:"git-branch"})},Fe=je=>{ye(je,{name:"search"})},Te=je=>{var rt=rs(),st=r(rt);{let qe=o((()=>[pt.Hover]));ot(st,{content:"Refresh branches",get triggerOn(){return e(qe)},nested:!1,children:(Ke,We)=>{kt(Ke,{variant:"ghost",color:"neutral",size:1,onclick:we,children:(Ye,Je)=>{ye(Ye,{name:"rotate-cw"})},$$slots:{default:!0}})},$$slots:{default:!0}})}t(je,rt)},Oe=je=>{var rt=H(),st=m(rt),qe=We=>{{let Ye=o((()=>`${g().length} branches loaded`)),Je=o((()=>[pt.Hover]));ot(We,{get content(){return e(Ye)},get triggerOn(){return e(Je)},nested:!1,children:(pe,Le)=>{var Ue=ss();Ue.__click=async()=>{s(E,!0),s(oe,await G.loadMoreBranches(),!0),s(E,!1)};var Xe=r(Ue),Qe=r(Xe);ye(Qe,{name:"chevrons-down"});var tt=u(Xe,2),ze=r(tt);Ne(ze,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(nt,lt)=>{var ft=X("Load more branches");t(nt,ft)},$$slots:{default:!0}}),t(pe,Ue)},$$slots:{default:!0}})}},Ke=We=>{var Ye=H(),Je=m(Ye),pe=Le=>{var Ue=os(),Xe=r(Ue),Qe=r(Xe);Ct(Qe,{size:1});var tt=u(Xe,2),ze=r(tt);Ne(ze,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(nt,lt)=>{var ft=X("Loading branches...");t(nt,ft)},$$slots:{default:!0}}),t(Le,Ue)};p(Je,(Le=>{e(E)&&Le(pe)}),!0),t(We,Ye)};p(st,(We=>{e(oe)&&!e(E)?We(qe):We(Ke,!1)})),t(je,rt)};let he=o((()=>f()?.name||"Choose branch...")),be=o((()=>e(E)?"":"No branches found"));Jt(Y,{get title(){return e(he)},itemKeyFn:(je,rt)=>`${je.name}-${je.commit.sha}=${rt}`,placeholder:"Search branches...",get isLoading(){return e(C)},get disabled(){return e(ae)},get items(){return Ge(fe,"$displayedBranches",y)},get selectedItem(){return f()},itemLabelFn:je=>je.name.replace("origin/",""),get noItemsLabel(){return e(be)},loadingLabel:"Loading branches...",onopenChange:$e,get onsearch(){return ue},onselect:$,get searchValue(){return rn(),Ge(K,"$branchSearchValue",y)},set searchValue(je){an(K,je)},icon:re,searchIcon:Fe,inputButton:Te,footer:Oe,$$slots:{icon:!0,searchIcon:!0,inputButton:!0,footer:!0}})}t(A,O)},ke=A=>{var O=H(),ce=m(O),Ce=T=>{var Y=ls(),re=r(Y);Ot(re,{get color(){return e(Z)},variant:"soft",size:2,children:(Fe,Te)=>{var Oe=cs(),he=r(Oe),be=r(he),je=u(he,2),rt=qe=>{Wr(qe,{onauthStateChange:async Ke=>{const{isAuthenticated:We}=Ke;We!==e(b)&&(s(b,We,!0),We&&await h())}})},st=qe=>{dt(qe,{variant:"ghost",color:"warning",size:1,onclick:h,get loading(){return w()},class:"c-commit-ref-selector__fetch-button",iconLeft:We=>{ye(We,{name:"refresh-ccw"})},children:(We,Ye)=>{var Je=X("Reload available repos and branches");t(We,Je)},$$slots:{iconLeft:!0,default:!0}})};p(je,(qe=>{e(b)?qe(st,!1):qe(rt)})),Re((()=>Be(be,ie()))),t(Fe,Oe)},$$slots:{default:!0}}),t(T,Y)};p(ce,(T=>{e(U)&&T(Ce)}),!0),t(A,O)};p(Se,(A=>{e(U)?A(ke,!1):A(ve)})),t(De,Pe),ct(),M()}Mt(["click"]);var vs=d('<div class="c-setup-script-selector__icon svelte-1fvykqe"><!></div>'),hs=d('<span class="c-setup-script-selector__extension svelte-1fvykqe"> </span>'),ps=d('<div class="c-setup-script-selector__rename-input svelte-1fvykqe" role="presentation"><div class="c-setup-script-selector__rename-input-container svelte-1fvykqe" role="presentation"><!> <!></div></div>'),gs=d('<span class="c-setup-script-selector__script-path svelte-1fvykqe"> </span>'),ms=d('<span class="c-setup-script-selector__script-name svelte-1fvykqe"> </span> <!>',1),fs=d('<div role="presentation"><!> <div class="c-setup-script-selector__script-info svelte-1fvykqe"><!></div> <div class="c-setup-script-selector__script-actions svelte-1fvykqe"><!></div></div>');Mt(["click","mousedown"]);var _s=d('<div class="c-action-selector svelte-g45zi9"><!> <!></div>'),$s=d("<!> <!> <!>",1),ws=d('<div class="c-setup-script-selector__script-line-container svelte-g45zi9"><div class="c-setup-script-selector__script-line svelte-g45zi9"><!></div></div>'),bs=d('<div class="c-setup-script-selector__error-content svelte-g45zi9"><div class="c-setup-script-selector__error-message svelte-g45zi9"> </div> <!></div>'),ys=d('<div class="c-setup-script-selector__error svelte-g45zi9"><!></div>'),Rs=d('<div class="c-setup-script-selector svelte-g45zi9"><div class="c-setup-script-selector__content svelte-g45zi9"><!> <!></div></div>');function As(De,n){it(n,!0);const a=()=>Ge(w,"$remoteAgentsModel",f),[f,x]=mt();let g=le(n,"errorMessage",15,""),y=le(n,"isLoading",3,!1),M=le(n,"lastUsedScriptPath",3,null),ie=le(n,"disableNewAgentCreation",3,!1);const w=ut(wt.key),ee=Xt(),de=v=>{ee(Ln({repoRoot:"",pathName:v.path,allowOutOfWorkspace:!0,openLocalUri:v.location==="home"}))};let G=se(Fn([])),ge=se(""),Ae=se(null),xe=se(!0),k=se(null),U=o((()=>a().newAgentDraft?.setupScript??null));function Z(v){const c=w.newAgentDraft;c&&w.setNewAgentDraft({...c,setupScript:v})}let E=o((()=>g()!=="")),L=o((()=>[{type:"basic",name:"Use basic environment",icon:"square-terminal"},{type:"auto",name:"Auto-generate setup script",icon:"wand-sparkles",disabled:ie()},{type:"manual",name:"Write a script by hand",icon:"pencil"}])),oe=o((()=>e(ge).trim()!==""?e(G).filter((v=>v.name.toLowerCase().includes(e(ge).toLowerCase())||v.path.toLowerCase().includes(e(ge).toLowerCase()))):e(G)));const I={noScriptsFound:"No setup scripts found. You can create one in ~/.augment/env/, <git root>/.augment/env/, or <workspace root>/.augment/env/.",failedToFetchScripts:"Failed to fetch setup scripts. Please try again."};async function C(){g("");try{const v=e(U)?.path;if(s(G,await w.listSetupScripts(),!0),e(xe))if(M()&&e(G).length>0){const c=e(G).find((h=>h.path===M()));c&&(Z(c),s(k,null),R(c))}else M()===null&&(Z(null),R(null));else if(v){const c=e(G).find((h=>h.path===v));c&&(Z(c),s(k,null))}s(xe,!1),e(G).length===0?g(I.noScriptsFound):g("")}catch(v){console.error("Error fetching setup scripts:",v),g(I.failedToFetchScripts)}}function F(){s(Ae,null)}function z(v){g(v)}function V(v){s(ge,v,!0)}function D(v){S(v)}function j(v){if(s(k,v,!0),Z(null),v==="basic")S(null);else{if(v==="auto")return void w.setGenerateSetupScriptSelected(!0);v==="manual"&&(async()=>{try{await w.reportRemoteAgentSetupWindowEvent(At.manuallyCreateSetupScript)}catch(c){console.error("Failed to report manually create setup script event:",c)}try{const c="setup.sh",h=`#!/bin/bash

# Setup Script for Remote Agent Environment
#
# This script installs dependencies and configures the environment for your project.
# It runs with sudo privileges when needed.
#
# Examples:
# sudo apt-get update && sudo apt-get install -y package-name
# pip install package-name
# npm install -g package-name
# export ENV_VAR=value

# Add your commands below:

`,i=await w.saveSetupScript(c,h,"home");if(i.success&&i.path){await C();const $=e(G).find((B=>B.path===i.path));$&&(S($),de($))}else console.error("Failed to create manual setup script:",i.error),g(`Failed to create manual setup script: ${i.error||"Unknown error"}`)}catch(c){console.error("Error creating manual setup script:",c),g(`Error creating manual setup script: ${c instanceof Error?c.message:String(c)}`)}})()}w.setGenerateSetupScriptSelected(!1)}function q(v){v&&(C(),s(ge,""))}async function S(v){if(Z(v),R(v),w.saveLastRemoteAgentSetup(null,null,v?.path||null),v)try{await w.reportRemoteAgentSetupWindowEvent(At.selectSetupScript)}catch(c){console.error("Failed to report setup script selection event:",c)}}function R(v){n.onsetupScriptChange?.({script:v!==void 0?v:e(U)})}It((async()=>{await C(),M()===null?S(null):a().newAgentDraft?.setupScript&&!e(U)&&S(a().newAgentDraft.setupScript)})),Tt((()=>{w.setGenerateSetupScriptSelected(!1)}));let K=o((()=>y()?"...":e(U)?e(U).isGenerateOption?e(U).name:e(U).location==="home"?"~/.augment/env/"+e(U).name:e(U).path:e(k)?e(L).find((c=>c.type===e(k)))?.name||e(k):"Use basic environment")),J=o((()=>!!e(U)?.path)),ue=o((()=>e(J)?e(K).split("/").pop():e(K))),me=o((()=>e(J)?e(K).slice(0,e(K).lastIndexOf("/")):""));var P=Rs(),ne=r(P),fe=r(ne),te=v=>{var c=ws(),h=r(c);{const i=_=>{var Q=H(),ae=m(Q),$e=we=>{bn(we,{text:Se=>{var ve=X();Re((()=>Be(ve,e(ue)))),t(Se,ve)},grayText:Se=>{var ve=X();Re((()=>Be(ve,e(me)))),t(Se,ve)},$$slots:{text:!0,grayText:!0}})},_e=we=>{bn(we,{text:Ee=>{var Se=X();Re((()=>Be(Se,e(K)))),t(Ee,Se)},$$slots:{text:!0}})};p(ae,(we=>{e(J)?we($e):we(_e,!1)})),t(_,Q)},$=_=>{ye(_,{name:"terminal"})},B=_=>{ye(_,{name:"search"})},W=(_,Q)=>{let ae=()=>Q?.().action;var $e=H(),_e=m($e),we=Pe=>{var Ee=_s(),Se=r(Ee);ye(Se,{get name(){return ae().icon}});var ve=u(Se,2);Ne(ve,{size:1,children:(ke,A)=>{var O=X();Re((()=>Be(O,ae().name))),t(ke,O)},$$slots:{default:!0}}),t(Pe,Ee)};p(_e,(Pe=>{ae()&&Pe(we)})),t(_,$e)},l=(_,Q)=>{let ae=()=>Q?.().item;var $e=H(),_e=m($e),we=Pe=>{{let Ee=o((()=>e(Ae)?.path===ae().path));(function(Se,ve){it(ve,!0);let ke=le(ve,"isPath",3,!1),A=le(ve,"isRenaming",3,!1),O=le(ve,"showPath",3,!0);function ce(pe){const Le=pe.lastIndexOf(".");return Le===-1?{baseName:pe,extension:""}:{baseName:pe.substring(0,Le),extension:pe.substring(Le)}}let Ce=o((()=>ce(ve.name).baseName)),T=o((()=>ce(ve.name).extension)),Y=se(""),re=se(void 0);function Fe(pe){if(pe.key!=="ArrowLeft"&&pe.key!=="ArrowRight"&&pe.key!=="ArrowUp"&&pe.key!=="ArrowDown")if(pe.key==="Enter")if(pe.preventDefault(),e(Y).trim()&&e(Y)!==e(Ce)){const Le=e(Y).trim()+e(T);ve.onrename?.({oldName:ve.name,newName:Le})}else ve.oncancelRename?.();else pe.key==="Escape"&&(pe.preventDefault(),pe.stopPropagation(),ve.oncancelRename?.());else pe.stopPropagation()}function Te(){ve.oncancelRename?.()}$t((()=>{s(Y,e(Ce),!0)})),$t((()=>{A()&&e(re)&&setTimeout((()=>{e(re)?.focus(),e(re)?.select()}),0)}));var Oe=fs();let he;var be=r(Oe),je=pe=>{var Le=vs(),Ue=r(Le);Ze(Ue,(()=>ve.icon)),t(pe,Le)};p(be,(pe=>{ve.icon&&pe(je)}));var rt=u(be,2),st=r(rt),qe=pe=>{var Le=ps();Le.__click=ze=>ze.stopPropagation(),Le.__mousedown=ze=>ze.stopPropagation();var Ue=r(Le),Xe=r(Ue);Vt(Xe,{size:1,variant:"surface",onkeydown:Fe,onblur:Te,get value(){return e(Y)},set value(ze){s(Y,ze,!0)},get textInput(){return e(re)},set textInput(ze){s(re,ze,!0)}});var Qe=u(Xe,2),tt=ze=>{var nt=hs(),lt=r(nt);Re((()=>Be(lt,e(T)))),t(ze,nt)};p(Qe,(ze=>{e(T)&&ze(tt)})),t(pe,Le)},Ke=pe=>{var Le=ms(),Ue=m(Le),Xe=r(Ue),Qe=u(Ue,2),tt=ze=>{var nt=gs(),lt=r(nt);Re((()=>Be(lt,ve.path))),t(ze,nt)};p(Qe,(ze=>{O()&&ze(tt)})),Re((()=>Be(Xe,ve.name))),t(pe,Le)};p(st,(pe=>{A()?pe(qe):pe(Ke,!1)}));var We=u(rt,2),Ye=r(We),Je=pe=>{var Le=H(),Ue=m(Le);Ze(Ue,(()=>ve.children)),t(pe,Le)};p(Ye,(pe=>{ve.children&&pe(Je)})),Re((()=>he=Nt(Oe,1,"c-setup-script-selector__script-item-content svelte-1fvykqe",null,he,{"c-setup-script-selector__script-item-content--renaming":A(),"c-setup-script-selector__script-item-content--is-path":ke()}))),t(Se,Oe),ct()})(Pe,{get name(){return ae().name},get path(){return ae().path},isPath:!0,showPath:!1,get isRenaming(){return e(Ee)},onrename:Se=>(async function(ve,ke){const{oldName:A,newName:O}=ke;try{const ce=await w.renameSetupScript(A,O,ve.location);if(ce.success){await C();const Ce=e(G).find((T=>T.path===ce.path));Ce&&S(Ce)}else console.error("Failed to rename script:",ce.error),z(`Failed to rename script: ${ce.error||"Unknown error"}`)}catch(ce){console.error("Error renaming script:",ce),z(`Error renaming script: ${ce instanceof Error?ce.message:String(ce)}`)}finally{F()}})(ae(),Se),oncancelRename:F,children:(Se,ve)=>{var ke=$s(),A=m(ke);ot(A,{content:"Open script in editor",nested:!1,children:(Ce,T)=>{kt(Ce,{size:1,variant:"ghost-block",class:"c-setup-script-selector__action-button",onclick:Y=>{Y.stopPropagation(),de(ae()),S(ae())},children:(Y,re)=>{ye(Y,{name:"external-link"})},$$slots:{default:!0}})},$$slots:{default:!0}});var O=u(A,2);ot(O,{content:"Rename script",nested:!1,children:(Ce,T)=>{kt(Ce,{size:1,variant:"ghost-block",class:"c-setup-script-selector__action-button",onclick:Y=>{Y.stopPropagation(),(async function(re,Fe){s(Ae,re,!0)})(ae())},children:(Y,re)=>{ye(Y,{name:"pen"})},$$slots:{default:!0}})},$$slots:{default:!0}});var ce=u(O,2);ot(ce,{content:"Delete script",nested:!1,children:(Ce,T)=>{kt(Ce,{variant:"ghost-block",class:"c-setup-script-selector__action-button",onclick:Y=>{Y.stopPropagation(),(async function(re,Fe){try{const Te=await w.deleteSetupScript(re.name,re.location);Te.success?(e(U)?.path===re.path&&S(null),await C()):(console.error("Failed to delete script:",Te.error),z(`Failed to delete script: ${Te.error||"Unknown error"}`))}catch(Te){console.error("Error deleting script:",Te),z(`Error deleting script: ${Te instanceof Error?Te.message:String(Te)}`)}})(ae())},children:(Y,re)=>{ye(Y,{name:"trash-2"})},$$slots:{default:!0}})},$$slots:{default:!0}}),t(Se,ke)},$$slots:{default:!0}})}};p(_e,(Pe=>{ae()&&Pe(we)})),t(_,$e)};Jt(r(h),{placeholder:"Search scripts...",get isLoading(){return y()},disabled:!1,get actions(){return e(L)},actionLabelFn:_=>_?.name||"",get items(){return e(oe)},get selectedItem(){return e(U)},itemTitle:"Available scripts",itemLabelFn:_=>_?.name||"",itemKeyFn:_=>`${_?.path}-${_?.location}-${_?.name}`,isItemSelected:(_,Q)=>_===null&&Q===null||!(!_||!Q)&&_.path===Q.path,noItemsLabel:"No scripts found",loadingLabel:"Loading scripts...",onopenChange:q,onsearch:V,onselect:D,onaction:j,get searchValue(){return e(ge)},set searchValue(_){s(ge,_,!0)},titleSnippet:i,icon:$,searchIcon:B,action:W,item:l,$$slots:{titleSnippet:!0,icon:!0,searchIcon:!0,action:!0,item:!0}})}t(v,c)};p(fe,(v=>{e(E)&&g()!==I.noScriptsFound||v(te)}));var N=u(fe,2),b=v=>{var c=ys(),h=r(c);Ot(h,{color:"warning",variant:"soft",size:2,children:(i,$)=>{var B=bs(),W=r(B),l=r(W),_=u(W,2);dt(_,{variant:"ghost",color:"warning",size:1,onclick:C,get loading(){return y()},iconLeft:ae=>{ye(ae,{name:"refresh-ccw"})},children:(ae,$e)=>{var _e=X("Refresh");t(ae,_e)},$$slots:{iconLeft:!0,default:!0}}),Re((()=>Be(l,g()))),t(i,B)},$$slots:{default:!0}}),t(v,c)};p(N,(v=>{e(E)&&g()!==I.noScriptsFound&&v(b)})),t(De,P),ct(),x()}var Ss=d('<div class="agent-limit-message svelte-14aml4z"><p class="svelte-14aml4z"> </p> <!></div>');function ks(De,n){it(n,!0);const a=()=>Ge(y,"$remoteAgentsModel",f),[f,x]=mt();let g=le(n,"agentLimitErrorMessage",15);const y=ut(wt.key);let M=se(!1),ie=se(void 0),w=se(void 0),ee=se(void 0),de=se(void 0),G=se(void 0),ge=o((()=>!!a().maxRemoteAgents&&a().agentOverviews.length>=a().maxRemoteAgents)),Ae=o((()=>!!a().maxActiveRemoteAgents&&a().agentOverviews.filter((I=>I.workspace_status===fn.workspaceRunning)).length>=a().maxActiveRemoteAgents));function xe(){return[...a().agentOverviews].sort(((I,C)=>new Date(I.started_at).getTime()-new Date(C.started_at).getTime()))}function k(I){return I?.remote_agent_id}function U(I){if(!I)return;const C=I.is_setup_script_agent?"Setup script generation":I.session_summary||"";return C.length>30?C.substring(0,27)+"...":C}function Z(I,C){return I.replace("%MAX_AGENTS%",C.toString())}$t((()=>{if(e(ge)){const I=xe()[0];s(ie,k(I),!0),s(w,U(I),!0),g(Z(sn,a().maxRemoteAgents)),s(G,"Delete Oldest Agent"+(e(w)?`: ${e(w)}`:""))}else if(e(Ae)){const I=xe().filter((C=>C.workspace_status===fn.workspaceRunning))[0];s(ee,k(I),!0),s(de,U(I),!0),g(Z(on,a().maxActiveRemoteAgents)),s(G,"Pause Oldest Agent"+(e(de)?`: ${e(de)}`:""))}else s(ie,void 0),s(w,void 0),s(ee,void 0),s(de,void 0),g(void 0)}));var E=H(),L=m(E),oe=I=>{Ot(I,{color:"info",variant:"soft",size:2,icon:F=>{ye(F,{name:"circle-alert"})},children:(F,z)=>{var V=Ss(),D=r(V),j=r(D),q=u(D,2);dt(q,{variant:"soft",color:"neutral",size:1,onclick:()=>{e(Ae)?(async function(){if(!e(M)&&e(ee))try{s(M,!0),await y.pauseRemoteAgentWorkspace(e(ee))}catch(R){console.error("Failed to pause oldest active agent:",R)}finally{s(M,!1)}})():(async function(){if(!e(M)&&e(ie))try{s(M,!0),await y.deleteAgent(e(ie))}catch(R){console.error("Failed to delete oldest agent:",R)}finally{s(M,!1)}})()},iconLeft:R=>{var K=H(),J=m(K),ue=P=>{ye(P,{name:"pause"})},me=P=>{ye(P,{name:"trash-2"})};p(J,(P=>{e(Ae)?P(ue):P(me,!1)})),t(R,K)},children:(R,K)=>{var J=X();Re((()=>Be(J,e(G)))),t(R,J)},$$slots:{iconLeft:!0,default:!0}}),Re((S=>Be(j,S)),[()=>(e(ge)?sn:on).replace("%MAX_AGENTS%",(e(ge)?a().maxRemoteAgents:a().maxActiveRemoteAgents).toString())]),t(F,V)},$$slots:{icon:!0,default:!0}})};p(L,(I=>{g()&&I(oe)})),t(De,E),ct(),x()}var Cs=d('<div class="error-message svelte-1r7cchd"><!></div>'),Ls=d('<div class="remote-agent-setup svelte-1r7cchd"><div class="content svelte-1r7cchd"><div class="form-fields"><div class="error-message svelte-1r7cchd"><!></div> <!> <div class="commit-ref-selector svelte-1r7cchd"><!></div> <div class="setup-script svelte-1r7cchd"><!> <!></div></div></div></div>'),xs=d("<!> Start Generating Setup Script",1),Is=d("<!> <!> <!>",1),Ds=d("<!> <!> <!> <!> <!> <!>",1),Ps=d("<!> <!>",1);function Bs(De,n){it(n,!0);const a=()=>Ge(ge,"$agentIdCopyTextMap",x),f=()=>Ge(Ae,"$shareLinkCopyTextMap",x),[x,g]=mt();let y=le(n,"selectedBranch",19,(()=>{})),M=le(n,"isPinned",3,!1),ie=le(n,"togglePinned",19,(()=>{})),w=le(n,"enableRename",3,!1),ee=le(n,"isEditing",15,!1),de=le(n,"onDelete",19,(()=>{})),G=se(void 0);const ge=_t(new Map),Ae=_t(new Map),xe=ut(wt.key);var k=H(),U=m(k);Ie(U,(()=>He.Root),((Z,E)=>{St(E(Z,{nested:!1,children:(L,oe)=>{var I=Ps(),C=m(I);Ie(C,(()=>He.Trigger),((z,V)=>{V(z,{children:(D,j)=>{kt(D,{variant:"ghost-block",color:"neutral",size:1,title:"Agent options",children:(q,S)=>{ye(q,{name:"ellipsis"})},$$slots:{default:!0}})},$$slots:{default:!0}})}));var F=u(C,2);Ie(F,(()=>He.Content),((z,V)=>{V(z,{size:1,side:"bottom",align:"end",children:(D,j)=>{var q=Ds(),S=m(q),R=N=>{var b=H(),v=m(b);{const c=h=>{ye(h,{name:"square-pen"})};Ie(v,(()=>He.Item),((h,i)=>{i(h,{onSelect:()=>{setTimeout((()=>{ee(!0)}),20)},iconLeft:c,children:($,B)=>{var W=X("Rename");t($,W)},$$slots:{iconLeft:!0,default:!0}})}))}t(N,b)};p(S,(N=>{w()&&N(R)}));var K=u(S,2),J=N=>{var b=H(),v=m(b);{const c=h=>{ye(h,{name:"pin",class:"pin-icon"})};Ie(v,(()=>He.Item),((h,i)=>{i(h,{title:"Pin or unpin agent",onSelect:()=>{ie()()},iconLeft:c,children:($,B)=>{var W=X();Re((()=>Be(W,M()?"Unpin":"Pin"))),t($,W)},$$slots:{iconLeft:!0,default:!0}})}))}t(N,b)};p(K,(N=>{ie()&&N(J)}));var ue=u(K,2);{const N=b=>{ye(b,{name:"copy"})};Ie(ue,(()=>He.Item),((b,v)=>{v(b,{onSelect:()=>{navigator.clipboard.writeText(n.agentId),ge.update((c=>(c.set(n.agentId,"Copied!"),c))),setTimeout((()=>{ge.update((c=>(c.delete(n.agentId),c)))}),1e3)},iconLeft:N,children:(c,h)=>{var i=H(),$=m(i),B=l=>{var _=X();Re((Q=>Be(_,Q)),[()=>a().get(n.agentId)]),t(l,_)},W=l=>{var _=X("Copy ID");t(l,_)};p($,(l=>{a().get(n.agentId)?l(B):l(W,!1)})),t(c,i)},$$slots:{iconLeft:!0,default:!0}})}))}var me=u(ue,2);{const N=b=>{ye(b,{name:"share-2"})};Ie(me,(()=>He.Item),((b,v)=>{v(b,{onSelect:()=>{(async function(){try{const c=await xe?.getConversationUrl(n.agentId);c&&navigator.clipboard.writeText(c),Ae.update((h=>(h.set(n.agentId,"Link copied!"),h))),setTimeout((()=>{Ae.update((h=>(h.delete(n.agentId),h)))}),1e3)}catch(c){console.error("Failed to get conversation URL: ",c)}})(),e(G)?.requestClose()},iconLeft:N,children:(c,h)=>{var i=H(),$=m(i),B=l=>{var _=X();Re((Q=>Be(_,Q)),[()=>f().get(n.agentId)]),t(l,_)},W=l=>{var _=X("Share");t(l,_)};p($,(l=>{f().get(n.agentId)?l(B):l(W,!1)})),t(c,i)},$$slots:{iconLeft:!0,default:!0}})}))}var P=u(me,2),ne=N=>{var b=H(),v=m(b);{const c=h=>{ye(h,{name:"trash-2"})};Ie(v,(()=>He.Item),((h,i)=>{i(h,{color:"error",onSelect:()=>{de()?.()},iconLeft:c,children:($,B)=>{var W=X("Delete");t($,W)},$$slots:{iconLeft:!0,default:!0}})}))}t(N,b)};p(P,(N=>{de()&&N(ne)}));var fe=u(P,2),te=N=>{var b=Is(),v=m(b);Ie(v,(()=>He.Separator),((i,$)=>{$(i,{})}));var c=u(v,2);Ie(c,(()=>He.Label),((i,$)=>{$(i,{children:(B,W)=>{var l=X("Branch");t(B,l)},$$slots:{default:!0}})}));var h=u(c,2);Ie(h,(()=>He.Item),((i,$)=>{$(i,{disabled:!0,children:(B,W)=>{var l=X();Re((()=>Be(l,y()))),t(B,l)},$$slots:{default:!0}})})),t(N,b)};p(fe,(N=>{y()&&N(te)})),t(D,q)},$$slots:{default:!0}})})),t(L,I)},$$slots:{default:!0}}),(L=>s(G,L,!0)),(()=>e(G)))})),t(De,k),ct(),g()}var Es=d('<div class="c-thread-header__banner svelte-4g48lc"><!></div>'),Fs=d('<div class="c-thread-header__title-notice"><!></div>'),zs=d('<div class="c-thread-header__info-row svelte-4g48lc"><!></div>'),Ms=d('<div class="c-thread-header__status svelte-4g48lc"><!></div>'),Ns=d('<div class="c-thread-header svelte-4g48lc"><!> <!> <!> <!></div>');const Ts=De=>{var n=js(),a=r(n);Ne(a,{size:1,weight:"medium",children:(f,x)=>{var g=qs();t(f,g)},$$slots:{default:!0}}),t(De,n)};var Us=d('<div class="c-agent-header-banner__with-icon svelte-i2xeo6"><!> <div class="c-agent-header-banner__stack svelte-i2xeo6"><div class="c-agent-header-banner__text svelte-i2xeo6">Running in the cloud</div> <div class="c-agent-header-banner__text c-agent-header-banner__text--secondary svelte-i2xeo6">Workspace opened via SSH in this VSCode window</div></div></div>'),Hs=d('<span class="c-agent-header-banner__text svelte-i2xeo6"><div class="c-setup-script-badge svelte-i2xeo6"><!></div> Generate a setup script</span>'),Os=d('<div class="c-agent-header__actions svelte-i2xeo6"><!></div>'),Gs=d('<div class="c-agent-header__banner svelte-i2xeo6"><!> <!></div>'),qs=d(`We've tasked an agent to generate a setup script for your repository.<span class="c-agent-title-content__long-text-alternative svelte-i2xeo6">..</span> <span class="c-agent-title-content__long-text svelte-i2xeo6">Once created, save it to use in a new remote agent, to install dependencies & configure the
        env before the agent starts.</span>`,1),js=d('<div class="c-agent-title-content svelte-i2xeo6"><!></div>'),Ws=d('<div class="c-agent-info-row svelte-i2xeo6"><!> <!></div>'),Vs=d("<div><!></div>");function Ks(De,n){it(n,!0);const a=()=>Ge(M,"$remoteAgentsModel",f),[f,x]=mt(),g=C=>{var F=Gs(),z=r(F),V=S=>{var R=Us(),K=r(R);ye(K,{name:"cloud-upload",size:2}),t(S,R)},D=S=>{var R=H(),K=m(R),J=ue=>{var me=Hs(),P=r(me),ne=r(P);ye(ne,{name:"square-terminal",size:2}),t(ue,me)};p(K,(ue=>{e(G)&&ue(J)}),!0),t(S,R)};p(z,(S=>{e(Ae)?S(V):S(D,!1)}));var j=u(z,2),q=S=>{var R=Os();Bs(r(R),{get agentId(){return e(w)},get selectedBranch(){return e(U)},get isPinned(){return e(ge)},togglePinned:xe,onDelete:k}),t(S,R)};p(j,(S=>{e(w)&&e(Z)&&S(q)})),t(C,F)},y=C=>{var F=Ws(),z=r(F);Ta(z,{get repoUrl(){return e(ee)},get repoName(){return e(de)}});var V=u(z,2),D=j=>{Ua(j,{get repoUrl(){return e(ee)},get branchName(){return e(U)}})};p(V,(j=>{e(U)&&j(D)})),t(C,F)},M=ut(wt.key),ie=o((()=>a()?.currentAgent)),w=o((()=>e(ie)?.remote_agent_id)),ee=o((()=>e(ie)?.workspace_setup?.starting_files?.github_commit_ref?.repository_url||"")),de=o((()=>Ia(e(ee)))),G=o((()=>e(ie)?.is_setup_script_agent)),ge=o((()=>e(w)&&a()?.pinnedAgents[e(w)]||!1)),Ae=o((()=>a()?.isRemoteAgentSshWindow));function xe(){e(w)&&M?.toggleAgentPinned(e(w),e(ge))}const k=async()=>{!e(w)||!M||await M?.deleteAgent(e(w))&&M.setCurrentAgent(void 0)},U=o((()=>e(ie)?.workspace_setup?.starting_files?.github_commit_ref?.git_ref)),Z=o((()=>e(Ae)||e(G))),E=o((()=>e(w)&&e(Z)));var L=H(),oe=m(L),I=C=>{var F=Vs();let z;var V=r(F);{let D=o((()=>e(Z)||e(E)?g:void 0)),j=o((()=>e(G)?Ts:void 0));(function(q,S){const R=le(S,"isSquished",3,!1);var K=Ns(),J=r(K),ue=b=>{var v=Es(),c=r(v);Ze(c,(()=>S.banner)),t(b,v)};p(J,(b=>{S.banner&&b(ue)}));var me=u(J,2),P=b=>{var v=Fs(),c=r(v);Ze(c,(()=>S.titleNotice)),t(b,v)};p(me,(b=>{S.titleNotice&&b(P)}));var ne=u(me,2),fe=b=>{var v=zs(),c=r(v);Ze(c,(()=>S.infoRow)),t(b,v)};p(ne,(b=>{!R()&&S.infoRow&&b(fe)}));var te=u(ne,2),N=b=>{var v=Ms(),c=r(v);Ze(c,(()=>S.status)),t(b,v)};p(te,(b=>{S.status&&b(N)})),t(q,K)})(V,{get banner(){return e(D)},get titleNotice(){return e(j)},get infoRow(){return y}})}Re((()=>z=Nt(F,1,"c-agent-header svelte-i2xeo6",null,z,{"c-agent-header--setup-script":e(G),"c-agent-header--is-in-remote":e(Ae)}))),t(C,F)};p(oe,(C=>{e(ie)&&C(I)})),t(De,L),ct(),x()}var Js=d('<!> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Xs=d('<div class="l-input-area-agent-setup l-input-area-design-system svelte-17wmks3"><!></div>'),Qs=d("<!> <!>",1),Zs=d("<!> <!>",1),Ys=d("<!> <!> <!> <!>",1);function Qo(De,n){it(n,!0);const a=()=>Ge(g,"$remoteAgentsModel",f),[f,x]=mt(),g=ut(wt.key);let y=o((()=>a().isActive&&!a().currentAgentId)),M=o((()=>!e(y))),ie=o((()=>a().currentAgentId)),w=o((()=>a().getCurrentChatHistory()?.length)),ee=o((()=>a().agentSetupLogs?.steps.length!==0)),de=o((()=>zn(!e(w)&&!e(ee)))),G=o((()=>`remote-${e(ie)}`));const ge=o((()=>a().isActive&&a().currentAgent&&!a().currentAgent?.is_setup_script_agent)),Ae=Ht(),xe=o((()=>a().isCreatingAgent||a().isActive&&a().currentAgent?.status===gt.agentStarting)),k=o((()=>e(xe)?"Remote Agent is starting":a().isActive?a().currentAgentId?"Ask Remote Agent to edit code, run tests, create a pull request":"Fix this bug, tackle this ticket, review comments in my pull request":void 0));let U=se(void 0);var Z=Ys(),E=m(Z),L=D=>{Dt(D,{get target(){return`#${aa}`},children:(j,q)=>{Ks(j,{})},$$slots:{default:!0}})};p(E,(D=>{a()?.isActive&&D(L)}));var oe=u(E,2),I=D=>{Dt(D,{get target(){return`#${jt.inputHint}`},children:(j,q)=>{var S=Js(),R=m(S);Ne(R,{size:1,class:"c-chat-input-hint",children:(J,ue)=>{var me=X(`Kick off a remote agent to work in parallel, in an isolated environment that will keep
      running, even when you shut off your computer.`);t(J,me)},$$slots:{default:!0}});var K=u(R,2);Un(K,(()=>({"--text-color":"var(--ds-color-accent-a11)"}))),Ne(K.lastChild,{size:1,class:"c-chat-open-secret-manager",onclick:J=>{J.preventDefault(),Ae.openSettingsPage("secret-manager")},children:(J,ue)=>{var me=X("Need secrets to do the work? Configure them here.");t(J,me)},$$slots:{default:!0}}),t(j,S)},$$slots:{default:!0}})};p(oe,(D=>{e(y)&&D(I)}));var C=u(oe,2),F=D=>{var j=H(),q=m(j);Sn(q,(()=>e(G)),(S=>{var R=H(),K=m(R),J=ue=>{ra(ue,{})};p(K,(ue=>{Ge(e(de),"$isEmptyConversation",f)||ue(J)})),t(S,R)})),t(D,j)};p(C,(D=>{e(M)&&D(F)}));var z=u(C,2),V=D=>{var j=Zs(),q=m(j);Dt(q,{get target(){return`#${jt.divider}`},children:(R,K)=>{sa(R,{get inputArea(){return e(U)},set inputArea(J){s(U,J,!0)}})},$$slots:{default:!0}});var S=u(q,2);Dt(S,{get target(){return`#${jt.input}`},children:(R,K)=>{var J=Qs(),ue=m(J),me=te=>{ur(te,{})};p(ue,(te=>{e(ge)&&te(me)}));var P=u(ue,2),ne=te=>{yn(te,{editable:!0,hasSendButton:!0,get placeholder(){return e(k)},banner:b=>{Pr(b,{})},$$slots:{banner:!0}})},fe=te=>{var N=Xs();{const b=c=>{(function(h,i){it(i,!0);const $=()=>Ge(l,"$remoteAgentsModel",B),[B,W]=mt(),l=ut(wt.key),_=ut(Ut.key);let Q=o((()=>$().newAgentDraft?.commitRef??null)),ae=o((()=>$().newAgentDraft?.selectedBranch??null)),$e=se(""),_e=se(!1),we=se(void 0),Pe=se(null),Ee=se(null),Se=se(null),ve=o((()=>{const he=e(Q)?.github_commit_ref?.repository_url,be=e(ae)?.name,je=!e(_e)&&he&&be;return e($e)||e(we)||(e(_e)?"Loading repos and branches...":"")||!he&&"Please select a repository"||!be&&"Please select a branch"||(!je&&he&&be?"Loading branch data...":"")||""})),ke=o((()=>!!e(ve)));It((async()=>{try{const he=await l.getLastRemoteAgentSetup();s(Pe,he.lastRemoteAgentGitRepoUrl,!0),s(Ee,he.lastRemoteAgentGitBranch,!0),s(Se,he.lastRemoteAgentSetupScript,!0),l.setHasEverUsedRemoteAgent(!0),await l.reportRemoteAgentEvent({eventName:xn.setupPageOpened,remoteAgentId:"",eventData:{setupPageOpened:{}}}),await l.reportRemoteAgentSetupWindowEvent(At.open)}catch(he){console.error("Failed to load last remote agent setup:",he)}})),$t((()=>{const he=$().newAgentDraft;he&&he.isDisabled!==e(ke)&&l.setNewAgentDraft({...he,isDisabled:e(ke)})})),Tt((async()=>{try{await l.reportRemoteAgentSetupWindowEvent(At.close)}catch(he){console.error("Failed to report remote agent setup window close event:",he)}l.setNewAgentDraft(null),l.setCreationMetrics(void 0)}));var A=Ls(),O=r(A),ce=r(O),Ce=r(ce);ks(r(Ce),{get agentLimitErrorMessage(){return e(we)},set agentLimitErrorMessage(he){s(we,he,!0)}});var T=u(Ce,2),Y=he=>{var be=Cs(),je=r(be);Ot(je,{color:"error",variant:"soft",size:2,children:(rt,st)=>{var qe=X();Re((()=>Be(qe,$().remoteAgentCreationError))),t(rt,qe)},$$slots:{default:!0}}),Ft(3,be,(()=>cn),(()=>({y:10}))),t(he,be)};p(T,(he=>{$().remoteAgentCreationError&&he(Y)}));var re=u(T,2);us(r(re),{get gitRefModel(){return _},oncommitRefChange:function(he){l.setRemoteAgentCreationError(null);const be=l.newAgentDraft;be?l.setNewAgentDraft({...be,commitRef:he.commitRef,selectedBranch:he.selectedBranch,isDisabled:e(ke)}):l.setNewAgentDraft({commitRef:he.commitRef,selectedBranch:he.selectedBranch,setupScript:null,isDisabled:e(ke),enableNotification:!0})},get lastUsedRepoUrl(){return e(Pe)},get lastUsedBranchName(){return e(Ee)},onSelectedRepo:async function(){const he=l.creationMetrics;l.setCreationMetrics({changedRepo:!0,changedBranch:he?.changedBranch??!1});try{await l.reportRemoteAgentSetupWindowEvent(At.selectRepo)}catch(be){console.error("Failed to report repo selection event:",be)}},onSelectedBranch:async function(){const he=l.creationMetrics;l.setCreationMetrics({changedRepo:he?.changedRepo??!1,changedBranch:!0});try{await l.reportRemoteAgentSetupWindowEvent(At.selectBranch)}catch(be){console.error("Failed to report branch selection event:",be)}},get errorMessage(){return e($e)},set errorMessage(he){s($e,he,!0)},get isLoading(){return e(_e)},set isLoading(he){s(_e,he,!0)}});var Fe=u(re,2),Te=r(Fe);As(Te,{onsetupScriptChange:function(he){l.setRemoteAgentCreationError(null);const be=l.newAgentDraft;be?l.setNewAgentDraft({...be,setupScript:he.script,isDisabled:e(ke)}):l.setNewAgentDraft({commitRef:null,selectedBranch:null,setupScript:he.script,isDisabled:e(ke),enableNotification:!0})},get lastUsedScriptPath(){return e(Se)}});var Oe=u(Te,2);Ra(Oe,{size:4}),Ft(3,Ce,(()=>cn),(()=>({y:10}))),t(h,A),ct(),W()})(c,{})},v=c=>{(function(h,i){it(i,!0);let $=se(!1);dt(h,{size:1,variant:"solid",color:"accent",onclick:async()=>{s($,!0);try{try{await i.remoteAgentsModel.reportRemoteAgentSetupWindowEvent(At.autoGenerateSetupScript)}catch(l){console.error("Failed to auto-generate setup script event:",l)}const B=i.remoteAgentsModel.newAgentDraft;B&&i.remoteAgentsModel.setNewAgentDraft({...B,isSetupScriptAgent:!0});const W=await i.remoteAgentsModel.createRemoteAgentFromDraft("SETUP_MODE");W&&i.remoteAgentsModel.setCurrentAgent(W)}catch(B){console.error("Failed to select setup script generation:",B)}finally{s($,!1)}},get loading(){return e($)},children:(B,W)=>{var l=xs(),_=m(l);ye(_,{name:"wand-sparkles"}),t(B,l)},$$slots:{default:!0}}),ct()})(c,{get remoteAgentsModel(){return g}})};yn(r(N),{editable:!0,hasSendButton:!0,get placeholder(){return e(k)},banner:b,activeButton:v,$$slots:{banner:!0,activeButton:!0}})}St(N,(b=>s(U,b)),(()=>e(U))),t(te,N)};p(P,(te=>{a().currentAgent?.is_setup_script_agent&&a().currentConversation?te(ne):te(fe,!1)})),t(R,J)},$$slots:{default:!0}}),t(D,j)};p(z,(D=>{a().isActive&&D(V)})),t(De,Z),ct(),x()}export{Qo as default};
//# sourceMappingURL=RemoteMessageSection-BUoObpWa.js.map
