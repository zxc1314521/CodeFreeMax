import{D as te,E as g,$ as h,a5 as ne,k as A,o as l,a0 as a,a6 as oe,K as ie,T as se,V as I,X as _,P as f,Q as m,Z as ae,O as H,R as D,H as de,Y as R,a1 as re,a2 as le}from"./debounce-BNOmQ76Y.js";import"./IconButtonAugment-DO0xxfgT.js";import{M as ce}from"./index-Ba8SPQX6.js";import{S as ue}from"./SimpleMonaco-BBDXOnfl.js";import{T as B}from"./Icon-CohttyM7.js";import{D as W}from"./OpenFileButton-gT822Pcb.js";try{u=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(z=new u.Error().stack)&&(u._sentryDebugIds=u._sentryDebugIds||{},u._sentryDebugIds[z]="77e6c829-82d9-4496-aab1-49bddd45de6c",u._sentryDebugIdIdentifier="sentry-dbid-77e6c829-82d9-4496-aab1-49bddd45de6c")}catch{}var u,z,ge=ie('<div class="l-markdown-editor svelte-6764n4"><div class="c-markdown-editor__header svelte-6764n4"><!></div> <!> <div class="c-markdown-editor__content svelte-6764n4"><!> <div class="c-monaco-editor svelte-6764n4"><!></div></div></div> <div class="c-markdown-editor__status svelte-6764n4"><!> <!></div>',1);function we(T,s){te(s,!0);let d=g(s,"value",15,""),C=g(s,"selectedText",15,""),E=g(s,"selectionStart",15,0),M=g(s,"selectionEnd",15,0),F=g(s,"monacoOptions",19,(()=>({}))),t=g(s,"editorInstance",15),r=h(ne(d())),v=!1;const G={readOnly:!1,wordWrap:"on",lineNumbers:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1,automaticLayout:!0,theme:"vs-dark",language:"markdown",fontSize:W.fontSize,lineHeight:W.lineHeight,padding:{top:16,bottom:16},...F()};let p,b,w,y=h(!1),L=h(!1),k=h(void 0);const S=async()=>{t()&&await(async()=>{if(l(y))try{if(t()){const e=t().getValue();a(r,e,!0),d(e)}s.saveFunction(),a(y,!1),a(L,!0),clearTimeout(p),p=setTimeout((()=>{a(L,!1)}),1500)}catch(e){a(k,e instanceof Error?e.message:String(e),!0)}})()},K=()=>{if(!t()||v)return;const e=t().getValue();e!==l(r)&&(a(r,e,!0),d(e),a(y,!0))},Q=()=>{if(!t())return;let e,o,i;e=t().onDidChangeModelContent(K),i=t().onDidBlurEditorWidget((()=>{S()})),o=t().addAction({id:"save-markdown-content",label:"Save Markdown Content",keybindings:[2097],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:()=>{S()}}),(()=>{if(typeof window>"u")return;const n=()=>{S()};window.addEventListener("blur",n),w=()=>{window.removeEventListener("blur",n)}})(),b=()=>{e?.dispose(),o?.dispose(),i?.dispose(),w?.()}};A((()=>{if(d()!==l(r))if(t()){if(!v){v=!0;const e=t().getPosition(),o=t().getSelection(),i=t().getModel();if(i&&i.getValue()!==d()){if(i.setValue(d()),a(r,d(),!0),e&&i.getLineCount()>=e.lineNumber){const n=i.getLineLength(e.lineNumber);e.column<=n+1&&t().setPosition(e)}if(o&&i.getLineCount()>=o.endLineNumber){const n=i.getLineLength(o.endLineNumber);o.endColumn<=n+1&&t().setSelection(o)}}setTimeout((()=>{v=!1}),10)}}else a(r,d(),!0)})),A((()=>{if(t()){Q();const e=t(),o=e.onDidChangeCursorSelection((()=>{const n=e.getSelection();if(n){const c=e.getModel();c&&(E(c.getOffsetAt(n.getStartPosition())),M(c.getOffsetAt(n.getEndPosition())),E()!==M()?C(c.getValueInRange(n)):C(""))}})),i=b;b=()=>{i?.(),o?.dispose()}}})),oe((()=>{clearTimeout(p),b?.(),w?.()}));var $=ge(),O=se($),V=f(O),X=f(V);I(X,(()=>s.header??_));var x=m(V,2);I(x,(()=>s.children??_));var Y=m(x,2),N=f(Y);I(N,(()=>s.title??_));var Z=m(N,2),j=f(Z);ae(j,(()=>ce.Root),((e,o)=>{o(e,{children:(i,n)=>{ue(i,{get text(){return l(r)},lang:"markdown",get options(){return G},height:void 0,get editorInstance(){return t()},set editorInstance(c){t(c)}})},$$slots:{default:!0}})}));var q=m(O,2),P=f(q),J=e=>{B(e,{size:1,weight:"light",color:"error",children:(o,i)=>{var n=R();re((()=>le(n,l(k)))),D(o,n)},$$slots:{default:!0}})};H(P,(e=>{l(k)&&e(J)}));var U=m(P,2),ee=e=>{B(e,{size:1,weight:"light",color:"success",children:(o,i)=>{var n=R("Saved");D(o,n)},$$slots:{default:!0}})};H(U,(e=>{l(L)&&e(ee)})),D(T,$),de()}export{we as M};
//# sourceMappingURL=MonacoMarkdownEditor-DPJhsvvf.js.map
