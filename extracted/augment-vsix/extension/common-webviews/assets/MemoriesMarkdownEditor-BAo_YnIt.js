import{D as Te,E as Ie,ai as Re,J as W,$ as y,a5 as Oe,ae as ke,W as Ae,a0 as o,S as se,T as _,O as ne,o as e,R as a,H as Ge,I as Pe,G as h,Z as D,_ as Ne,K as k,Y as Q,a1 as Se,a2 as Ce,Q as V,a3 as Be,P as b}from"./debounce-BNOmQ76Y.js";import{M as He}from"./MonacoMarkdownEditor-DPJhsvvf.js";import{I as O,T as Ee}from"./Icon-CohttyM7.js";import{i as ae,E as Ue,D as F,a as We,b as Qe,o as Ve,M as ge,c as Ye,s as Ze}from"./extension-client-context-CN64fWtK.js";import{S as qe}from"./SuccessfulButton-BTRD1tJd.js";import{O as Je}from"./OpenFileButton-gT822Pcb.js";import{F as Ke}from"./Filespan-FcScXFRk.js";import{M as Xe}from"./message-broker-DUQuEFlt.js";import{T as xe,a as Me}from"./TextTooltipAugment-CGvqFHAr.js";import{B as ze}from"./ButtonAugment-BCcs6kST.js";try{L=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(we=new L.Error().stack)&&(L._sentryDebugIds=L._sentryDebugIds||{},L._sentryDebugIds[we]="b8cf4a33-34ec-4a30-93f6-5f9d26c49c62",L._sentryDebugIdIdentifier="sentry-dbid-b8cf4a33-34ec-4a30-93f6-5f9d26c49c62")}catch{}var L,we,je=k("<!> <!>",1),et=k('<div class="rules-dropdown-content svelte-16zpwc"><!> <!></div>'),tt=k("<!> <!>",1);function st(Y,r){Te(r,!0);const i=()=>W(e(s),"$focusedIndex",l),[l,u]=Pe();let A=Ie(r,"disabled",3,!1);const P=new Xe(Re),N=ae("enableRules"),Z=ae("enablePersonalities"),q=ae("enableExternalSourcesInChat"),J=ae("retryChatStreamTimeouts"),oe=new Ue(Re,P,{enableRules:W(N,"$enableRules",l),enablePersonalities:W(Z,"$enablePersonalities",l),enableExternalSourcesInChat:W(q,"$enableExternalSourcesInChat",l),retryChatStreamTimeouts:W(J,"$retryChatStreamTimeouts",l)});let v=y(Oe([])),x=y(!0),B=y(void 0),t=y(void 0),s=h((()=>e(t)?.focusedIndex));ke((()=>{(async function(){try{o(x,!0);const d=await oe.findRules("",100);o(v,d,!0)}catch(d){console.error("Failed to load rules:",d),o(v,[],!0)}finally{o(x,!1)}})();const n=d=>{d.data?.type===Ae.getRulesListResponse&&(o(v,d.data.data||[],!0),o(x,!1))};return window.addEventListener("message",n),()=>{window.removeEventListener("message",n)}}));let c=h((()=>e(v).length>0)),p=h((()=>A()||!e(c))),f=h((()=>e(c)?"Move highlighted text to a .augment/rules file":"Please add at least 1 file to .augment/rules and reload VSCode")),M=y(!1);function re(n){o(M,n,!0)}var K=se(),ie=_(K),le=n=>{var d=se(),$=_(d),z=w=>{var T=se(),m=_(T);D(m,(()=>F.Root),((he,pe)=>{Ne(pe(he,{onOpenChange:re,children:(X,I)=>{var de=tt(),j=_(de);D(j,(()=>F.Trigger),((ue,ce)=>{ce(ue,{children:(ve,_e)=>{{let ee=h((()=>[Me.Hover])),te=h((()=>!e(M)&&void 0));xe(ve,{get content(){return e(f)},get triggerOn(){return e(ee)},side:"top",get open(){return e(te)},children:(fe,$e)=>{ze(fe,{color:"neutral",variant:"soft",size:1,get disabled(){return e(p)},iconLeft:g=>{O(g,{name:"arrow-right"})},iconRight:g=>{O(g,{name:"chevron-down"})},children:(g,H)=>{var S=Q();Se((()=>Ce(S,e(B)?e(B).path:"Rules"))),a(g,S)},$$slots:{iconLeft:!0,iconRight:!0,default:!0}})},$$slots:{default:!0}})}},$$slots:{default:!0}})}));var Le=V(j,2);D(Le,(()=>F.Content),((ue,ce)=>{ce(ue,{side:"bottom",align:"start",children:(ve,_e)=>{var ee=et(),te=b(ee);Be(te,19,(()=>e(v)),(R=>R.path),((R,G,g)=>{var H=se(),S=_(H);{let U=h((()=>i()===e(g)));D(S,(()=>F.Item),((me,be)=>{be(me,{onSelect:()=>(function(E){o(B,E,!0),r.onRuleSelected(E),e(t)?.requestClose()})(e(G)),get highlight(){return e(U)},children:(E,De)=>{Ke(E,{get filepath(){return e(G).path}})},$$slots:{default:!0}})}))}a(R,H)}));var fe=V(te,2),$e=R=>{var G=je(),g=_(G);D(g,(()=>F.Separator),((S,U)=>{U(S,{})}));var H=V(g,2);D(H,(()=>F.Label),((S,U)=>{U(S,{children:(me,be)=>{Ee(me,{size:1,color:"neutral",children:(E,De)=>{var ye=Q();Se((Fe=>Ce(ye,Fe)),[()=>`Move to ${e(v)[i()].path}`]),a(E,ye)},$$slots:{default:!0}})},$$slots:{default:!0}})})),a(R,G)};ne(fe,(R=>{i()!==void 0&&e(v)[i()]&&R($e)})),a(ve,ee)},$$slots:{default:!0}})})),a(X,de)},$$slots:{default:!0}}),(X=>o(t,X,!0)),(()=>e(t)))})),a(w,T)},C=w=>{{let T=h((()=>[Me.Hover]));xe(w,{get content(){return e(f)},get triggerOn(){return e(T)},side:"top",children:(m,he)=>{ze(m,{color:"neutral",variant:"soft",size:1,disabled:!0,iconLeft:I=>{O(I,{name:"arrow-right"})},iconRight:I=>{O(I,{name:"chevron-down"})},children:(I,de)=>{var j=Q("Rules");a(I,j)},$$slots:{iconLeft:!0,iconRight:!0,default:!0}})},$$slots:{default:!0}})}};ne($,(w=>{e(c)?w(z):w(C,!1)})),a(n,d)};ne(ie,(n=>{e(x)||n(le)})),a(Y,K),Ge(),u()}var at=k('<div class="c-move-text-btn__left_icon svelte-1im2ez7"><!></div>'),nt=k('<div class="l-file-controls svelte-1im2ez7"><div class="l-file-controls-left svelte-1im2ez7"><div class="c-move-text-btn svelte-1im2ez7"><!></div> <div class="c-move-text-btn svelte-1im2ez7"><!></div></div> <div class="l-file-controls-right svelte-1im2ez7"><!></div></div>'),ot=k('<div class="l-memories-editor svelte-1im2ez7"><div class="c-memories-editor__content svelte-1im2ez7"><!></div></div>');function ht(Y,r){Te(r,!0);let i=Ie(r,"text",15);const l=We();let u=y(""),A=y(0),P=y(0),N=y("neutral");const Z=async()=>{r.path&&(r.onSaveFile?await r.onSaveFile(i()):l.saveFile({repoRoot:"",pathName:r.path,content:i()}))},q=Qe();async function J(t){if(!e(u))return;let s,c,p;const f=e(u).slice(0,20);if(t==="userGuidelines"?(s="Move Content to User Guidelines",c=`Are you sure you want to move the selected content "${f}" to your user guidelines?`,p=ge.userGuidelines):t==="augmentGuidelines"?(s="Move Content to Workspace Guidelines",c=`Are you sure you want to move the selected content "${f}" to workspace guidelines?`,p=ge.augmentGuidelines):(s="Move Content to Rule",c=`Are you sure you want to move the selected content "${f}" to rule file "${t.rule.path}"?`,p=ge.rules),!await l.openConfirmationModal({title:s,message:c,confirmButtonText:"Move",cancelButtonText:"Cancel"}))return;t==="userGuidelines"?l.updateUserGuidelines(e(u)):t==="augmentGuidelines"?l.updateWorkspaceGuidelines(e(u)):(q(Ze({type:t.rule.type,path:t.rule.path,content:t.rule.content+`

`+e(u),description:t.rule.description,settingsStored:t.rule.settingsStored})),l.showNotification({message:`Moved content "${f}" to rule file "${t.rule.path}"`,type:"info",openFileMessage:{repoRoot:"",pathName:t.rule.path}}));const M=i().substring(0,e(A))+i().substring(e(P));return i(M),await Z(),l.reportAgentSessionEvent({eventName:Ye.memoriesMove,conversationId:"",eventData:{memoriesMoveData:{target:p}}}),"success"}async function oe(t){await J({rule:t})}var v=ot(),x=b(v),B=b(x);He(B,{saveFunction:Z,get selectedText(){return e(u)},set selectedText(s){o(u,s,!0)},get selectionStart(){return e(A)},set selectionStart(s){o(A,s,!0)},get selectionEnd(){return e(P)},set selectionEnd(s){o(P,s,!0)},get value(){return i()},set value(s){i(s)},header:s=>{var c=nt(),p=b(c),f=b(p),M=b(f);{const n=$=>{var z=at(),C=b(z),w=m=>{O(m,{name:"check"})},T=m=>{O(m,{name:"arrow-right"})};ne(C,(m=>{e(N)==="success"?m(w):m(T,!1)})),a($,z)};let d=h((()=>!e(u)));qe(M,{tooltip:{neutral:"Move highlighted text to user guidelines",success:"Text moved to user guidelines"},stateVariant:{success:"solid",neutral:"soft"},defaultColor:"neutral",onClick:()=>J("userGuidelines"),get disabled(){return e(d)},stickyColor:!1,persistOnTooltipClose:!0,replaceIconOnSuccess:!0,size:1,get state(){return e(N)},set state($){o(N,$,!0)},iconLeft:n,children:($,z)=>{var C=Q("User Guidelines");a($,C)},$$slots:{iconLeft:!0,default:!0}})}var re=V(f,2),K=b(re);{let n=h((()=>!e(u)));st(K,{onRuleSelected:oe,get disabled(){return e(n)}})}var ie=V(p,2),le=b(ie);Je(le,{size:1,get path(){return r.path},variant:"soft",onOpenLocalFile:async()=>(q(Ve({repoRoot:"",pathName:r.path})),"success"),children:(n,d)=>{Ee(n,{size:1,children:($,z)=>{var C=Q("Augment-Memories.md");a($,C)},$$slots:{default:!0}})},$$slots:{default:!0}}),a(s,c)},$$slots:{header:!0}}),a(Y,v),Ge()}export{ht as M};
//# sourceMappingURL=MemoriesMarkdownEditor-BAo_YnIt.js.map
