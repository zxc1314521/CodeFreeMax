import{r as i,Y as K,j as r,d as g,b as x,s as b,E as q,c as Z,x as ee}from"../assets/ErrorMessage-sgZuVxCg.js";import"../styles.js";var A;(function(e){e.RequirementsFirst="requirements-first",e.DesignFirst="design-first"})(A||(A={}));var U;(function(e){e.FileEdited="fileEdited",e.FileCreated="fileCreated",e.FileDeleted="fileDeleted",e.UserTriggered="userTriggered",e.UserPrompt="promptSubmit",e.AgentStop="agentStop"})(U||(U={}));var D;(function(e){e.AskAgent="askAgent",e.RunCommand="runCommand"})(D||(D={}));var h;(function(e){e.DevMode="enableDevMode",e.TrustedCommands="trustedCommands",e.CommandDenylist="commandDenylist",e.AutoApproveAgentCommands="autoApproveAgentCommands",e.ConfigureMCP="configureMCP",e.ExecuteBashTimeoutMs="executeBashTimeoutMs",e.EnableCodebaseIndex="enableCodebaseIndex",e.EnableRepositoryMapIndex="enableRepositoryMapIndex",e.TrustedTools="trustedTools"})(h||(h={}));h.DevMode+"",h.TrustedCommands+"",h.CommandDenylist+"",h.AutoApproveAgentCommands+"",h.ConfigureMCP+"",h.ExecuteBashTimeoutMs+"",h.EnableCodebaseIndex+"",h.EnableRepositoryMapIndex+"",h.TrustedTools+"";var F;(function(e){e.Extension="kiroAgent",e.Test="kiroAgent.test"})(F||(F={}));var N;(function(e){e.Queued="Queued",e.InProgress="InProgress",e.Paused="Paused",e.NeedAction="NeedAction",e.Success="Success",e.Failed="Failed",e.Canceled="Canceled",e.Yielded="Yielded"})(N||(N={}));var J;(function(e){e.Queued="Queued",e.Active="Active",e.History="History"})(J||(J={}));var S;(function(e){e.Code="Code"})(S||(S={}));var T;(function(e){e.PendingAction="PendingAction",e.Running="Running",e.Success="Success",e.Error="Error",e.Accepted="Accepted",e.Rejected="Rejected",e.Canceled="Canceled",e.HandledError="HandledError"})(T||(T={}));var O;(function(e){e.Autopilot="Autopilot",e.Supervised="Supervised"})(O||(O={}));var L;(function(e){e.NotStarted="not_started",e.InProgress="in_progress",e.Completed="completed"})(L||(L={}));var B;(function(e){e.Application="kiro.application",e.Feature="kiro.feature",e.Continue="kiro.continue",e.Agent="kiro.agent",e.Tool="kiro.tool",e.Parser="kiro.parser",e.Onboarding="kiro.onboarding",e.Webview="kiro.webview",e.Auth="kiro.auth",e.Billing="kiro.billing",e.Profiles="kiro.profiles",e.RemoteTools="kiro.remote-tools"})(B||(B={}));var H;(function(e){e.Onboarding="onboarding"})(H||(H={}));var _;(function(e){e.RequestId="requestId",e.ConversationId="conversationId",e.ExecutionId="executionId",e.ModelId="ModelIdentifier",e.XRayTraceId="AWS-XRAY-TRACE-ID"})(_||(_={}));var $;(function(e){e.INVALID_TOKEN="INVALID_TOKEN",e.NETWORK_ERROR="NETWORK_ERROR",e.UNEXPECTED_ERROR="UNEXPECTED_ERROR"})($||($={}));var I;(function(e){e.InvalidPowerError="InvalidPowerError",e.McpJsonNotFoundError="McpJsonNotFoundError",e.McpJsonFetchError="McpJsonFetchError",e.PowerAlreadyInstalledError="PowerAlreadyInstalledError",e.PowerNotFoundError="PowerNotFoundError",e.PowerNotInstalledError="PowerNotInstalledError",e.PowerRegistryLoadError="PowerRegistryLoadError",e.PowerRegistrySaveError="PowerRegistrySaveError",e.PowerValidationError="PowerValidationError",e.UnknownError="UnknownError"})(I||(I={}));function re({name:e}){const{callApi:n}=i.useContext(K),[d,l]=i.useState(!0),[c,t]=i.useState(!1),[a,u]=i.useState(!1),[o,j]=i.useState(),[C,p]=i.useState(),[m,f]=i.useState(null),[P,k]=i.useState(),[y,M]=i.useState(!1),w=i.useCallback(async()=>{l(!0);try{const{power:s}=await n("getPowerDetails",{name:e});j(s)}catch(s){p(s)}finally{l(!1)}},[n,e]),R=i.useCallback(async()=>{M(!0),k(void 0);const{content:s,error:v}=await n("getMcpJsonContent",{name:e});f(s),k(v),M(!1)},[n,e]);i.useEffect(()=>{w()},[w]),i.useEffect(()=>{o&&!o.installed&&R()},[o,R]);const V=i.useCallback(async()=>{var s;if(o)try{const{success:v}=await n("installPowerFromRepository",{powerName:o.name,repoId:(s=o.source)==null?void 0:s.repoId});v&&w()}catch(v){p(`Error installing power: ${v instanceof Error?v.message:String(v)}`)}},[n,w,o]),W=i.useCallback(async()=>{if(o)try{const{success:s}=await n("uninstallPower",{name:o.name});s&&w()}catch(s){p(`Error uninstalling power: ${s instanceof Error?s.message:String(s)}`)}},[n,w,o]),X=s=>{n("openExternal",{url:s})},Y=()=>{n("openPowersConfigFile")},G=i.useCallback(async()=>{t(!0);try{u(await n("checkPowerForUpdates",{name:e}))}catch(s){p(s)}finally{t(!1)}},[n,e]),z=i.useCallback(async()=>{t(!0);try{const s=await n("updatePower",{name:e});s.success?await n("showMessage","informational",s.message):await n("showMessage","error",s.message),await w()}catch(s){p(s)}finally{t(!1)}},[n,w,e]);return{isLoading:d,isMcpJsonLoading:y,isUpdating:c,power:o,powerDetailsError:C,mcpJsonContent:m,mcpJsonError:P,handleExternalLinkClick:X,hasUpdates:a,handleOpenPowersConfigFile:Y,handleTryPower:()=>{o&&n("tryPower",{name:e})},handleCheckForUpdates:()=>{G()},handleInstall:()=>{V()},handleInstallUpdates:()=>{z()},handleUninstall:()=>{W()}}}function ne({hasUpdates:e,isUpdating:n,power:d,onCheckForUpdates:l,onInstall:c,onInstallUpdates:t,onTryPower:a,onUninstall:u}){const{author:o,description:j,displayName:C,iconUrl:p,name:m}=d,f=d.installed;return r.jsxs("div",{className:"power-details-header",children:[r.jsx("div",{className:`power-details-header-icon${p?" power-details-header-icon--img":""}`,children:p?r.jsx("img",{src:p}):r.jsx(g,{type:"powers"})}),r.jsxs("div",{className:"power-details-header-content",children:[r.jsx("h1",{children:C||m}),r.jsx("div",{className:"power-details-header-description",children:j}),r.jsxs("div",{className:"power-details-header-author",children:["by ",r.jsx("span",{children:o})]}),r.jsxs("div",{className:"power-details-header-actions",children:[f&&r.jsxs(x,{variant:"primary",onClick:a,children:[r.jsx(g,{type:"powers"}),"Try power"]}),f?r.jsxs(x,{variant:"secondary",onClick:u,children:[r.jsx(g,{type:"trash"}),"Uninstall"]}):r.jsxs(x,{variant:"primary",onClick:c,children:[r.jsx(g,{type:"plus"}),"Install"]}),f&&r.jsxs(x,{variant:"secondary",onClick:e?t:l,children:[n?r.jsx(g,{type:"loading",modifier:"spin"}):r.jsx(g,{type:"refresh"}),e?"Install updates":"Check for updates"]})]})]})]})}function E(){return r.jsx("hr",{className:"power-details-separator"})}function se({tag:e}){return r.jsxs("div",{className:"power-details-tag",children:["#",e]})}function oe(e){switch(e){case"github":return"github";default:return"link"}}function te(e){switch(e){case"github":return"GitHub Repository";default:return}}function ie({type:e,url:n,onClick:d}){const l=()=>{d(n)};return r.jsxs(x,{className:"external-link-button",variant:"outline",onClick:l,children:[r.jsx(g,{type:oe(e)})," ",te(e)??n]})}function ae({power:e,onExternalLinkClick:n}){const{description:d,repositoryUrl:l,tags:c}=e,t=i.useMemo(()=>{const a=[];return l&&a.push({type:"github",url:l}),a},[l]);return r.jsxs("div",{className:"power-details-description",children:[r.jsx("h3",{children:"Description"}),c.length>0&&r.jsx("div",{className:"power-details-tags",children:c.map((a,u)=>r.jsx(se,{tag:a},`tag-${u}-${a}`))}),r.jsx("div",{className:"power-details-long-description",children:d}),t.length?r.jsx("div",{className:"power-details-external-links",children:t.map(({type:a,url:u},o)=>r.jsx(ie,{type:a,url:u,onClick:n},`link-${a}-${o}`))}):null]})}function Q({children:e}){return r.jsx("div",{className:"content-body",children:e})}function de({name:e,config:n}){return r.jsx("div",{className:"power-details-mcp-server",children:r.jsxs(Q,{children:[r.jsx("h4",{children:e}),r.jsx(b,{children:r.jsx(b.Body,{children:r.jsx("pre",{children:r.jsx("code",{children:JSON.stringify(n,null,2)})})})})]})})}function le(e){return!!(e&&typeof e=="object"&&"mcpServers"in e)}function ce({content:e,error:n,isInstalled:d,onOpenPowersConfigFile:l}){if(n)return r.jsx(q,{error:n});if(!e&&!d)return null;const c=e?JSON.parse(e):{},{mcpServers:t}=le(c)?c:{mcpServers:{}};return r.jsxs("div",{className:"power-details-mcp-config",children:[r.jsx("div",{className:"power-details-mcp-config-header",children:r.jsxs("h3",{children:[r.jsx(g,{type:"powersMcp"})," MCP Configuration"]})}),r.jsx("div",{className:"power-details-mcp-config-description",children:d?r.jsx(x,{variant:"outline",onClick:l,children:"Open powers config"}):"Adding this power would add the following MCP servers to your configuration:"}),!d&&Object.entries(t).map(([a,u])=>r.jsx(de,{name:a,config:u},`mcp-server-${a}`))]})}function ue(){const{name:e}=window.variables,{hasUpdates:n,isLoading:d,isMcpJsonLoading:l,isUpdating:c,power:t,powerDetailsError:a,mcpJsonContent:u,mcpJsonError:o,handleCheckForUpdates:j,handleExternalLinkClick:C,handleInstall:p,handleInstallUpdates:m,handleOpenPowersConfigFile:f,handleTryPower:P,handleUninstall:k}=re({name:e});if(a)return r.jsx(q,{error:a});const y=(o==null?void 0:o.name)===I.McpJsonNotFoundError||!!(t&&t.installed&&Object.keys(t.mcpServers??{}).length<1);return!d&&!l&&t&&r.jsxs("div",{className:"power-details",children:[r.jsx(ne,{hasUpdates:n,isUpdating:c,power:t,onCheckForUpdates:j,onInstall:p,onInstallUpdates:m,onTryPower:P,onUninstall:k}),r.jsx(E,{}),r.jsx(ae,{power:t,onExternalLinkClick:C}),!y&&r.jsxs(r.Fragment,{children:[r.jsx(E,{}),r.jsx(ce,{content:u,error:o,isInstalled:t.installed,onOpenPowersConfigFile:f})]}),r.jsx(E,{}),r.jsx(Q,{children:r.jsxs("div",{className:"power-details-disclaimer",children:[r.jsx("h4",{children:"Third-party powers disclaimer"}),"Kiro powers provided by third parties operate independently from the core Kiro service and may be subject to their own license terms. Kiro does not test or evaluate these tools across all use cases, so users should install only from trusted sources and review any associated documentation and licensing."]})})]})}Z.createRoot(document.getElementById("root")).render(r.jsx(i.StrictMode,{children:r.jsx(ee,{editorApi:window.vscode,children:r.jsx(ue,{})})}));
